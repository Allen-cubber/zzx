---
title: 第三章 模拟信号的数字编码
date: 2025-09-18T10:00:00+08:00
tags:
  - 大三上
  - 数字通信原理
summary: 本章讲述了如何将现实世界中的模拟信号转化为数字世界中的比特流。
---
## 3.1 引言 🗣️

#### 1. 为什么需要进行数字编码？ (必要性)

*   **核心作用**：模拟信号的数字编码，是连接<font color="orange">模拟世界</font>与<font color="orange">数字传输网络</font>的<font color="orange">唯一桥梁</font>。
*   **时代背景**：在数字时代，几乎所有信息处理、存储和传输系统（如计算机、智能手机、互联网、云存储）都基于数字技术构建。

#### 2. 数字编码带来了哪些巨大优势？ (重要性)

将模拟信号转换为数字信号具有以下优势：

1.  💪 **抗干扰能力强、远距离传输保真度高** (<font color="orange">核心优势</font>)
2.  📈 **信道利用率高、复用效率高**
    *   通过压缩编码，可以节省带宽（直接好处）。
3.  ⚙️ **保真度和可靠性可控**
    *   通过调整量化步长，可以控制信号的精度（直接好处）。
4.  🔒 **强大的安全与保密性**
5.  🌐 **综合业务支持与灵活性**
    *   这使得<font color="orange">三网融合</font>（电信网、互联网、广播电视网）成为可能。
    *   用户可通过同一个网络打电话、上网、看高清电视。
6.  🔧 **便于网络管理**

#### 3. 模拟信号数字编码基本概念

模拟信号的数字编码是将模拟信号转变为二进制数字码组的过程，主要包括三个步骤：

*   **抽样 (Sampling)**：把<font color="orange">连续时间</font>模拟信号转换成<font color="orange">时间离散</font>、<font color="orange">连续幅度</font>的抽样信号。
*   **量化 (Quantization)**：把<font color="orange">连续幅度</font>抽样信号转换成<font color="orange">时间离散</font>、<font color="orange">幅度离散</font>的数字信号。
*   **编码 (Coding)**：将量化后的数字信号映射成<font color="orange">二进制码组</font>。

---

## 3.2 低通与带通信号抽样定理 🎬

#### 🤔 如何联想到抽样定理？

1.  **电影原理** 🎞️
    *   **视觉暂留**：人眼在看到一个视像消失后，该物像还会在视网膜上滞留 0.1 - 0.4 秒。
    *   **电影原理**：以每秒24帧的速率匀速播放一系列静态胶片，利用视觉暂留现象，使人眼看到连续变化的动态影像。这本质上就是用离散的静态画面（抽样）来表示连续的动态过程。

2.  **高等数学中的曲线分析** 📈
    *   在计算曲线积分时，我们常常用一系列矩形的面积之和来近似曲线下的面积。当矩形划分得足够细时，这个近似值就越接近真实值。这也是用离散值（矩形）来表示连续函数（曲线）的思想。

#### 结论

*   **连续信号**可以用<font color="orange">离散信号</font>近似表示。
*   **电影**以足够短的时间间隔播放静止图像，可看到<font color="orange">连续动态图像</font>。
*   **核心问题**：电影中看到的图像与实际动态图像是什么关系？电影是幻觉吗？ **一切尽在抽样定理！**

---

### 3.2.1 理想信号的低通抽样 (冲激抽样)

*   **模拟信号的抽样过程**：将模拟信号 $x(t)$ 与一个抽样脉冲序列 $s_p(t)$ 相乘，得到抽样后信号 $x_s(t)$。

    

    *   **抽样脉冲序列**:
        $s_p(t) = \sum_{n=-\infty}^{+\infty} p_T(t-nT_S)$
        其中 $p_T(t)$ 是持续时间不大于抽样间隔 $T_S$ 的脉冲。
    *   **抽样所得信号**:
        $x_s(t) = x(t) \cdot s_p(t) = x(t) \sum_{n=-\infty}^{+\infty} p_T(t-nT_S)$

*   **理想抽样 (冲激抽样)**
    *   **抽样脉冲序列** (用狄拉克δ函数表示):
        $s_p(t) = s_\delta(t) = \sum_{n=-\infty}^{\infty} \delta(t-nT_s)$
    *   **抽样脉冲序列的傅里叶变换**:
        $S_\delta(\omega) = \omega_s \sum_{k=-\infty}^{\infty} \delta(\omega - k\omega_s)$
        其中 $\omega_s = 2\pi / T_s$ 是抽样角频率。
    *   **抽样所得信号**:
        $x_s(t) = x(t)s_\delta(t) = x(t)\sum_{n=-\infty}^{\infty} \delta(t-nT_s) = \sum_{n=-\infty}^{\infty} x(nT_s)\delta(t-nT_s)$
    *   **抽样所得信号的傅里叶变换**:
        $X_s(\omega) = \frac{1}{2\pi} [X(\omega) * S_\delta(\omega)]$
        $\boxed{X_s(\omega) = \frac{1}{T_s} \sum_{k=-\infty}^{\infty} X(\omega - k\omega_s)}$

*   **时域与频域特性**
    
    *   **结论** 🔑：抽样所得信号的频谱，是<font color="orange">原信号频谱</font>以抽样频率 $\omega_s$ 为周期的<font color="orange">周期性延拓</font>。

### 3.2.2 低通信号的自然抽样

*   **自然抽样脉冲序列**：使用宽度不为零的脉冲。
    $s_p(t) = \sum_{n=-\infty}^{\infty} p_T(t-nT_s)$
    其中 $p_T(t)$ 是脉冲的波形函数。
*   **傅里叶变换**
    *   抽样脉冲序列：$S_p(\omega) = \sum_{n=-\infty}^{\infty} C_n \delta(\omega - n\omega_s)$
    *   抽样信号：$\boxed{X_s(\omega) = X(\omega) * S_p(\omega) = \sum_{n=-\infty}^{\infty} C_n X(\omega - n\omega_s)}$
    其中 $C_n$ 是脉冲波形 $p_T(t)$ 的傅里叶级数系数。
*   **时域与频域特性**
    
    *   **结论** 🔑：与理想抽样类似，频谱也是周期延拓，但延拓部分受到了系数 $C_n$ 的<font color="orange">加权影响</font>。

### 3.2.3 低通信号的平顶抽样
![](content/notes/数字通信原理/第三章模拟信号的数字编码/Pastedimage20250917203107.png)
*   **过程**：
    1.  用一个窄脉冲（近似冲激）对信号进行瞬时采样，获得该时刻的幅度值。
    2.  用“采样保持电路”将这个瞬时值保持一段时间 $T_s$。
*   **结果**：在每个采样周期内，信号幅度值恒定不变，形成一个“平顶”。这是现代ADC（模数转换器）的实际工作方式。
*   **与自然采样的对比**：

| 特性 | 自然采样 (Natural Sampling) | 平顶采样 (Flat-top Sampling) |
| :--- | :--- | :--- |
| **采样输出** | 脉冲顶部跟随输入信号变化 | 脉冲顶部平坦，保持采样瞬时值 |
| **ADC兼容性** | 差，电压变化导致转换错误 | **优**，提供稳定电压供转换 |
| **工程实现** | 复杂，需要模拟乘法器，成本高 | **简单**，通用采样保持电路，成本低 |
| **抗干扰性** | 较差 | **较好** |
| **信号失真** | <font color="orange">孔径效应</font>，形式规整，易于数字补偿 |
| **应用场景** | 理论分析和特殊系统 | 所有现代ADC、数据采集系统的标准做法 |

*   **孔径效应**
    *   由于在平顶采样中，采样值被保持了一段时间（而不是一个瞬时点），这在频域上相当于乘以了一个矩形窗函数，导致原始信号的频谱发生了畸变。这种由采样孔径（保持时间）引起的失真称为 <font color="orange">孔径失真</font>。
    *   **校正补偿**：可以在输出端使用一个反向特性的滤波器（称为孔径补偿器）来校正这种失真。

---

### 3.2.4 混叠及低通抽样定理

*   **混叠 (Aliasing)** ⚠️
    *   **原因**：当抽样频率 $f_S < 2f_M$ (其中 $f_M$ 是信号的最高频率) 时。
    *   **现象**：抽样信号的频谱发生<font color="orange">重叠</font>。
    *   **后果**：重叠部分的频谱信息被破坏，此时的抽样值不能反映原信号的变化，导致信号<font color="orange">无法无失真恢复</font>。
    
    
    图中，实线是原信号，虚线是因混叠而错误重建的低频信号。

*   **低通抽样定理 (奈奎斯特-香农抽样定理)**
    > **定理3.2.1**：对一个频带限制在 $[0, \omega_H]$ 内的连续信号 $x(t)$，如果以角频率 $\omega_S \ge 2\omega_H$ 对其进行抽样，那么就可以由抽样序列 $x_s(t)$ 在接收端无失真地恢复出原信号。
    *   **奈氏频率**：$2\omega_H$ 或 $2f_H$ 被称为奈奎斯特频率。
    *   **无失真恢复的必要条件**：$\boxed{\omega_S \ge 2\omega_H}$，确保抽样信号<font color="orange">无频谱混叠</font>。
    
    通过一个理想低通滤波器（上图中的 $F_L(\omega)$），即可从抽样后频谱中恢复出原始频谱。

*   **如何消除/避免混叠？**
    1.  **方法一：提高采样率**
        *   **原理**：使 $f_S \gg 2f_M$，拉开频谱副本间的距离。
        *   **优点**：简单直接，无失真。
        *   **缺点**：数据量巨大，对硬件和处理能力要求高。
    2.  **方法二：预滤波 (抗混叠滤波)**
        *   **原理**：在采样前，先用一个低通滤波器滤掉信号中高于 $f_S/2$ 的频率成分。
        *   **优点**：当高频能量占比很小时，影响可忽略，是<font color="orange">大多数实际系统的工作状态</font>。
        *   **缺点**：会丢失一部分高频信息。
    3.  **方法三：后滤波**
        *   **原理**：采样并重建后，再用低通滤波器滤除混叠成分。
        *   **不足**：<font color="orange">根本性缺陷</font>！一旦混叠发生，高频信息和混叠进来的低频信息已经混杂在一起，无法再分开了。
    4.  **方法四：过采样 + 数字滤波**
        *   **流程**：模拟输入 -> 模拟（缓变）滤波器 -> **高频过采样** -> **数字滤波器** -> **抽取（降采样）**
        *   **好处**：
            *   对模拟滤波器要求大大降低。
            *   数字滤波器性能卓越，精度高，无温漂。
            *   系统灵活性高，可通过软件调整带宽和采样率。

#### 信号重建的时域表达

*   从频域看，重建是低通滤波。从时域看，重建是<font color="orange">内插</font>。
*   通过低通滤波后恢复的信号 $x(t)$ 在时域上可以表示为：
    $\boxed{x(t) = \sum_{k=-\infty}^{\infty} x(kT_s) \text{sinc}(\omega_H(t-kT_s))}$
*   **物理意义**：原始信号在任意时刻的值，可以由其所有采样点的值经过加权（权重为sinc函数）求和得到。
*   **近程相关性**：由于sinc函数的主瓣集中，衰减快，所以任意时刻的信号值主要与距离它较近的几个采样值相关。


---

### 3.2.5 带通抽样定理

*   **研究动机**
    *   **例1 (低通)**：带宽 $W=20\text{MHz}$ 的低通信号，最高频率 $f_H=20\text{MHz}$，所需最低采样率 $f_S = 2f_H = 40\text{MHz}$。
    *   **例2 (带通)**：带宽同样为 $W=20\text{MHz}$，但中心频率 $f_C=6\text{GHz}$ 的带通信号，最高频率 $f_H=6.01\text{GHz}$。若按低通抽样定理，所需采样率 $f_S = 2f_H = 12.04\text{GHz}$！
    *   **困难**：如此高的采样率，器件昂贵，数据量巨大。<font color="orange">是否必须这样做？</font>

*   **带通抽样定理**
    > **定理3.2.2**：对一个频带限制在 $[\omega_L, \omega_H]$ 内的带通信号 $x_c(t)$，记带宽 $W = \omega_H - \omega_L$，并定义整数 $N = \lfloor \omega_H / W \rfloor$ 和余数 $M = \omega_H / W - N$。则无失真恢复的最低均匀抽样频率为：
    > $\boxed{\omega_s = 2W \cdot (1 + \frac{M}{N})}$

*   **核心思想**💡：利用带通信号频谱的空闲区域。通过巧妙地选择采样率，使得频谱的周期延拓副本刚好能“插入”到原频谱的空闲位置，而不发生重叠。
    
    为避免混叠，需要满足：
    1.  第N个频谱副本的左边沿不与基带频谱的右边沿重叠：$Nf_S \ge 2f_H$
    2.  第(N-1)个频谱副本的右边沿不与基带频谱的左边沿重叠：$(N-1)f_S + W \le 2f_H - W$
    同时满足这两个条件，就能找到比 $2f_H$ 低得多的采样率。

*   **注意点** 📌：
    *   如果采用<font color="orange">非均匀抽样</font>，理论上平均采样频率可低至 $2W$。

#### 抽样对通信系统的影响 (问题与思考)

1.  **抽样频率大一点好还是小一点好？**
    *   **大一点好**：可以远离奈奎斯特频率，避免混叠，对滤波器的要求也更低，系统更稳定。
    *   **小一点好**：产生的数据量小，节省存储空间和传输带宽，降低处理功耗和成本。
    *   **结论**：需要在性能和成本之间做权衡。通常会选择一个比奈奎斯特频率稍高的频率（过采样）。

2.  **窄带语音编码 vs 宽带语音编码**
    *   **要求不同**：窄带语音（如传统电话）通常只保留 300-3400Hz 的频率，采样率只需 8kHz。宽带语音保留更宽的频带（如 50-7000Hz），需要 16kHz 或更高的采样率。
    *   **利弊**：宽带语音音质更好、更自然（利），但数据率更高（弊）。窄带语音数据率低（利），但音质较差（弊）。

---

## 3.3 模拟信号的量化 📏

#### 3.3.1 标量量化
![](content/notes/数字通信原理/第三章模拟信号的数字编码/Pastedimage20250917203711.png)
*   **定义**：对抽样序列的每个样值独立进行量化操作。
*   **方法**：
    $y_k = Q(x)$，当 $x_{k-1} \le x < x_k$ 时，其中 $y_k \in [x_{k-1}, x_k)$
*   **关键参数**：
    *   **分层电平 $x_k$**：划分量化区间的边界值。
    *   **量化电平 $y_k$**：量化区间的代表值，即量化输出值。
    *   **量化阶距 $\Delta_k$**：$\Delta_k = x_k - x_{k-1}$。
    *   **量化级数 $M$**：量化电平的总数。通常取 $M=2^N$，其中 $N$ 是编码所需的比特数。
    

#### 量化方式与量化误差

*   **均匀量化 (Uniform Quantization)**
    *   **特点**：量化阶距 $\Delta$ 为常数。
    *   **优点**：简单，易实现。
    *   **缺点**：对于小信号，相对误差大。

*   **非均匀量化 (Non-uniform Quantization)**
    *   **特点**：量化阶距随输入信号幅度而变化（通常是小信号区域阶距小，大信号区域阶距大）。
    *   **优点**：在量化级数相同的情况下，通常具有更高的<font color="orange">量化信噪比</font>。
    *   **缺点**：实现较复杂。

    

#### 量化噪声分析

*   **量化噪声**：由于量化是一种“四舍五入”的过程，量化后的值与原始抽样值之间存在误差 $e=y_k-x$。这个误差是随机的，被称为量化噪声。
*   **量化噪声功率**：用量化误差的平均功率 $\sigma_q^2$ 来描述。
    $\sigma_q^2 = E[(x-Q(x))^2] = \sum_{k=1}^{M} \int_{x_{k-1}}^{x_k} (x-y_k)^2 p_X(x) dx = E [ e^2 ]$
*   **过载噪声**：当输入信号的幅度超出了量化器的预设范围 $(x_{min}, x_{max})$ 时，会产生很大的失真，这部分噪声称为<font color="orange">过载噪声</font> $\sigma_o^2$。
*   **量化信噪比 (SNRq)**：信号的平均功率与总的量化噪声（量化噪声+过载噪声）的比值。
    $\text{SNRq} = \frac{S_x}{\sigma_Q^2} = \frac{S_x}{\sigma_q^2 + \sigma_o^2}$

---

### 3.3.2 均匀量化详解

*   **量化噪声功率**：当 M 足够大时，可以认为量化误差 $e$ 在 $(-\Delta/2, \Delta/2)$ 区间内均匀分布。
    $\boxed{N = \sigma_q^2 \approx \frac{\Delta^2}{12}}$
    其中 $\Delta = (x_{max} - x_{min})/M = 2V_p / 2^N$。
*   **信噪比分析** (假设信号在 $[-V_p, +V_p]$ 内均匀分布)
    *   信号功率: $S_x = \frac{(2V_p)^2}{12}$
    *   量化信噪比: $\text{SNR}_q = \frac{S_x}{\sigma_q^2} = 2^{2N}$
    *   **dB值**:
        $\text{SNR}\_{q,dB} = 10\log\_{10}(2^{2N}) = 20N \log\_{10}2 \approx 6.02N \text{ (dB)}$
*   ⭐ **重要结论**：对于均匀分布信号，<font color="orange">每增加一位量化精度 (N增加1)，量化信噪比提升约6dB</font>。

*   **均匀量化的优缺点**
    *   **优点**：简单，易实现。
    *   **缺点**：信噪比随信号幅度减小而下降，对小信号不利。对于非均匀分布的信号（如语音信号），平均量化信噪比不高。

### 3.3.3 非均匀量化详解

*   **引入动机**
    1.  **信号幅度差异**：对大信号和小信号“一刀切”，导致小信号的信噪比很差。
    2.  **信号概率分布**：像语音信号，小信号出现的概率远大于大信号。均匀量化没有利用这一统计特性。

*   **工作过程 (压扩)**
    1.  **压缩 (Compressing)**：在编码端，先对输入信号 $x$ 进行非线性变换 $y = f(x)$。这个变换会“压缩”大信号的幅度，同时“扩展”小信号的幅度。
    2.  **均匀量化**：对变换后的信号 $y$ 进行均匀量化。
    3.  **扩张 (Expanding)**：在解码端，进行反变换 $\hat{x} = f^{-1}(y_k)$，恢复信号幅度。
    

*   **抑制噪声原理**：对小信号区域采用了更精细的量化（小阶距），而对大信号区域采用了粗略的量化（大阶距）。这等效于使量化噪声的功率与信号功率成正比，从而使得<font color="orange">信噪比基本保持恒定</font>，不受信号大小影响。

*   **两种压扩律**
    在数字通信中，特别是语音编码，广泛采用两种对数压扩律：
    1.  **A律 (A-law)**：主要在欧洲和中国使用。
    2.  **μ律 (μ-law)**：主要在北美和日本使用。

    这两种方法都是理想对数变换的近似实现，通过分段线性函数（折线）来模拟对数曲线，便于工程实现。
    *   **A律**：通常用<font color="orange">十三折线法</font>近似。
    *   **μ律**：通常用<font color="orange">十五折线法</font>近似。


#### **最佳量化器的分层电平和量化电平**
现在详细推导在最小均方误差（Minimum Mean Squared Error, MMSE）准则下的最佳量化器（Optimal Quantizer）的分层电平（Decision Boundaries）和量化电平（Reconstruction Levels）。这个理论通常被称为**劳埃德-最大算法（Lloyd-Max Algorithm）**的基础。

##### 1. 问题定义与数学准备

我们首先定义问题。假设有一个连续的随机变量 $x$，其概率密度函数（PDF）为 $p(x)$。我们的目标是设计一个 $N$ 电平的量化器 $Q(x)$，将连续的输入 $x$ 映射到 $N$ 个离散的量化电平中的一个，使得量化误差的平方的均值（即均方误差 MSE）最小。

**关键变量定义:**

*   **输入信号:** $x$，其定义域为 $(t_0, t_N)$，通常 $t_0 = -\infty$, $t_N = +\infty$。
*   **概率密度函数 (PDF):** $p(x)$。
*   **分层电平 (Decision Boundaries):** $t_0, t_1, t_2, ..., t_N$。这些值将输入信号的范围划分为 $N$ 个不重叠的区间 $R_k = (t_{k-1}, t_k]$。
*   **量化电平 (Reconstruction Levels):** $y_1, y_2, ..., y_N$。如果输入 $x$ 落在区间 $R_k$ 内，那么量化器的输出就是 $y_k$。
*   **量化规则:** $Q(x) = y_k$  if  $x \in R_k$ (即 $t_{k-1} < x \leq t_k$)。
*   **量化误差:** $\epsilon = x - Q(x)$。

**目标函数：最小化均方误差 (MSE)**

我们的目标是找到一组 $\{t_k\}$ 和 $\{y_k\}$，使得均方误差 $D$（也称为失真度 Distortion）最小。

$D = E[\epsilon^2] = E[(x - Q(x))^2]$

将这个期望值用积分形式表示：
$D = \int_{t_0}^{t_N} (x - Q(x))^2 p(x) dx$

由于在每个区间 $R_k$ 内 $Q(x)$ 是一个常数 $y_k$，我们可以将积分拆分为 $N$ 个部分的和：
$$
D = \sum_{k=1}^{N} \int_{t_{k-1}}^{t_k} (x - y_k)^2 p(x) dx
$$
现在，我们的任务就是求解让 $D$ 最小化的 $\{t_k\}$ 和 $\{y_k\}$。这是一个多元函数的极值问题，我们可以使用微积分的方法，通过对变量求偏导并令其为零来求解。

---

##### 2. 推导最佳量化电平 (Optimal $y_k$)

我们先假设**分层电平 $\{t_k\}$ 是固定的**，然后寻找能使 $D$ 最小的最佳量化电平 $\{y_k\}$。

为了找到 $y_k$ 的最优值，我们对 $D$ 求关于任意一个 $y_k$ 的偏导数，并令其等于零。
$$
\frac{\partial D}{\partial y_k} = 0
$$
观察 $D$ 的表达式，只有求和式中的第 $k$ 项与 $y_k$ 有关，其他项的偏导数都为零。
$$
\frac{\partial D}{\partial y_k} = \frac{\partial}{\partial y_k} \left[ \int_{t_{k-1}}^{t_k} (x - y_k)^2 p(x) dx \right]
$$
根据莱布尼茨积分法则，可以将求导运算移入积分号内：
$$
\begin{aligned}
\frac{\partial D}{\partial y_k} &= \int_{t_{k-1}}^{t_k} \frac{\partial}{\partial y_k} [(x - y_k)^2] p(x) dx \\
&= \int_{t_{k-1}}^{t_k} 2(x - y_k)(-1) p(x) dx \\
&= -2 \int_{t_{k-1}}^{t_k} (x - y_k) p(x) dx
\end{aligned}
$$
令该偏导数为零：
$$
-2 \int_{t_{k-1}}^{t_k} (x - y_k) p(x) dx = 0
$$
$$
\int_{t_{k-1}}^{t_k} (x - y_k) p(x) dx = 0
$$
$$
\int_{t_{k-1}}^{t_k} x p(x) dx - \int_{t_{k-1}}^{t_k} y_k p(x) dx = 0
$$
由于 $y_k$ 在积分区间内是常数，可以提到积分号外：
$$
\int_{t_{k-1}}^{t_k} x p(x) dx = y_k \int_{t_{k-1}}^{t_k} p(x) dx
$$
解出 $y_k$：
$$
y_k = \frac{\int_{t_{k-1}}^{t_k} x p(x) dx}{\int_{t_{k-1}}^{t_k} p(x) dx}
$$

**结论 1 (质心条件 Centroid Condition):**
这个公式的物理意义是，**最佳的量化电平 $y_k$ 应该是输入信号在量化区间 $R_k$ 内的条件期望值，也就是该区间的概率密度函数的质心（Centroid）。**

---

##### 3. 推导最佳分层电平 (Optimal $t_k$)

现在，我们反过来，假设**量化电平 $\{y_k\}$ 是固定的**，然后寻找能使 $D$ 最小的最佳分层电平 $\{t_k\}$。

我们对 $D$ 求关于任意一个分层电平 $t_k$ (其中 $k=1, ..., N-1$) 的偏导数，并令其等于零。
$$
\frac{\partial D}{\partial t_k} = 0
$$
观察 $D$ 的表达式，分层电平 $t_k$ 同时是第 $k$ 个积分的上限和第 $k+1$ 个积分的下限。
$D = ... + \int_{t_{k-1}}^{t_k} (x - y_k)^2 p(x) dx + \int_{t_k}^{t_{k+1}} (x - y_{k+1})^2 p(x) dx + ...$

再次使用莱布尼茨积分法则（$\frac{d}{dc} \int_{a(c)}^{b(c)} f(x, c) dx = \int_{a(c)}^{b(c)} \frac{\partial f}{\partial c} dx + f(b(c), c)b'(c) - f(a(c), c)a'(c)$），此处被积函数不含 $t_k$，因此只剩下边界项：
$$
\frac{\partial D}{\partial t_k} = \left[ (t_k - y_k)^2 p(t_k) \right] - \left[ (t_k - y_{k+1})^2 p(t_k) \right]
$$
(第一个方括号来自对第k个积分的上限求导，第二个方括号来自对第k+1个积分的下限求导)

令该偏导数为零：
$$
(t_k - y_k)^2 p(t_k) - (t_k - y_{k+1})^2 p(t_k) = 0
$$
假设 $p(t_k) \neq 0$，可以约去 $p(t_k)$：
$$
(t_k - y_k)^2 = (t_k - y_{k+1})^2
$$
两边开方，得到两种可能：
1.  $t_k - y_k = t_k - y_{k+1} \implies y_k = y_{k+1}$。这是一种退化解，意味着两个相邻的量化电平相同，这通常不是我们想要的 N 电平量化器。
2.  $t_k - y_k = -(t_k - y_{k+1}) \implies t_k - y_k = -t_k + y_{k+1}$

整理上式：
$$
2t_k = y_k + y_{k+1}
$$
$$
t_k = \frac{y_k + y_{k+1}}{2}
$$

**结论 2 (最近邻条件 Nearest Neighbor Condition):**
这个公式的物理意义是，**最佳的分层电平 $t_k$ 应该位于相邻两个量化电平 $y_k$ 和 $y_{k+1}$ 的正中间。** 这也意味着，一个输入值 $x$ 会被量化到与它距离最近的那个量化电平上。

---

##### 4. 总结与劳埃德-最大算法

我们得到了最佳量化器必须同时满足的两个必要条件：

1.  **量化电平条件（质心条件）**:
    $$
    y_k = E[x | t_{k-1} < x \leq t_k] = \frac{\int_{t_{k-1}}^{t_k} x p(x) dx}{\int_{t_{k-1}}^{t_k} p(x) dx}
    $$
    每个量化电平 $y_k$ 必须是其对应量化区间 $R_k$ 的条件均值（质心）。

2.  **分层电平条件（最近邻条件）**:
    $$
    t_k = \frac{y_k + y_{k+1}}{2}
    $$
    每个分层电平 $t_k$ 必须是相邻两个量化电平 $y_k$ 和 $y_{k+1}$ 的中点。

**关键问题:**
我们发现这两个条件是相互依赖的：$y_k$ 的计算依赖于 $t_k$，而 $t_k$ 的计算又依赖于 $y_k$。这种循环依赖关系使得我们无法直接得到一个封闭解（除了少数特殊情况，如均匀分布）。

**解决方法：迭代算法 (劳埃德-最大算法)**

为了解决这个问题，我们可以采用一种迭代的方法：

1.  **初始化**: 选择一组初始的量化电平 $\{y_k^{(0)}\}$ (例如，在信号范围内均匀分布)。
2.  **迭代步骤 (第 $i$ 次迭代)**:
    *   **更新分层电平**: 根据当前的 $\{y_k^{(i-1)}\}$，使用 **最近邻条件** 计算出新的分层电平 $\{t_k^{(i)}\}$：
        $$t_k^{(i)} = \frac{y_k^{(i-1)} + y_{k+1}^{(i-1)}}{2}$$
    *   **更新量化电平**: 根据刚刚计算出的分层电平 $\{t_k^{(i)}\}$，使用 **质心条件** 计算出新的量化电平 $\{y_k^{(i)}\}$：
        $$y_k^{(i)} = \frac{\int_{t_{k-1}^{(i)}}^{t_k^{(i)}} x p(x) dx}{\int_{t_{k-1}^{(i)}}^{t_k^{(i)}} p(x) dx}$$
3.  **终止条件**: 重复第 2 步，直到 $\{y_k\}$ 和 $\{t_k\}$ 的变化非常小，或者均方误差 $D$ 的下降幅度小于某个预设的阈值。

该算法保证了每次迭代都会使均方误差 $D$ 减小或保持不变，因此它最终会收敛到一个局部最优解。对于许多常见的单峰对称概率密度函数（如高斯分布），这个局部最优解就是全局最优解。

#### 对数量化

在我们刚才讨论的最佳量化器（劳埃德-最大算法）中，量化区间的划分是根据输入信号的**概率密度函数 (PDF)** 来优化的。它在信号出现概率高的地方划分更精细的量化阶梯，在概率低的地方划分得更粗糙。

然而，在很多实际应用中，比如语音信号，我们面临两个问题：
1.  信号的概率密度函数可能未知，或者随时间变化。
2.  我们更关心的是**信噪比**，特别是对于幅度较小的信号，我们希望它们不要被量化噪声淹没。

**对数量化**就是为了解决这些问题而提出的一种非常重要和实用的**非均匀量化**技术。

##### 1. 为什么需要对数量化？

考虑一个标准的**均匀量化器**。它的量化阶梯大小 $Δ$ 是固定的。
*   **对于大信号** (幅度远大于 $Δ$): 量化噪声相对较小，信噪比（SQNR）较高。
*   **对于小信号** (幅度与 $Δ$ 相当): 量化噪声的功率可能与信号功率差不多，导致信噪比非常低，小信号的细节完全丢失。

然而，人类的感知系统（如听觉和视觉）本身就是非线性的。我们对弱信号的变化更敏感，对强信号的变化则不那么敏感。例如，在安静的房间里一根针掉地的声音很清晰，但在嘈杂的马路上同样的声音则完全听不到。

对数量化的核心思想就是模仿这种感知特性：**对小信号使用更精细的量化阶梯，对大信号使用更粗糙的量化阶梯**。这样做的目标是使得**信噪比（SQNR）在很宽的信号动态范围内保持近似恒定**。

##### 2. 核心技术：压扩 (Companding)

直接设计和实现一个阶梯大小不等的非均匀量化器在硬件上是复杂的。工程上采用了一种等效且更简单的方法，称为**压扩 (Companding)**，这个词是**压缩 (Compressing)** 和 **扩张 (Expanding)** 的组合。

流程如下：
1.  **压缩 (Compression)**: 在量化之前，输入信号 $x$ 先通过一个非线性压缩函数 $c(x)$。这个函数的作用是“压制”大信号的幅度，同时“拉伸”小信号的幅度。
2.  **均匀量化 (Uniform Quantization)**: 将压缩后的信号 $c(x)$ 送入一个标准的、简单的均匀量化器进行量化。
3.  **扩张 (Expansion)**: 在接收端，将量化后的值通过一个反函数 $c^{-1}(y)$（扩张函数）进行处理，以恢复信号的原始动态范围。

通过这种方式，我们用 **"非线性压缩 + 均匀量化"** 来等效实现 **"非均匀量化"** 的效果。

##### 3. 两种主流的对数量化标准：μ-律 和 A-律

在数字通信，特别是电话系统（PCM，脉冲编码调制）中，有两种国际标准化的压扩律。

**(a) μ-律 (μ-Law)**

μ-律主要在北美和日本使用。其压缩函数定义如下（假设输入信号 $x$ 已经归一化到 $[-1, 1]$ 范围）：
$$
c(x) = \text{sgn}(x) \frac{\ln(1 + \mu|x|)}{\ln(1 + \mu)}
$$
其中：
*   $x$ 是归一化的输入信号值。
*   $\text{sgn}(x)$ 是符号函数。
*   $\mu$ 是一个正常数，用于控制压缩的程度。$\mu$ 越大，压缩程度越高，对小信号的增强效果越明显。
*   在电信标准中，通常取 $\mu = 255$。

**特点：**
*   当 $|x| \to 0$ 时，函数的斜率很大，意味着对小信号有很高的增益。
*   当 $|x| \to 1$ 时，函数的斜率变小，意味着对大信号的增益较低。
*   当 $\mu = 0$ 时，该函数退化为线性函数 $c(x) = x$，即没有压缩，等同于均匀量化。

**(b) A-律 (A-Law)**
![](content/notes/数字通信原理/第三章模拟信号的数字编码/Pastedimage20250928201930.png)
A-律主要在欧洲和世界其他地区使用。其压缩函数也是分段定义的：
$$
c(x) = \text{sgn}(x) \begin{cases}
\frac{A|x|}{1 + \ln(A)} & \text{for } 0 \le |x| < \frac{1}{A} \\
\frac{1 + \ln(A|x|)}{1 + \ln(A)} & \text{for } \frac{1}{A} \le |x| \le 1
\end{cases}
$$
其中：
*   $A$ 是控制压缩程度的参数。
*   在电信标准中，通常取 $A = 87.6$。

**特点：**
*   A-律在原点附近是**线性**的（当 $|x| < 1/A$ 时）。这可以避免当信号极小时对数函数斜率无穷大的问题，并且对非常小的噪声不那么敏感。
*   当信号幅度超过 $1/A$ 后，它才进入对数压缩区域。
*   在国际标准中，当 $A=87.6$ 时，A-律的性能与 $\mu=255$ 的μ-律非常接近。

##### 4. 优势与劣势

**优势:**
1.  **提升小信号的信噪比**：这是其最主要的目的，使得语音中的微弱辅音和安静片段也能被清晰地编码。
2.  **动态范围大**：可以用较少的比特数（如8比特）表示非常宽动态范围的信号（相当于12-13比特线性量化的范围）。
3.  **信噪比近似恒定**：在很大的输入信号范围内，SQNR 几乎不随信号功率变化，提供了稳定的语音质量。
4.  **实现简单**：压扩算法是固定的解析式，无需知道信号的统计特性，实现起来比需要迭代的劳埃德-最大算法简单得多。

**劣势:**
1.  **并非真正最优**：对于一个**已知概率密度函数**的信号源，劳埃德-最大量化器的均方误差（MSE）总是比对数量化器更小。对数量化是一种通用的、鲁棒的次优方案。
2.  **大信号性能下降**：为了照顾小信号，牺牲了对大信号的量化精度。
3.  **引入非线性失真**：压扩过程本身是一种非线性变换。

##### 5. 与最佳量化器 (Lloyd-Max) 的对比

| 特性 | 最佳量化器 (Lloyd-Max) | 对数量化 (μ-Law / A-Law) |
| :--- | :--- | :--- |
| **设计准则** | 最小化均方误差 (MMSE) | 使信噪比 (SQNR) 对信号幅度不敏感 |
| **依赖性** | **强依赖**于输入信号的概率密度函数 (PDF) | **不依赖**于信号的PDF，是通用的 |
| **优化对象** | 根据信号**概率**分布来优化量化阶梯 | 根据信号**幅度**来优化量化阶梯 |
| **复杂度** | 设计复杂，需要迭代计算 | 设计简单，有固定的解析公式 |
| **性能** | 对已知信源，MSE **最优** | 对已知信源，MSE **次优** |
| **应用** | 信号/图像压缩（当模型已知时） | 电话、语音通信等未知或时变信源 |

**总结来说**，对数量化是一种非常实用且高效的工程解决方案。它放弃了在特定信号分布下的理论最优性（最小MSE），换取了对信号统计特性不敏感的鲁棒性以及在宽动态范围内恒定的信噪比，这在语音通信等应用中是至关重要的。
### 3.3.4 矢量量化 (Vector Quantization, VQ)

*   **基本思想**：将标量量化从一维推广到多维。它不再对单个样本进行量化，而是将多个样本组成一个矢量（一个块），然后对整个矢量进行量化。
*   **过程**：
    1.  将 N 维信号空间划分为 M 个子空间（区域）。
    2.  每个子空间指定一个代表性的码矢量（码字）。这 M 个码字组成了<font color="orange">码本</font>。
    3.  对于一个输入的信号矢量，找到码本中与它最接近的码字作为量化输出。
    
*   **注意点** 📌：
	* ![](content/notes/数字通信原理/第三章模拟信号的数字编码/Pastedimage20250917205759.png)
    *   图(a)中的方形划分，虽然是二维的，但每个分量的量化值只取决于自身，这等效于两个独立的**标量量化**。
    *   图(b)中的六边形划分，一个分量的量化值同时取决于两个分量的大小，这是真正的**矢量量化**。
*   **优点**：
    *   利用了信号分量之间的<font color="orange">相关性</font>，在同样的码率下，性能通常优于标量量化。
    *   是语音和图像压缩编码中的一种基本技术。

---

## 3.4 脉冲编码调制 (PCM)

*   **定义**：将量化后的离散信号值，通过一种规则映射为二进制码组的过程。这是 ADC 的最后一步。
*   **好处**：无论原始信源是什么（语音、图像、数据），经过 ADC 后都变成了统一的 "0" "1" 比特流，便于采用统一的信道编码、加密和传输方式。

#### 常用 PCM 编码

*   **自然码 (Natural Binary Code)**：按数值大小顺序直接转换为二进制。最简单直观。
*   **格雷码 (Gray Code)**：
    *   **特点**：<font color="orange">相邻两个码字之间只有一位比特不同</font>。
    *   **优点**：抗干扰能力强。在数字判决时，如果因为噪声发生判错，只会错到相邻的电平，误差较小。而自然码在某些边界（如0111 -> 1000）可能因一位错误导致巨大跳变。
*   **折叠码 (Folded Binary Code)**：
    *   **结构**：类似符号-幅度表示。最高位为极性位（如'1'代表正，'0'代表负），其余位表示幅度。
    *   **特点**：关于零电平对称。适合小信号概率大的情况。A率PCM就采用折叠码。

#### A率PCM编码
![](content/notes/数字通信原理/第三章模拟信号的数字编码/c9a4052feedc36f36271237febb29f68.png)
![](content/notes/数字通信原理/第三章模拟信号的数字编码/c9b4aa002b9e765a2fd7e48651d7d22c.png)
*   **结构**：采用8位二进制编码。
    `M1 M2 M3 M4 M5 M6 M7 M8`
    *   **M1**：<font color="orange">极性码</font> (1位)
    *   **M2 M3 M4**：<font color="orange">段落码</font> (3位, 8个段落)
    *   **M5 M6 M7 M8**：<font color="orange">段内码</font> (4位, 每个段内16个均匀量化级)

*   **例题：A率PCM编码**
    > **问题**：编码器输入动态范围为 $[-V_p, V_p]$，$V_p=2V$，对输入信号 $x = -0.74V$ 编码。
    > **解答**：
    > 1.  **极性码**：信号为负，所以 $M_1=0$。
    > 2.  **确定单位数**：最大输入电平 $V_p$ 对应 $4096$ 个单位（因为A率PCM正负共$13$段，第一段$32$个单位，后面$6$段每段翻倍，总共 $32 \times (1 + 2 + 4 + 8 + 16 + 32 + 64) = 4064$，加上第$1'$段的$32$，总共$4096$个量化单位）。
    >    $y_n = \frac{|x|}{V_p} \times 4096 = \frac{|-0.74|}{2} \times 4096 = 1515.52$
    > 3.  **段落码**：查询A率编码表，1515.52 落在第6段（1024 ~ 2048）内。第6段的段落码为 `110`。所以 $M_2M_3M_4 = 110$。
    > 4.  **段内码**：
    >    $m = \lfloor \frac{y_n - V_k}{\Delta_k} \rfloor = \lfloor \frac{1515.52 - 1024}{64} \rfloor = \lfloor 7.68 \rfloor = 7$
    >    其中 $V_k=1024$ 是第6段的起始值，$\Delta_k=64$ 是第6段的量化阶距。
    >    $m=7$ 对应的4位二进制码为 `0111`。所以 $M_5M_6M_7M_8 = 0111$。
    > 5.  **最终编码**：`0 110 0111`

---

## 3.5 差分脉冲编码调制 (DPCM)
![](content/notes/数字通信原理/第三章模拟信号的数字编码/Pastedimage20250917214329.png)

*   **引入动机**：多数信号（如语音、图像）的相邻样值之间具有很强的<font color="orange">相关性</font>，即存在<font color="orange">冗余</font>。直接对样值编码（如PCM）效率不高。
*   **基本原理**：
    *   不直接对信号样值 $x(k)$ 编码，而是对<font color="orange">当前样值</font>与一个<font color="orange">预测值</font> $x_e(k)$ 之间的<font color="orange">差值</font> $d(k) = x(k) - x_e(k)$ 进行编码。
    *   由于相关性，预测会比较准，所以差值 $d(k)$ 的动态范围会远小于原始信号 $x(k)$ 的动态范围。
    *   这样，用同样多的比特数可以对差值信号进行更精细的量化，或者用更少的比特数达到与PCM相近的量化效果，从而实现<font color="orange">数据压缩</font>。
    

*   **性能改善**：DPCM相比PCM的性能提升，可以用<font color="orange">预测增益</font> $G_p$ 来衡量。
    $\text{SNR}_{DPCM} = G_p \cdot \text{SNR}_q$
    $G_p = \frac{E[x^2(k)]}{E[d^2(k)]}$
    预测越准，差值功率 $E[d^2(k)]$ 越小，预测增益越大。

*   **自适应差分脉冲编码调制 (ADPCM)**
    *   **动机**：对于语音等非平稳信号，其统计特性是时变的。固定的预测器和量化器无法达到最佳效果。
    *   **原理**：使预测器和量化器能够根据信号的局部特性<font color="orange">自适应</font>地调整参数。
        *   **自适应预测**：动态调整预测系数。
        *   **自适应量化**：动态调整量化阶距。
    *   **效果**：ADPCM的效率和对信号的适应性远高于DPCM。

---

## 3.6 增量调制 (ΔM)

*   **基本思想**：可以看作是 DPCM 的一种极端情况。它是一个<font color="orange">1比特</font>的DPCM系统。
*   **工作原理**：
    1.  比较当前输入样值 $x(t)$ 与前一个重建值（预测值） $x_l(t)$。
    2.  如果 $x(t) > x_l(t)$，编码输出为 `1`，新的重建值在原来基础上增加一个固定步长 $\Delta$。
    3.  如果 $x(t) < x_l(t)$，编码输出为 `0`，新的重建值在原来基础上减小一个固定步长 $\Delta$。
    *   本质上，它只编码信号变化的“趋势”（增加还是减少），用一个阶梯波去近似跟踪原始信号。

*   **缺点与改进**
    1.  **过载失真 (Slope Overload)**：当输入信号的斜率（变化速率）太大，阶梯波跟不上时，会产生过载失真。
    2.  **颗粒噪声 (Granular Noise)**：当输入信号平缓时，阶梯波会在信号上下摆动，产生颗粒噪声。
    *   **改进方法一：Δ-Σ调制**：在编码器输入端加一个积分器，在解码器输出端加一个微分器。这使得过载条件与信号频率无关，只与幅度有关，改善了对高频信号的处理能力。
    *   **改进方法二：自适应增量调制 (ADM)**：使量化步长 $\Delta$ 能够自适应变化。当检测到连续的'1'或'0'（表明可能过载）时，增大步长；当'0'和'1'交替出现（表明信号平缓）时，减小步长。

---

## 3.7 不同编码调制的误码性能分析 📊
![](content/notes/数字通信原理/第三章模拟信号的数字编码/Pastedimage20250921141247.png)
在有信道噪声的情况下，传输的码元可能发生错误，这会对解码后的信号质量产生影响。

*   **增量调制 (ΔM)**：
    *   一个误码只会使重建的阶梯波产生一个幅度为 $2\Delta$ 的跳变，其影响是暂时的。在低通滤波后，这个单个脉冲的影响会被平滑。
    *   ΔM对单个随机误码<font color="orange">不敏感</font>，具有较强的抗误码能力。

*   **线性PCM**：
    *   一个误码的影响取决于它发生在哪一位。
    *   如果发生在<font color="orange">高位 (MSB)</font>，会引起一个巨大的解码电平跳变，产生严重的脉冲噪声。
    *   如果发生在<font color="orange">低位 (LSB)</font>，影响则很小。
    *   PCM对误码，特别是高位误码，<font color="orange">非常敏感</font>。

*   **结论**：
    > 在误码率相同的信道中，<font color="orange">ΔM调制的抗误码性能优于PCM</font>。若要保证总信噪比不低于某个门限，PCM对信道误码率的要求比ΔM要苛刻得多。

---

# 📚 本章学习总结

本章系统地介绍了将模拟信号转换为数字信号的全过程，即 **抽样 -> 量化 -> 编码**。

1.  **抽样** 🌊
    *   核心是**抽样定理**，它告诉我们以多快的频率对信号进行采样才能无失真地恢复原信号。
    *   关键是避免**混叠**，奈奎斯特频率 ($2f_M$) 是最低的理论抽样率。实际中常采用**过采样+抗混叠滤波**的策略。
    *   **带通抽样**则为高频窄带信号提供了一种更高效的采样方法。

2.  **量化** 🔢
    *   量化是A/D转换中不可避免的**有损**过程，会引入**量化噪声**。
    *   **均匀量化**简单，但对小信号不友好；**非均匀量化**（压扩）通过对小信号精细量化、大信号粗略量化，实现了对非均匀分布信号（如语音）的高效编码。
    *   **“6dB法则”** 是一个重要的工程估算依据：每增加1比特量化，信噪比提升6dB。
    *   **矢量量化**通过利用信号样本间的相关性，实现了比标量量化更高的压缩性能。

3.  **编码** 💻
    *   **PCM** 是最基础的编码方式，直接将量化值映射为码字。
    *   **DPCM** 及其升级版 **ADPCM** 利用信号的**相关性**进行**预测编码**，只对差值进行量化编码，大大提高了编码效率，是语音和图像压缩的核心思想之一。
    *   **ΔM** 及其变体 **ADM**、**Δ-Σ调制** 是一种更简单的差值编码，它用1比特来表示信号的变化趋势，结构简单、抗误码能力强，常用于需要高鲁棒性的场合。

**核心权衡**：本章学习的所有技术，本质上都是在 **码率 (带宽/存储)、复杂度、信号质量 (信噪比)** 三者之间进行权衡。没有一种技术是万能的，选择哪种技术取决于具体的应用场景和需求。