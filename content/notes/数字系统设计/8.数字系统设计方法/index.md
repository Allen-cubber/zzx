---
title: 第九章 数字系统设计方法
date: 2025-12-28T08:00:00+08:00
tags:
  - 大三上
  - 数字系统设计
summary: 掌握自顶向下 (Top-down) 的设计流程和模块技术、迭代技术。
---
## 1. 🏗️ 数字系统的层次化结构

数字系统的设计过程可以划分为四个层次，各层次通过<font color="orange">系统设计</font>、<font color="orange">逻辑设计</font>和<font color="orange">物理设计</font>相互映射和转换。

1.  **<font color="orange">性能级</font> (Performance Level)**：
    *   明确要求开发系统“做什么”。
    *   这是最顶层的抽象描述。
2.  **<font color="orange">功能级</font> (Functional Level)**：
    *   把系统划分为若干子系统（模块）。
    *   描述系统的功能划分。
3.  **<font color="orange">结构级</font> (Structural Level)**：
    *   将模块的功能描述转化为实现模块功能的具体硬件和软件的描述。
    *   对应逻辑设计阶段。
4.  **<font color="orange">物理级</font> (Physical Level)**：
    *   也称为电路级。把上一步描述功能的算法转为物理实现（电路布局、布线等）。

---

## 2. ⬇️ 自顶向下 (Top-down) 设计方法

这是一种由抽象定义到具体实现、由高层次到低层次转换逐步求精的设计方法。

*   **流程**：
    1.  **系统设计**：由系统的<font color="orange">性能级</font>描述导出实现系统功能的算法（即功能级）。
    2.  **逻辑设计**：由<font color="orange">功能级</font>描述设计出系统结构框图，详细给出硬件和软件描述（即结构级）。
    3.  **物理设计**：将<font color="orange">逻辑结构</font>转换为电路实现（即物理级）。

> 💡 **优点**：这种设计方法更加接近人的一般思维方式，利于更高效的设计开发，并在设计过程中不断修正错误。

---

## 3. 🧩 模块技术 (系统设计)

<font color="orange">模块化技术</font>是将系统总的功能分解成若干个子功能，通过仔细定义和描述的子系统来实现相应子功能。

*   **设计考量**：
    *   **限制条件**：技术先进性、可行性、经费、时间、资料等。
    *   **核心问题**：如何划分独立又联系的模块？模块间的数据流和控制流是什么？如何控制交互？
    *   **期望目标**：功能完备、易理解性、可靠性、易维护性。
*   **模块结构的描述方法**：
    1.  **<font color="orange">模块结构框图</font>**：用框图表示模块组成及相互关系。
    2.  **<font color="orange">模块功能说明</font>**：用自然语言或专用语言（算法形式）描述输入/输出信号、功能、作用和限制。

---

## 4. 📝 设计举例：串行数据接收器

### 4.1 性能级设计
*   **规格**：8位数据，<font color="orange">奇校验</font>，RS232C格式，TTL电平，速率 $\le$ 100KBPS。
*   **要求**：并行输出接收数据，并指出是否有奇偶误差。
*   **传输格式**：IDLE(高) -> Start(低) -> Data(0-7) -> Parity -> Stop(高)。

### 4.2 系统结构级设计
*   **输入/输出变量**：
    *   输入：$X$ (串行数据)
    *   输出：$Z$ (8位并行数据)，$C$ (输出有效标志，$1$有效)，$P$ (奇偶误差指示，$1$有误)。
*   **功能部件构思**：移位寄存器(R)，计数器(CNT)，触发器(C)，触发器(P)及组合逻辑。
*   **信号交互**：
    *   控制器输出：清零、移位、计数控制、触发器置位/复位信号。
    *   处理器反馈状态：起始信号检测、已收到8位、奇偶误差校验结果。

### 4.3 逻辑级设计
该阶段分为**处理器**和**控制器**两部分设计。

#### (A) 处理器设计
*   **器件选择**：
    *   移位寄存器 (74194)
    *   计数器 (74163)
    *   触发器 (741109)
    *   奇偶校验电路 (743280)
*   **状态变量定义**：
    *   $S_1$ (起始位检测): $\boxed{S_1 = (X=0)}$
    *   $S_2$ (收到8位): $\boxed{S_2 = (CNT=0)}$
    *   $S_3$ (奇偶误差): $\boxed{S_3 = X_1 \oplus X_2 \oplus \dots \oplus X_9}$ (注：$C=1$时，输出$Z=R$)

#### (B) 控制器设计
1.  画出 **ASM图** (算法状态机图)。
2.  **逻辑表达式** (推导出的控制信号)：
    *   次态方程： $\boxed{Q(n+1) = \overline{Q}S1 + Q\overline{S2}}$
    *   清零信号： $\boxed{CLR = \overline{Q}S1}$
    *   读取信号： $\boxed{READ = Q\overline{S2}}$
    *   移位脉冲： $\boxed{STCP = Q S2 S3}$
    *   输出控制： $\boxed{STC = Q S2 \overline{S3}}$

### 4.4 物理级设计
*   涉及布局、布线、PCB等。
*   **VHDL实现**：利用VHDL可以简化设计过程，使设计尽可能脱离硬件细节。

---

## 5. 🔄 迭代技术

<font color="orange">迭代</font>是利用问题本身的结构特性，用简单的逻辑子网络代替复杂的组合逻辑网络。

### 5.1 两种迭代方式
1.  **<font color="orange">空间迭代</font>** (Spatial Iteration)：
    *   利用结构相同的子网络作为单元电路，通过**串接**形成。
    *   **并行处理**，速度快，但硬件复杂。
    *   模型：包含一次输入/输出（外部）和二次输入/输出（级联纽带）。
2.  **<font color="orange">时间迭代</font>** (Temporal Iteration)：
    *   由简单的逻辑子网络，在**时钟控制**下重复执行运算。
    *   **串行处理**，硬件简单，但速度慢。
    *   模型：子网络 + 信息寄存器 + 结果寄存器 + 暂存单元(反馈回路)。

### 5.2 实例：加法器与乘法器

#### 🅰️ 4位二进制加法器
*   **空间迭代**：使用4个全加器(FA)串联，进位链级联。即常见的**并行加法器**。
*   **时间迭代**：使用1个全加器 + 移位寄存器 + D触发器(存进位)。即**串行加法器**。

#### ✖️ 4位数字乘法器设计
*   **方案1：空间迭代**
    *   完全空间意义上的迭代网络。
    *   **特点**：速度快、硬件极其复杂（大量全加器阵列）。
*   **方案2：时间迭代 (部分积左移累加)**
    *   结构：累加寄存器A + 乘数寄存器Q + 被乘数寄存器M + 可控全加器。
    *   **缺点**：寄存器利用率低（A需要双倍位宽）。
*   **方案3：时间迭代 (部分和右移累加)** <font color="orange">推荐</font>
    *   结构：每次加法后，部分和右移。
    *   **优点**：寄存器利用率高，更加直观。
    *   **最终结构**：控制单元 + 组合逻辑网络 (CNT, S, T) + 寄存器组 (M, A, Q)。

---

## 6. 💻 可编程专用芯片设计

### 6.1 设计要求
为了满足市场，产品需具备：
*   满足客户基本需要。
*   稳定可靠。
*   可维护、可继承、易升级。
*   可移植性（便于技术共享）。

### 6.2 设计流程
1.  **<font color="orange">设计目标分析</font>**：确定功能需求（基本目标 -> 阶段目标 -> 可能目标 -> ASIC转换计划）。
2.  **<font color="orange">功能模块划分</font>**：让设计层次分明。
    *   ❗ **重要区别**：
        *   **软件设计**：程序顺序执行，通常不存在时序冲突。
        *   **电路设计**：硬件并行处理，**时序 (Timing)** 是关键，直接影响设计成败。
3.  **<font color="orange">确定时序</font>** (关键电路 & 接口)：
    *   “时序是设计出来的，而不是事后测出来的”。
    *   必须在模块划分阶段就深入考虑时序。
4.  **具体电路设计**：画出原理结构 -> 工作原理时序图 -> 具体电路。
5.  **设计验证**：
    *   软件验证：RTL功能仿真、静态时序验证、时序仿真。
    *   硬件验证。

### 6.3 ⚠️ 关键实例：流水线解决时序违例
*   **问题**：设计要求每 60ns 输出一个数据。原设计中，两个串联的RAM（$256\times7$ 和 $32\times6$）加上逻辑延迟超过了 60ns（关键路径过长）。
*   **解决**：使用<font color="orange">流水线结构</font> (Pipeline)。
    *   在第一个RAM后插入一个**触发器**。
    *   **效果**：将长路径切分为两个工序，每个工序都能在 60ns 内完成。
    *   **代价**：DATA输出会有 60ns 的滞后（Latency），但吞吐率（Throughput）满足了要求。

---

## 7. 📖 本章学习总结

1.  **四大层次**：理解数字系统设计的四个级别（性能级 $\to$ 功能级 $\to$ 结构级 $\to$ 物理级）。
2.  **核心方法**：掌握**自顶向下 (Top-down)** 的设计流程，这是现代数字设计的基础。
3.  **两大技术**：
    *   **<font color="orange">模块技术</font>**：如何合理划分子系统，注意电路设计中并行的**时序**问题。
    *   **<font color="orange">迭代技术</font>**：权衡**时间**（串行、省硬件）与**空间**（并行、速度快、费硬件）的关系。
4.  **设计实践**：通过串行接收器和乘法器的例子，理解从算法到逻辑电路的映射过程。在专用芯片设计中，**时序约束**和**流水线设计**是解决高性能问题的关键手段。