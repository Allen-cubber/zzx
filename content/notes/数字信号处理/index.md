---
title: 数字信号处理笔记合集
date: 2025-11-16T08:00:00+08:00
tags:
  - 大三上
  - 数字信号处理
summary: 数字信号处理笔记合集
---
## 第一章 概述
### 一、课程简介 📝

#### 1. 教材与参考书

*   **主教材** 📖：
    *   [x] S.K. Mitra 著, 余翔宇 译, 《数字信号处理-基于计算机的方法》(第四版), 电子工业出版社, 2019.1。
*   **主要参考书** 📚：
    *   程佩青, 《数字信号处理教程》(第三版), 清华大学出版社, 2007.2。
    *   [x] A.V.奥本海姆, 刘树棠 译, 《离散时间数字信号处理》(第二版), 科学出版社, 1998.7。
    *   [美] 维纳·K·恩格尔, 约翰·G·普罗克斯, 刘树棠 译, 《数字信号处理一使用MatLab》, 西安交通大学出版社, 2002。
    *   胡广书, 《数字信号处理——理论、算法与实现》(第二版), 清华大学出版社, 2003.8。

#### 2. 课程内容与安排

*   **学时分配** ⏰：
    *   理论课: **48** 学时
    *   上机实践: **16** 学时
*   **授课核心内容** 🎯：
    *   数字信号处理概述
    *   离散时间信号的时域及频域分析
    *   离散时间系统的时域及变换域分析
    *   连续时间信号的数字处理 (抽样、量化等)
    *   数字滤波器的结构及设计
    *   随机信号处理简介及应用 (选修)

#### 3. 预备知识

*   《高等数学》
*   《信号与系统》
*   《大学英语》(科技文献阅读)
*   《MATLAB》基本编程知识
*   《概率论与数理统计》(针对随机信号处理部分，选修)

---

### 二、为什么学习数字信号处理 (Why DSP) 🤔

我们每天都生活在“<font color="orange">数字信号</font>的海洋”里。从语音助手到自动驾驶，一切都从数字信号开始。

#### 1. 生活中的DSP实例

*   **实时语音大模型** 🗣️：如“豆包”等AI智能助手，其实时语音交互依赖于DSP技术进行降噪、回声消除和特征提取。
*   **自动驾驶** 🚗：通过处理雷达、摄像头和音频信号来感知周围环境，做出决策。
*   **日常电子产品** 📱：智能手表测量心率、视频通话的声音处理、手机、智能电视、数码相机等。
*   **生活环境数字化** 🏙️：智慧城市、智能家居、数字图书馆等，都依赖于对各种传感器信号的数字化处理。

#### 2. 未来科技离不开DSP

<font color="orange">DSP</font>是未来科技的基石。信号是食材，DSP是厨师，AI是大脑。没有经过DSP良好处理的信号（食材），AI（大脑）也无法做出正确的判断（“吃坏肚子”）。

*   **实时语音大模型中的DSP技术**：
    *   **音频前端处理**：通过噪声抑制、声学回声消除（AEC）、语音活动检测（VAD）等技术净化信号，让模型“听得清”。
    *   **特征提取**：使用STFT/FFT将一维声音波形变换为二维时频谱，再通过MFCCs等技术提取对AI友好的紧凑特征。
    *   **语音合成**：利用声码器（Vocoder）等技术将模型预测的频谱特征渲染成高质量的音频。

*   **自动驾驶中的DSP技术**：
    *   **雷达信号处理**：通过FFT分析雷达回波，计算目标的<font color="orange">距离</font>、<font color="orange">速度</font>和<font color="orange">角度</font>。
    *   **图像信号处理**：进行降噪、锐化、色彩重建和边缘检测，为目标识别提供清晰的视觉输入。
    *   **音频信号处理**：通过波束成形和STFT识别紧急车辆（如救护车）的警报声，并进行声源定位。

#### 3. 两个经典DSP问题

*   **降噪耳机的秘密：自适应滤波** 🎧
    *   **核心原理**：主动噪声控制 (ANC)。通过麦克风采集环境噪声，然后通过算法（如LMS自适应最小化误差算法）生成一个与噪声<font color="orange">相位相反</font>的声波，利用波的干涉效应将噪声抵消。

*   **为什么车轮会“倒转”：采样与混叠** 🎡
    *   **核心原理**：<font color="orange">奈奎斯特采样定理</font>。当人眼或摄像机的采样频率（$f_s$）不满足大于信号最高频率（$f_m$）两倍的条件时，就会发生<font color="orange">混叠</font>现象，导致我们感知到错误的运动方向。
    *   **奈奎斯特采样公式**:
        $$ \boxed{f_s > 2f_m} $$

---

### 三、数字信号处理概念 💡

#### 1. 两个核心概念

*   **DSP: Digital Signal Processing (数字信号处理)**
    *   这是一门<font color="orange">学科</font>，研究如何用数值计算的方法对离散化的数字信号进行分析和处理，以达到提取有用信息的目的。
    *   常用处理方法包括：AD/DA转换、滤波、检测、变换、编码、压缩、增强等。

*   **DSP: Digital Signal Processor (数字信号处理器)**
    *   这是一种专用的<font color="orange">硬件芯片</font> (微处理器)，其体系结构专门为高速、实时、高效地执行数字信号处理算法而设计。

⚠️ **易错点**: 注意区分 **DSP** 作为一门“学科”和作为一种“芯片”的两种不同含义。前者是理论基础，后者是硬件实现。

#### 2. 数字信号处理的优缺点

*   **优点** 👍：
    *   **抗干扰能力强**：对元件参数不敏感，受温度、环境影响小。
    *   **精度高**：数字系统可以达到很高的精度 (如10⁻⁵)，远超模拟系统。
    *   **保密性好**：易于对数字信号进行加密。
    *   **灵活性强**：通过修改软件程序即可改变系统功能，无需改动硬件。
    *   **可实现复杂功能**：能实现模拟系统难以做到的严格线性相位、多抽样率处理等。
    *   **易于存储和分析**：可以无失真地存储和传输，并进行复杂的分析处理。

*   **不足** 👎：
    *   **系统更复杂**：需要进行模数(A/D)和数模(D/A)转换。
    *   **处理频率受限**：受采样频率的限制，能处理的信号带宽有限。
    *   **功耗较大**：数字系统由有源器件（晶体管）构成，功耗相对较高。

#### 3. 一个熟悉的DSP系统流程

模拟信号进行数字处理的典型流程如下：
**输入模拟信号 f(t) ➡️ 防混叠滤波器 ➡️ A/D转换器 ➡️ 数字处理系统 ➡️ D/A转换器 ➡️ 平滑滤波器 ➡️ 输出模拟信号**

---

### 四、信号的概念及分类 📊

#### 1. 什么是信号？

信号是含有一定<font color="orange">信息量</font>的时间的<font color="orange">函数</font>。这里的“时间”是广义概念，也可以是空间、频率等多维变量。

#### 2. 信号的分类

*   **按时间变量的连续性**：
    *   **模拟信号 (Analog signal)**: 时间连续，幅度也连续。
    *   **离散信号 (Discrete signal)**: 时间不连续 (离散)，幅度连续。
    *   **数字信号 (Digital signal)**: 时间不连续 (离散)，幅度也不连续 (量化)。
    *   **注意点** 💡: <font color="orange">采样</font>使信号在时间上离散，<font color="orange">量化</font>使信号在幅度上离散。模拟信号经过采样得到离散信号，再经过量化得到数字信号。

*   **按自变量个数**：
    *   **一维信号**：如语音信号。
    *   **二维信号**：如黑白图像。
    *   **三维信号**：如彩色图像 (可视为三个二维信号的叠加)、黑白视频。

*   **按信号取值的确定性**：
    *   **确定性信号 (Deterministic signal)**: 信号的取值在任何时刻都是确定的，可以用数学公式精确描述，如正弦信号。
    *   **随机信号 (Random signal)**: 信号的取值具有不确定性，无法用精确的数学公式描述，只能用概率统计的方法来分析，如语音、天气、金融信号。

*   **其他分类维度**：
    *   周期信号 / 非周期信号
    *   能量信号 / 功率信号
    *   因果信号 / 非因果信号
    *   对称信号 / 反对称信号

---

### 五、典型信号与处理运算举例 🧮

#### 1. 典型信号

*   **语音信号** 🎤
*   **生物电信号** ❤️：
    *   心电图信号 (ECG): 心脏的电活动。
    *   脑电图信号 (EEG): 脑部的自发性生物电位。
    *   肌电信号 (EMG): 肌肉收缩产生的动作电位。
*   **图像信号** 🖼️

#### 2. 信号处理基本运算

*   **基本时域运算**：
    *   加法：`x(n) = x₁(n) ± x₂(n)`
    *   乘法：`x(n) = x₁(n) · x₂(n)` (常用于调制、加窗等)
    *   标乘：`x[n] = Ax₁[n]`
    *   延时：`y(n) = x(n - n₀)`
    *   积分：`y(t) = ∫₋∞ᵗ x(τ)dτ`
    *   微分：`w(t) = dx(t)/dt`

*   **滤波 (Filtering)** 🌪️：
    *   滤波是信号处理最重要的手段之一，通过改变信号的<font color="orange">频谱</font>来选择或抑制某些频率成分。
    *   **常见滤波器类型**：
        *   **低通滤波器**：只允许低频信号通过。
        *   **高通滤波器**：只允许高频信号通过。
        *   **带通滤波器**：只允许某一频段的信号通过。
        *   **陷波器**：抑制某一特定频率的信号。
    *   **应用**：图像去噪、图像增强等。

*   **调制 (Modulation)** 📡：
    *   目的：将低频信号（基带信号）加载到高频信号（载波）上，以便在高频信道中传输。
    *   **常用方法**：幅度调制 (AM)、频率调制 (FM)、相位调制 (PM)。

---

### 六、本章学习总结 ✨

本讲作为数字信号处理的入门，主要围绕**“是什么 (What)”**、**“为什么 (Why)”** 和 **“怎么做 (How)”** 三个核心问题展开。

1.  **课程定位 (What & Why)** 📍: 我们首先了解了课程的整体安排、学习目标和考核方式。接着，通过大量生动的实例（从语音助手到自动驾驶，从降噪耳机到车轮倒转），深刻体会到DSP技术已经渗透到现代生活的方方面面，是信息时代不可或缺的<font color="orange">基础工具</font>，这激发了我们学习本课程的浓厚兴趣。

2.  **核心概念 (What)** 🧠: 我们明确了DSP的两个核心定义——作为一门分析处理信号的**学科**和作为一种实现算法的**硬件芯片**。并系统比较了数字信号处理相对于模拟处理的各项优缺点，理解了其高精度、高灵活性的本质优势。

3.  **信号基础 (What)** 📊: 我们重新梳理了“信号”的定义，并从多个维度对信号进行了系统分类，特别是掌握了模拟信号、离散信号和数字信号之间的关系，这是后续学习的基础。同时，对确定性信号和随机信号的区分，为我们指明了本课程的主要研究对象——<font color="orange">离散时间确定性信号</font>。

4.  **基本运算 (How)** 🛠️: 最后，我们初步接触了信号处理的一些基本运算，如时域的加、乘、延时，以及信号处理中最重要的操作之一——<font color="orange">滤波</font>。这为我们后续深入学习更复杂的处理算法奠定了基础。

总之，第一讲为我们描绘了数字信号处理的宏伟蓝图，让我们对这门学科的重要性和应用前景有了全面的认识，并掌握了学习这门课程所必需的基本概念和术语。

## 第二章 离散时间信号的时域分析
### 一、离散时间信号的时域表示 📈

#### 1. 基本概念

*   **离散信号**：时间取值<font color="orange">离散</font>的信号，通常称为 **时间序列** 或 **序列**。
*   **来源** 🌊：离散序列通常是对一个连续时间信号 $x_a(t)$ 以固定的时间间隔进行<font color="orange">周期性采样</font>得到的。

    $$ x[n] = x_a(t)|_{t=nT} = x_a(nT), \quad n = \dots, -2, -1, 0, 1, 2, \dots $$

*   **相关术语** ⏱️：
    *   **采样周期 (T)**：两次采样之间的时间间隔，单位为秒(s)。
    *   **采样频率 (fs)**：也称为采样率，是采样周期的倒数 ($f_s = 1/T$)，表示每秒采样的次数，单位为赫兹(Hz)。

⚠️ **注意点**：离散信号是在时间轴上离散的，但其在每个采样点的<font color="orange">取值（幅度）可以是连续的</font>。例如，一个实序列的采样值可以是2.3, 3.5, 4.7等任意实数。

#### 2. 序列的类型

*   **实序列**：序列中的每一个采样值都是实数。
    *   例如: $\{x[n]\} = \{\dots, 2.3, 3.5, 4.7, 2.0, \dots\}$
*   **复序列**：序列中的采样值为复数。
    *   表达式: $x[n] = x_{re}[n] + j \cdot x_{im}[n]$
    *   例如: $\{x[n]\} = \{\dots, 1+j2, 3.5+j4, \dots\}$

#### 3. 信号的强度 (范数)

信号的强度或大小可以用<font color="orange">范数</font>来衡量。

*   **Lₚ 范数**：
$$ \|x\|\_p \= \left( \sum_{n=-\infty}^{\infty} |x[n]|^p \right)^{1/p} $$
*   **常用范数**：
    *   **L₂ 范数**：均方根值，表示信号的能量。 `norm(x, 2)` 或 `norm(x)`。
    *   **L₁ 范数**：平均绝对值。 `norm(x, 1)`。
    *   **L∞ 范数**：绝对值的峰值（最大值）。 `norm(x, inf)`。

---

### 二、离散时间信号的运算 ⚙️

#### 1. 基本运算

| 运算 | 表达式 | 物理/应用意义 |
| :--- | :--- | :--- |
| **相乘 (Product)** | $w[n] = x[n] \cdot y[n]$ | 调制、加窗 |
| **相加 (Addition)** | $w[n] = x[n] + y[n]$ | 信号叠加、混音 |
| **数乘 (Multiplication)** | $w[n] = A \cdot x[n]$ | 信号放大/衰减，如调节音量 |
| **时移 (Time-shifting)** | $w[n] = x[n - N]$ | 信号延迟，如产生回声(Echo) |
| **时反 (Time-reversal)** | $w[n] = x[-n]$ | 信号在n=0处翻转，也称折叠 |
| **触点 (Pick-off)** | - | 从信号通路中引出一个分支 |

#### 2. 基本运算的组合

通过组合上述基本运算，可以构建出复杂的信号处理系统。这些系统通常用<font color="orange">差分方程</font>来描述输入 $x[n]$ 和输出 $y[n]$ 之间的关系。

*   **示例1 (FIR系统)**:
    $$ y[n] = \alpha_1 x[n] + \alpha_2 x[n-1] + \alpha_3 x[n-2] + \alpha_4 x[n-3] $$
    该系统的输出仅与当前和过去的输入有关。

*   **示例2 (IIR系统)**:
    $$ y[n] = b_0 x[n] + b_1 x[n-1] + b_2 x[n-2] + a_1 y[n-1] + a_2 y[n-2] $$
    该系统的输出不仅与输入有关，还与过去的输出有关（反馈）。

#### 3. 采样率转换

*   **定义**：从一个给定序列生成一个采样率不同于它的新序列的运算。
*   **采样率转换比**: $R = F'_T / F_T$，其中 $F_T$ 是原采样率，$F'_T$ 是新采样率。
*   **上采样 (插值)** 🔼：提高采样率 ($R>1$)。在原始采样点之间插入 $L-1$ 个零点。
    $$ x_u[n] = \begin{cases} x[n/L], & n = 0, \pm L, \pm 2L, \dots \\ 0, & \text{otherwise} \end{cases} $$
*   **下采样 (抽取)** 🔽：降低采样率 ($R<1$)。每 $M$ 个采样点中保留一个，其余丢弃。
    $$ y[n] = x[nM] $$
*   **应用**：图像的缩放、数字语音信号的采样率调整。

#### 4. 卷积 🌟

卷积是信号处理中极其重要的运算，可以用来创造空间混响效果。
$$ \boxed{y[n] = x[n] * h[n] = \sum_{k=-\infty}^{\infty} x[k]h[n-k]} $$

*   **物理意义**：一个“干”的语音信号 $x[n]$ 与一个房间的<font color="orange">脉冲响应(Impulse Response)</font> $h[n]$ 进行卷积，得到的结果 $y[n]$ 就好像这个声音是在该房间里发出的一样。

---

### 三、离散时间信号的分类 🗂️

*   **按长度**：
    *   **有限长序列**：仅在有限的时间范围内非零。
    *   **无限长序列**：
        *   **右边序列** (因果序列是其特例): $x[n] = 0, \text{ for } n < N_1$
        *   **左边序列**: $x[n] = 0, \text{ for } n > N_2$
        *   **双边序列**: 在正负无穷区间都有非零值。

*   **按对称性**：
    *   **实序列**：
        *   任意实序列都可分解为一个<font color="orange">偶序列</font>和一个<font color="orange">奇序列</font>之和。
        *   偶部: $x_{ev}[n] = \frac{1}{2}(x[n] + x[-n])$
        *   奇部: $x_{od}[n] = \frac{1}{2}(x[n] - x[-n])$
    *   **复序列**：
        *   任意复序列都可分解为一个<font color="orange">共轭对称序列</font>和一个<font color="orange">共轭反对称序列</font>之和。
        *   共轭对称部: $x_{cs}[n] = \frac{1}{2}(x[n] + x^*[-n])$
        *   共轭反对称部: $x_{ca}[n] = \frac{1}{2}(x[n] - x^*[-n])$

*   **按周期性**：
    *   **周期序列**：满足 $x[n] = x[n+N]$，N为周期。
    *   **非周期序列**：不满足周期性。

*   **能量和功率序列**：
    *   **能量**：$ E_x = \sum_{n=-\infty}^{\infty} |x\[n\]|^2 $
    *   **平均功率**：$ P_x = \lim_{K \to \infty} \frac{1}{2K+1} \sum_{n=-K}^{K} |x\[n\]|^2 $
    *   **能量信号**：能量有限 ($E_x < \infty$)，则功率为0。
    *   **功率信号**：功率有限 ($0 < P_x < \infty$)，则能量无限。

*   **按因果性** 💡：
    *   **因果序列**：对于所有的 $n < 0$，$x[n]=0$。即序列在n=0之前没有值。
    *   **非因果序列**：不满足因果条件的序列。

---

### 四、一些典型的时间序列及其性质 🔧

这些基本序列是构成复杂信号的“积木”。

1.  **单位采样序列 (单位冲击序列)**
    $$ \delta[n] = \begin{cases} 1, & n = 0 \\ 0, & n \neq 0 \end{cases} $$
    **作用**：它是构建任意序列的基础。

2.  **单位阶跃序列**
    $$ \mu[n] = \begin{cases} 1, & n \ge 0 \\ 0, & n < 0 \end{cases} $$
    **与单位冲击的关系**：
    *   $\mu[n] = \sum_{k=-\infty}^{n} \delta[k]$ (阶跃是冲击的累加)
    *   $\delta[n] = \mu[n] - \mu[n-1]$ (冲击是阶跃的差分)

3.  **任意序列的表示定理** 🌟
    任意离散序列 $x[n]$ 都可以表示为一系列<font color="orange">加权的、移位的单位冲击序列</font>之和。
    $$ \boxed{x[n] = \sum_{m=-\infty}^{\infty} x[m]\delta[n-m]} $$
    这个公式表明，$x[n]$ 在任意时刻n的值，都可以通过筛选出单位冲击序列 $\delta[n-m]$ 在 $n=m$ 时的值，并乘以该点的幅值 $x[m]$ 来得到。

4.  **正弦序列**
    $$ x[n] = A\cos(\omega_0 n + \phi) $$
    其中 A 是<font color="orange">振幅</font>，$\omega_0$ 是<font color="orange">数字角频率</font>，$\phi$ 是<font color="orange">相位</font>。

5.  **指数序列**
    $$ x[n] = A\alpha^n $$
    可以是实指数序列（α为实数）或复指数序列（α为复数）。

---

### 五、时间序列的相关分析 🤝

相关分析用于度量两个信号之间，或一个信号本身在不同时刻的<font color="orange">相似程度</font>。

#### 1. 互相关函数

*   **定义**：度量两个不同序列 $x[n]$ 和 $y[n]$ 之间的相似性。
    $$ \boxed{r_{xy}[l] = \sum_{n=-\infty}^{\infty} x[n]y[n-l]} $$
    其中，$l$ 是时延。
*   **应用**：雷达和声纳探测。通过计算发射信号和接收信号的互相关，找到相关峰值对应的时延 $l$，从而确定目标的距离。在“听歌识曲”中，用于在长音频中匹配一小段旋律。

#### 2. 自相关函数

*   **定义**：度量一个序列 $x[n]$ 与其自身在不同延时下的相似性。
    $$ \boxed{r_{xx}[l] = \sum_{n=-\infty}^{\infty} x[n]x[n-l]} $$
*   **性质**：
    *   在 $l=0$ 时，自相关函数取得<font color="orange">最大值</font>，且 $r_{xx} = E_x$ (信号的总能量)。
    *   对于实序列，$r_{xx}[l]$ 是一个<font color="orange">偶函数</font>，即 $r_{xx}[l] = r_{xx}[-l]$。
*   **应用**：检测信号中隐藏的<font color="orange">周期性</font>。如果信号含有周期成分，其自相关函数也会呈现出同样的周期性。

#### 3. 卷积与相关的关系

相关运算可以看作是“找相同”，而卷积运算可以看作是“找不同”（一个信号对另一个信号的响应）。
从数学上看，互相关可以表示为其中一个信号<font color="orange">翻转</font>后与另一个信号做<font color="orange">卷积</font>。
$$ r_{yx}[l] = y[l] * x[-l] $$

---

### 六、本章学习总结 ✨

本讲深入探讨了离散时间信号在<font color="orange">时域</font>的表示、运算和分析方法，是后续所有章节学习的基石。

1.  **信号的表示与来源** 📝: 我们明确了离散序列是对连续信号采样得到的，并学习了如何用数学形式和图形表示序列。同时，掌握了用“范数”来衡量信号的强度。

2.  **核心运算** 🛠️: 我们系统学习了序列的相加、相乘、数乘、时移、时反等基本运算，并通过框图理解了如何组合它们构成复杂的处理系统（如FIR和IIR滤波器）。此外，还掌握了采样率转换（插值与抽取）和卷积这两个高级且实用的运算。

3.  **信号的分类体系** 📂: 我们从长度、对称性、周期性、能量/功率、因果性等多个维度，建立了一套完整的信号分类体系。这对后续选择合适的分析工具至关重要。

4.  **基本序列** 🧱: 我们重点学习了单位冲击序列和单位阶跃序列，并理解了它们作为“基本构件”的核心地位。特别是**“任意序列都可以表示为冲击序列的加权和”**这一重要定理，是理解线性时不变系统的关键。

5.  **相关分析** 🔍: 我们学习了互相关和自相关这两个强大的分析工具。理解了它们“度量相似度”的物理本质，并掌握了它们在雷达测距、周期检测和听歌识曲等领域的实际应用。

总的来说，本章为我们提供了分析和操作离散信号所需的全套“时域工具箱”。熟练掌握这些基础知识，将为我们后续进入更复杂的变换域分析（如傅里叶变换、Z变换）打下坚实的基础。

## 第三章P1 傅里叶变换
### 📚 本讲主要内容
*   **参考**：课本第三章 (3.1-3.6) 和第四章 (4.8)
1.  **回顾祖辈** (CTFS and CTFT)
2.  **认识父辈** (DTFT)
3.  **迎接王者** (DFT/FFT)
4.  **前沿实战** (Applications)
5.  傅里叶变换及性质
6.  离散时间LTI系统的频率响应

---

### 一、从理论到计算的伟大旅程 🚀

本章将傅里叶分析方法比作一个“四世同堂”的家族，讲述其从纯理论的连续世界，一步步演化到可被计算机处理的离散世界的伟大旅程。

| 变换缩写 | 中文全称 |
| :--- | :--- |
| **CTFS** | 连续时间傅里叶级数 |
| **CTFT** | 连续时间傅里叶变换 |
| **DTFT** | 离散时间傅里叶变换 |
| **DFT** | 离散傅里叶变换 |
| **FFT** | 快速傅里叶变换 |

#### 1. 👴 祖辈 - 连续时间傅里叶级数 (CTFS)

*   **家族起源**：周期世界的鼻祖。
*   **功能**：将<font color="orange">连续、周期</font>的模拟信号 $x(t)$，变换成<font color="orange">离散、非周期</font>的谐波分量（频谱）$a_k$。
*   **傅里叶结论**：任何周期信号都可以表示为成谐波关系的正弦信号的加权和。
*   **局限性**：只能分析无限重复的模式，无法处理单个、孤立的事件。
*   **CTFS变换对**：
    $\boxed{a_k = \frac{1}{T} \int_T x(t)e^{-jk\omega_0 t} dt}$
    $\boxed{x(t) = \sum_{k=-\infty}^{\infty} a_k e^{jk\omega_0 t}}$

#### 2. 👵 祖辈 - 连续时间傅里叶变换 (CTFT)

*   **思想飞跃**：从周期信号的CTFS到非周期信号的CTFT。这是通过将周期 $T \to \infty$ 实现的，此时基频 $\omega_0 = 2\pi/T \to 0$，频谱从离散谱线变为连续曲线。
*   **功能**：将<font color="orange">连续、非周期</font>的模拟信号 $x(t)$，变换成<font color="orange">连续、非周期</font>的频谱 $X(j\Omega)$。
*   **优势**：可以分析单个、孤立的信号，极大地扩展了理论边界。
*   **局限性**：和CTFS一样，只能处理连续的模拟世界。
*   **CTFT变换对**：
    $\boxed{X(j\Omega) = \int_{-\infty}^{\infty} x(t)e^{-j\Omega t} dt}$
    $\boxed{x(t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} X(j\Omega)e^{j\Omega t} d\Omega}$

#### 3. 👨‍👩‍👧‍👦 父辈 - 离散时间傅里叶变换 (DTFT)

*   **数字先驱**：进入0和1的数字世界。DTFT是通过对CTFT的信号进行时域采样得到的。
*   **功能**：将<font color="orange">离散、非周期</font>的数字序列 $x[n]$，变换成<font color="orange">连续、周期性</font>的频谱 $X(e^{j\omega})$。
*   **周期性来源**：时域的采样，导致了频域的周期延拓。
*   **局限性**：时域已经是数字信号，但频域仍然是连续的，计算机无法直接处理和存储连续函数。
*   **DTFT变换对**：
    $\boxed{X(e^{j\omega}) = \sum_{n=-\infty}^{\infty} x[n]e^{-j\omega n}}$
    $\boxed{x[n] = \frac{1}{2\pi} \int_{2\pi} X(e^{j\omega})e^{j\omega n} d\omega}$

#### 4. 👑 王者 - 离散傅里叶变换 (DFT/FFT)

*   **工程师的终极武器**：让一切可计算。DFT通过对DTFT的频谱进行频域采样，完成了最后一步的离散化。
*   **功能**：将<font color="orange">有限长、离散</font>的序列 $x[n]$，变换成<font color="orange">有限长、离散</font>的频谱 $X[k]$。
*   **关键词**：时域、频域均为**双离散**、**有限长**。
*   **FFT (快速傅里叶变换)**：是一种高效计算DFT的算法，让实时频谱分析成为可能，推动DFT从理论走向大规模应用。

#### 5. 📱 前沿实战：FFT在哪儿？

*   **智能手机里的“听歌识曲” — Shazam “声音指纹”技术**
    *   **挑战**：用户录音充满噪音，且只是歌曲的一小段，如何精准匹配？
    *   **解密**：FFT是制作“声音指纹”的关键。
        1.  **时域波形**：原始的录音信号。
        2.  **频谱图 (STFT)**：通过对音频进行分段FFT，得到时频谱图(Spectrogram)，将一维声音信号变为二维图像。
        3.  **声音指纹**：在频谱图上提取能量最强的峰值点（特征点），这些点的“频率-时间”坐标构成了对噪声不敏感的、独特的“声音指紋”。通过匹配指纹库实现识曲。
*   **频域表示的优点**：
    时域波形可能看起来非常杂乱无章，但变换到频域后，信号的内在频率结构会变得清晰。对于许多分类任务（如识别脚步声），频域特征比时域特征<font color="orange">更稳定、更具区分度</font>。

---

### 二、傅里叶及其变换 📜

#### 1. 为什么需要傅里叶变换？

*   **核心目的**：分析信号的<font color="orange">频率成分</font>。
*   **历史**：傅里叶在研究热传导方程时发现，解函数可以由三角函数构成的级数表示，从而提出**任何函数都可以展开成三角函数的无穷级数**。
*   **现代意义**：傅里叶变换具有极好的性质，使其应用广泛。
    1.  **对称性**：正变换与逆变换形式非常相似。
    2.  **LTI系统特征**：正弦基函数是LTI系统的**本征函数**，即输入一个正弦波，输出还是同频率的正弦波，只是幅度和相位可能变化。这使得分析LTI系统对复杂信号的响应变得简单。
    3.  **卷积定理**：时域的复杂<font color="orange">卷积</font>运算可以转换成频域的简单<font color="orange">乘积</font>运算。
    4.  **快速计算**：离散形式的傅里叶变换有高效的FFT算法。

#### 2. 傅里叶变换的表示

傅里叶变换的结果是一个复数函数，可以表示为：
*   **CTFT**: $X_a(j\Omega) = X_{re}(j\Omega) + jX_{im}(j\Omega) = |X_a(j\Omega)|e^{j\theta_a(\Omega)}$
*   **DTFT**: $X(e^{j\omega}) = X_{re}(e^{j\omega}) + jX_{im}(e^{j\omega}) = |X(e^{j\omega})|e^{j\theta(\omega)}$
    *   **幅度谱**：$|X(\cdot)|$，表示各个频率分量的强度。
    *   **相位谱**：$\theta(\cdot)$，表示各个频率分量的相位。

#### 3. 傅里叶变换的收敛条件

*   **CTFT收敛条件 (Dirichlet条件)**
    1.  信号在整个时间轴上<font color="orange">绝对可积</font>。
    2.  在任何有限区间内，信号只有有限个极值点和不连续点。
    3.  在任何有限区间内，信号的不连续点都是第一类间断点。

*   **DTFT收敛条件**
    1.  **一致收敛**：一个<font color="orange">充分条件</font>是序列 $x[n]$ **绝对可和**，即 $\sum_{n=-\infty}^{\infty}|x[n]| < \infty$。
    2.  **均方收敛**：对于能量有限但不绝对可和的序列（如理想低通滤波器的冲激响应），DTFT在均方意义下收敛。
> 💡 **注意点**：绝对可和的序列一定能量有限，但能量有限的序列**不一定**绝对可和。

#### 4. 能量密度谱

*   **Parseval定理**：信号在时域的总能量等于其在频域的总能量。
    *   **连续信号**: $\mathcal{E}_x = \int_{-\infty}^{\infty} |x_a(t)|^2 dt = \frac{1}{2\pi} \int_{-\infty}^{\infty} |X_a(j\Omega)|^2 d\Omega$
    *   **离散序列**: $\mathcal{E}_g = \sum_{n=-\infty}^{\infty} |g[n]|^2 = \frac{1}{2\pi} \int_{-\pi}^{\pi} |G(e^{j\omega})|^2 d\omega$
*   **能量密度谱**：单位频率的能量，定义为 $|X(\cdot)|^2$。
*   **维纳-辛欣定理**：信号的<font color="orange">自相关函数</font>的傅里叶变换是其**能量密度谱**。

---

### 三、DTFT性质 🌟

#### 1. 常用DTFT变换对

| 序列 $x[n]$         | 频谱 $X(e^{j\omega})$                                                               | 说明           |
| :---------------- | :-------------------------------------------------------------------------------- | :----------- |
| $\delta[n]$       | $1$                                                                               | 冲激在时域，恒定在频域  |
| $1$               | $\sum_{k=-\infty}^{\infty} 2\pi\delta(\omega + 2\pi k)$                           | 恒定在时域，冲激串在频域 |
| $u[n]$            | $\frac{1}{1-e^{-j\omega}} + \sum_{k=-\infty}^{\infty} \pi\delta(\omega + 2\pi k)$ | 阶跃信号         |
| $e^{j\omega_0 n}$ | $\sum_{k=-\infty}^{\infty} 2\pi\delta(\omega - \omega_0 + 2\pi k)$                | 单频复指数        |

#### 2. 基本性质

| 性质 | 序列 | 离散时间傅里叶变换 |
| :--- | :--- | :--- |
| **线性** | $ag[n] + \beta h[n]$ | $aG(e^{j\omega}) + \beta H(e^{j\omega})$ |
| **时移** | $g[n-n_0]$ | $e^{-j\omega n_0} G(e^{j\omega})$ |
| **频移** | $e^{j\omega_0 n}g[n]$ | $G(e^{j(\omega-\omega_0)})$ |
| **卷积** | $g[n] * h[n]$ | $G(e^{j\omega})H(e^{j\omega})$ |
| **相乘** | $g[n]h[n]$ | $\frac{1}{2\pi}\int_{-\pi}^{\pi} G(e^{j\theta})H(e^{j(\omega-\theta)})d\theta$ |

#### 3. 对称性质

*   **周期性**：任意信号的DTFT都是以 $2\pi$ 为周期的周期函数。
*   **实序列的DTFT对称性**：若 $x[n]$ 是实序列，则其DTFT具有<font color="orange">共轭对称性</font>。
    $\boxed{X(e^{j\omega}) = X^*(e^{-j\omega})}$
    *   **幅度谱**：$|X(e^{j\omega})| = |X(e^{-j\omega})|$ (偶对称)
    *   **相位谱**：$\arg\{X(e^{j\omega})\} = -\arg\{X(e^{-j\omega})\}$ (奇对称)
    *   **实部**：$X_{re}(e^{j\omega}) = X_{re}(e^{-j\omega})$ (偶对称)
    *   **虚部**：$X_{im}(e^{j\omega}) = -X_{im}(e^{-j\omega})$ (奇对称)

---

### 四、离散时间LTI系统的频率响应 🎶

#### 1. 概念

*   LTI系统的**频率响应** $H(e^{j\omega})$ 定义为其**单位冲激响应** $h[n]$ 的傅里叶变换 (DTFT)。
    $\boxed{H(e^{j\omega}) = \sum_{n=-\infty}^{\infty} h[n]e^{-j\omega n}}$
*   **核心关系**：时域卷积等于频域相乘。
    $\boxed{Y(e^{j\omega}) = H(e^{j\omega})X(e^{j\omega})}$

#### 2. 物理意义

当一个LTI系统的输入是频率为 $\omega_0$ 的复指数信号 $x[n]=e^{j\omega_0 n}$ 时，其输出为：
$y[n] = H(e^{j\omega_0}) e^{j\omega_0 n}$
这表明，复指数序列是LTI系统的**本征函数**，频率响应 $H(e^{j\omega_0})$ 是对应的**本征值**。系统仅对信号进行幅度和相位的调整，而不改变其频率。

#### 3. 频率特性

*   **幅频特性**：$|H(e^{j\omega})|$，描述系统对不同频率信号的幅度放大或衰减程度。
*   **相频特性**：$\theta(\omega)$，描述系统对不同频率信号的相位移动。
*   **增益函数**：$G(\omega) = 20\log_{10}(|H(e^{j\omega})|)$ (单位：dB)
*   **相位延迟与群延迟**
    *   **相位延迟**：$\tau_p(\omega_0) = -\frac{\theta(\omega_0)}{\omega_0}$，表示单个频率正弦波的延迟时间。
    *   **群延迟**：$\tau_g(\omega) = -\frac{d\theta(\omega)}{d\omega}$，表示窄带信号包络的延迟时间。
> 💡 **注意点**：对于无失真传输，系统需要有**常数**的群延迟，这意味着其相位响应是**线性**的。具有对称系数的FIR滤波器具有线性相位（常数群延迟）。

#### 4. 示例：简单数字滤波器设计

*   **问题**：设计一个长度为3的实对称FIR滤波器，要求通过 $\omega = 0.4$ 的分量，拦截 $\omega = 0.1$ 的分量。
*   **解**：
    1.  设 $h[0]=h[2]=a, h[1]=b$。
    2.  频率响应幅度为 $|H(e^{j\omega})| = |2a\cos\omega + b|$。
    3.  根据要求列方程：
        *   $|H(e^{j0.1})| = |2a\cos(0.1) + b| = 0$
        *   $|H(e^{j0.4})| = |2a\cos(0.4) + b| = 1$
    4.  解这个二元一次方程组即可得到滤波器系数 $a$ 和 $b$。

---

### 📝 本章学习总结

本讲以“四世同堂”的生动比喻，系统梳理了傅里叶分析方法的发展脉络，是连接时域和频域的关键桥梁。

1.  **演化路径**：我们理解了从处理**连续周期**信号的 **CTFS**，到**连续非周期**的 **CTFT**，再到**离散非周期**的 **DTFT**，最终到完全可计算的**离散有限长**的 **DFT/FFT** 的逻辑演进。每一步都是为了解决前一步的局限性，最终服务于计算机处理。

2.  **DTFT的核心地位**：DTFT是本章的理论核心，它将离散时间序列映射到连续的频域，揭示了信号的频谱结构。DTFT的各种性质，特别是<font color="orange">卷积定理</font>，是频域分析的基础。

3.  **频率响应的深刻意义**：我们将时域的冲激响应 $h[n]$ 与频域的频率响应 $H(e^{j\omega})$ 通过DTFT联系起来。频率响应直观地描述了LTI系统如何“对待”不同频率的输入信号，是分析和设计滤波器的根本工具。

4.  **从理论到实践**：通过Shazam的例子，我们看到了FFT在现实世界中的强大应用。通过滤波器设计和延迟分析，我们了解了如何运用频率响应的概念来解决实际问题。

总之，本章建立了信号与系统分析的**频域视角**。掌握DTFT及其性质，并深刻理解频率响应的物理意义，是进行更高级信号处理（如滤波器设计、谱分析等）的必备基础。

## 第三章P2 连续时间信号的采样与量化
### 📚 本讲主要内容
*   **参考**：课本第三章 (3.8-3.10)
1.  连续时间信号的采样
2.  采样定理
3.  信号量化
4.  举例与频率概念辨析

---

### 一、连续时间信号的采样 🕒 ➡️ 🔢

采样是连接模拟世界和数字世界的第一座桥梁。它将时间上<font color="orange">连续</font>的信号，转换成时间上<font color="orange">离散</font>的序列。

#### 1. 理想采样过程与数学建模

理想采样可以看作是原始连续信号 $x(t)$ 与一个周期性的冲激串 $p(t)$ 相乘的过程。

*   **采样信号**: $x(nT) = x(t) \cdot p(t)$
*   **周期冲激串**: $p(t) = \sum_{n=-\infty}^{\infty} \delta(t-nT)$

其中：
*   $T$: <font color="orange">采样周期</font> 
*   $f_s = 1/T$: <font color="orange">采样频率</font> ，单位是赫兹 (Hz) 或 样本/秒
*   $\omega_s = 2\pi/T = 2\pi f_s$: <font color="orange">采样角频率</font> 

#### 2. 采样后信号的频谱

采样的核心影响发生在频域。时域的乘法对应频域的卷积。

*   原始信号频谱为 $X(\omega)$。
*   采样后信号的频谱 $\hat{X}(\omega)$ 是原始频谱以采样频率 $\omega_s$ 为周期进行<font color="orange">周期性延拓</font>的结果。

$\boxed{\hat{X}(\omega) = \frac{1}{T} \sum_{k=-\infty}^{\infty} X(\omega - k\omega_s)}$

**可见**：采样过程会在频域上复制原始频谱，并将这些复制品（频谱搬移）排列在采样频率的整数倍位置上。



> 💡 **核心问题**：如果原始信号的频谱是带限的（即频谱宽度有限），那么在什么条件下，这些复制的频谱不会互相重叠，从而使得我们有可能从采样后的信号中<font color="orange">无失真地恢复</font>原始信号呢？

#### 3. 示例：基音周期估计

在音频处理中，采样后的信号可以用于分析声音特征。

*   **基音**：声音的基础频率，特别是在浊音（如元音）中，由声带的周期性振动产生。基音频率决定了说话人的音高。
*   **基音检测**：常用<font color="orange">自相关法</font>。通过计算音频帧的自相关函数，找到除零点外的第一个峰值位置，该位置对应的时间就是基音周期。
*   **例题**：一帧16kHz采样的音频，自相关函数峰值出现在第48个采样点。求其基音频率。
    *   采样周期 $T = 1 / 16000$ 秒。
    *   基音周期 $T_0 = 48 \times T = 48 / 16000 = 0.003$ 秒。
    *   基音频率 $f_0 = 1 / T_0 = 16000 / 48 \approx \mathbf{333.3}$ Hz。

---

### 二、采样定理  📜

采样定理回答了前面提出的核心问题，是数字信号处理的基石。

#### 1. 奈奎斯特-香农采样定理

如果一个<font color="orange">带限信号</font> $x(t)$ 的最高频率为 $f_R$（或 $\omega_R$），要做到无失真采样（即能够从采样信号中完全恢复原始信号），采样频率 $f_s$ 必须**至少是最高频率的两倍**。

$\boxed{f_s \ge 2f_R \quad \text{或} \quad \omega_s \ge 2\omega_R}$

*   **奈奎斯特采样率 (Nyquist Sampling Rate)**：$2f_R$，即允许无失真恢复的最低采样率。
*   **奈奎斯特率 (Nyquist Rate)**：$2\omega_R$，也叫<font color="orange">折叠频率</font> (Folding Frequency)。

> 🤔 **易错点**：实际中为什么不取等号？
> 1.  **理想滤波器不存在**：完美的“砖墙”低通滤波器在物理上无法实现。
> 2.  **保护带**：实际中通常会留出一些余量（保护带），使得 $f_s$ 略大于 $2f_R$，以简化滤波器的设计。

#### 2. 采样方式分类

*   **过采样**：$f_s > 2f_R$。这是最常见的情况。
*   **临界采样**：$f_s = 2f_R$。理论上的最低要求。
*   **欠采样**：$f_s < 2f_R$。此时，频域上复制的频谱会发生**混叠 (Aliasing)**，导致高频信息伪装成低频信息，原始信号将无法恢复。

#### 3. 采样率举例

*   🗣️ **语音信号**：人声主要频率在 300-3400Hz 范围内，因此电话系统采用 **8 kHz** 的采样率。
*   💿 **CD音乐**：人耳听觉范围约为 20Hz-20kHz，CD标准采用 **44.1 kHz** 的采样率，以确保高质量的音频重现。

#### 4. 实际物理采样

*   **抗混叠滤波器**：由于真实世界的信号并非严格带限，为了防止高于 $f_s/2$ 的频率成分在采样后混叠进来，必须在采样前使用一个**低通滤波器**将这些高频成分滤除。这个预处理器就是抗混叠滤波器。

#### 5. 频谱混叠的应用例子

*   **车轮倒转** 🚗💨：电影中快速旋转的车轮看起来在倒转，就是一种视觉上的频谱混叠。人眼（或摄像机）的帧率（采样率）不足以捕捉车轮的实际高转速，导致高频运动被“混叠”成了低频的倒转运动。

#### 6. 带通采样

对于中心频率很高但带宽较窄的带通信号（如无线电信号），我们不必遵循 $f_s \ge 2f_{max}$ 的规则。其采样率只需满足**大于带宽的两倍**即可，这可以大大降低采样率要求。
*   设带通信号的最高频率为 $\Omega_H$，带宽为 $\Delta\Omega$。
*   带通采样率满足：$\Omega_s = \frac{2\Omega_H}{M}$，其中 $M = \lfloor \frac{\Omega_H}{\Delta\Omega} \rfloor$。

---

### 三、信号的重构 🔢 ➡️ 🕒

重构是从离散的采样信号恢复出原始连续信号的过程，即 **D/A (数模转换)**。

*   **重构目的**：从离散信号恢复到模拟信号。
*   **重构方法 (频域角度)**：将采样信号通过一个**理想低通滤波器**，滤除掉由采样产生的除基带外的所有高频频谱副本。该滤波器的截止频率应为采样频率的一半，即 $\omega_s/2$。

#### 1. 理想重构 (插值公式)

理想低通滤波器的冲激响应是一个 `sinc` 函数。因此，时域上的重构等价于用 `sinc` 函数对每个采样点进行加权求和。

*   **理想插值函数 (sinc函数)**：$h(t) = \frac{\sin(\pi t/T)}{\pi t/T}$
*   **Whittaker-Shannon插值公式**:
    $\boxed{y(t) = \sum_{n=-\infty}^{\infty} x(nT) \frac{\sin(\pi(t-nT)/T)}{\pi(t-nT)/T}}$

#### 2. 实际重构方法

理想的 `sinc` 插值在物理上无法实现（非因果、无限长）。实际的 D/A 转换器采用更简单的方法：

*   **零阶保持**：最常用的方法。将每个采样值保持一个采样周期 $T$ 的时间，形成一个“阶梯状”的波形。
*   **一阶保持**：用直线连接相邻的两个采样点，形成一个“折线状”的波形。

---

### 四、信号的量化 💰

采样解决了时间轴的离散化，而量化则解决<font color="orange">幅度轴</font>的离散化。

#### 1. 量化概念

将采样后信号的连续幅度值，映射到一组有限的离散电平上。这个过程会引入**量化误差 (Quantization Error)**。
一个完整的 **A/D (模数转换)** 过程包括：**抗混叠滤波 -> 采样和保持 -> 量化**。

#### 2. 量化的一些概念

*   **量化比特数 (Bit Depth, $b$)**：表示每个采样点所使用的二进制位数。$b$ 比特可以表示 $2^b$ 个量化等级。
    *   **8 bits**: $2^8 = 256$ 个等级。
    *   **16 bits**: $2^{16} = 65536$ 个等级。
*   **比特率 (Bit Rate)**：表示单位时间内传输或存储的二进制数据量，单位是 bps (bits per second)。
    $\boxed{\text{Bit Rate} = f_s \times b}$
*   **量化对音质的影响**：
    *   **4位**: 强噪声
    *   **8位**: 明显噪声
    *   **16位**: 接近无损 (CD音质)
    *   **24位**: 纯净音质 (录音室标准)
*   **信噪比 (SNR)**：对于均匀量化，量化比特数与信噪比的关系为：
    $\boxed{\text{SNR (dB)} \approx 6.02b + 1.76}$
    这表明，每增加1个比特的量化位数，信噪比大约提升 **6 dB**。

---

### 五、频率概念辨析 🧐

在数字信号处理中，会遇到多种频率单位，理解它们的转换关系非常重要。

| 频率类型 | 常用单位 | 描述对象 |
| :--- | :--- | :--- |
| **模拟频率 ($f_c$ or $\Omega$)** | Hz (赫兹) 或 rad/s (弧度/秒) | 连续时间信号的真实物理频率 |
| **数字频率 ($f$ or $\omega$)** | cycles/sample (周/采样点) 或 rad/sample (弧度/采样点) | 离散时间序列的频率 |
| **归一化频率** | 无单位 | 数字频率相对于采样频率的比值，范围常为 [0, 1] 或 [-0.5, 0.5] |
| **DFT频率 ($k$)** | 整数索引 | N点DFT输出的频点索引，范围为 0 到 N-1 |

#### 关键转换关系

*   **模拟频率与数字频率**：
    $\boxed{f_c = f \cdot f_s \quad \text{或} \quad \Omega = \omega \cdot f_s}$
    **单位量纲分析**: [周/秒] = [周/采样点] × [采样点/秒]
*   **例题**：信号 $x[n] = 12\cos(\frac{\pi}{20}n)$ 是通过 1000Hz 采样得到的，求其真实频率？
    *   数字角频率 $\omega = \pi/20$ rad/sample。
    *   数字频率 $f = \omega / (2\pi) = (\pi/20)/(2\pi) = 1/40$ cycles/sample。
    *   真实频率 $f_c = f \cdot f_s = (1/40) \times 1000 = \mathbf{25}$ Hz。

*   **数字频率与DFT频率**：对于N点DFT，第 $k$ 个频点对应的数字角频率为：
    $\boxed{\omega = \frac{2\pi}{N} k}$

---

### 📝 本章学习总结

本讲探讨了从连续模拟信号到计算机可处理的数字信号的两个核心步骤：采样和量化。

1.  **采样——时间的离散化**：我们学习了理想采样的数学模型，并理解了其在频域中的核心效应——频谱的周期性延拓。**奈奎斯特采样定理**是这一过程的理论基石，它明确了避免<font color="orange">混叠</font>的条件，即采样率必须大于信号最高频率的两倍。

2.  **重构——离散到连续的回归**：重构是采样的逆过程，理论上通过理想低通滤波实现，其时域表现为`sinc`函数插值。现实中则常用零阶保持等方法来近似。

3.  **量化——幅度的离散化**：在采样之后，必须对信号的幅度进行数字化。我们学习了量化的基本概念，如**量化比特数**和**比特率**。量化不可避免地会引入**量化误差**，其大小直接影响信号的信噪比，每增加1 bit可提升约6dB的SNR。

4.  **频率的多种面孔**：最后，我们厘清了模拟频率、数字频率、归一化频率和DFT频率等多个概念之间的联系与转换，这对于在理论和实践中正确分析信号至关重要。

总的来说，采样和量化是整个数字信号处理流程的入口，它们决定了数字信号能在多大程度上保真地表示原始模拟世界。理解这两个过程中的原理、限制和折衷，是进行任何有效数字信号处理的前提。

## 第四章 离散时间系统的时域分析

### 1. 离散时间系统

#### 概念与功能 💡
*   **功能**：对输入的数字序列 $x[n]$ 进行处理，得到输出序列 $y[n]$。
*   **广义上**，可以看作一个<font color="orange">**数字滤波器**</font>。
*   **数学表示**：
    $y(n) = T[x(n)]$
    其中 $T[•]$ 代表系统对输入信号 $x(n)$ 的变换操作。
    

#### 常见系统例子 ⚙️

1.  **累加器 (Accumulator)**
    *   将输入序列从 $-\infty$ 到当前时刻 $n$ 的所有值累加起来。
    *   **定义式**:
        $y[n] = \sum_{l=-\infty}^{n} x[l]$
    *   **递归形式 (更高效)**:
        $y[n] = y[n-1] + x[n]$
    *   对于<font color="orange">**因果累加器**</font> (从n=0开始累加)，其表达式为：
        $\boxed{y[n] = \sum_{l=0}^{n} x[l] = y[-1] + \sum_{l=0}^{n} x[l]}$
    *   其中 $y[-1]$ 称为<font color="orange">**初始条件**</font>。

2.  **滑动平均滤波器 (Moving Average Filter)**
    *   将当前点与过去的 $M-1$ 个点取平均，以平滑信号。
    *   **直接形式**:
        $\boxed{y[n] = \frac{1}{M} \sum_{k=0}^{M-1} x[n-k]}$
    *   **递归形式 (计算量和存储量更小)**:
        $\boxed{y[n] = y[n-1] + \frac{1}{M}(x[n] - x[n-M])}$
    *   **应用**：股票移动均线分析、心率/运动数据平滑去噪。
    *   **思考🤔**：
        *   **Q1**: 上面两个式子的计算量和存储量分别是多少？
        *   **Q2**: 该滤波器的单位脉冲响应是什么？
        *   **Q3**: 该滤波器的频率响应是什么？

3.  **指数加权移动平均滤波器**
    *   一种递归滤波器，过去的输入数据权重以指数形式衰减。
    *   **公式**:
        $y[n] = \alpha y[n-1] + x[n] \quad (0 < \alpha < 1)$
    *   展开后可以看到：
        $y[n] = x[n] + \alpha x[n-1] + \alpha^2 x[n-2] + \dots$
    *   ✔️ 离当前越远的数据，其权重 $\alpha^k$ 越小。

4.  **线性内插 (Linear Interpolation)**
    *   用于上采样后，在数据点之间补充新的点。
    *   **内差因子为2**:
        $y[n] = x_u[n] + \frac{1}{2}(x_u[n-1] + x_u[n+1])$
    *   **应用**: 图像缩放（双线性内插是其二维形式），可以获得比最近邻插值更平滑的效果。
    

5.  **中值滤波器 (Median Filter)**
    *   在输入序列上滑动一个奇数长度的窗口，输出为窗口内所有样本值的<font color="orange">**中值**</font>。
    *   **公式**:
        $y[n] = \text{med}\{x[n-K], \dots, x[n], \dots, x[n+K]\}$
    *   **特点**：能有效去除<font color="orange">**随机突发噪声（椒盐噪声）**</font>，且对信号边缘的保持效果比线性平滑滤波器好。
    *   **应用**：事件相机信号处理，滤除传感器噪声和车体震动产生的假事件。

---

### 2. 离散时间系统的分类 📋

#### 🔹 按脉冲响应长度

*   **有限脉冲响应 (FIR) 系统**: 脉冲响应 $h[n]$ 在有限时间内为非零值。
*   **无限脉冲响应 (IIR) 系统**: 脉冲响应 $h[n]$ 持续无限长时间。

    *   **例 - FIR低通**: 滑动平均滤波器 $y[n] = \frac{1}{M} \sum_{k=0}^{M-1} x[n-k]$
    *   **例 - IIR低通**: 指数加权移动平均 $y[n] = \alpha y[n-1] + (1-\alpha)x[n]$
    *   **例 - FIR一次差分**: $y[n] = x[n] - x[n-1]$ (用于边缘检测)

#### 🔹 按输出计算过程

*   **非递归系统**: 输出 $y[n]$ 只与<font color="orange">**过去和现在**</font>的<font color="orange">**输入**</font>有关。
*   **递归系统**: 输出 $y[n]$ 不仅与输入有关，还与<font color="orange">**过去**</font>的<font color="orange">**输出**</font>有关。
*   **注意点** 📌: FIR系统通常是非递归的，IIR系统必须是递归的。但FIR系统也可以用递归方式实现（如滑动平均滤波器的递归形式）。

#### 🔹 按系统特性（输入-输出关系）

1.  **线性系统 (Linear System)**
    *   满足<font color="orange">**叠加原理**</font>。若 $T[x_1[n]] = y_1[n]$ 且 $T[x_2[n]] = y_2[n]$，则：
        $\boxed{T[\alpha x_1[n] + \beta x_2[n]] = \alpha y_1[n] + \beta y_2[n]}$
    *   💡 **易错点**: 带有非零初始条件的系统通常是<font color="orange">**非线性**</font>的。例如，因果累加器只有在初始条件为零（at rest）时才是线性的。
    *   **线性系统举例**：滑动平均滤波器、线性内插、上采样。
    *   **非线性系统举例**：中值滤波器。

2.  **移不变系统 (Shift-Invariant System)**
    *   也称<font color="orange">**时不变系统 (Time-Invariant)**</font>。
    *   系统的特性不随时间变化。输入信号延迟 $k$ 个单位，输出信号也相应延迟 $k$ 个单位。
        $\boxed{\text{若 } T[x(n)] = y(n), \text{ 则 } T[x(n-k)] = y(n-k)}$
    *   **物理意义**: 无论何时进行实验，只要输入相同，得到的输出波形也相同，只是时间起点不同。
    *   **反例**：上采样系统是<font color="orange">**时变**</font>的，因为移位操作和插零操作的顺序不可交换。

3.  **因果系统 (Causal System)**
    *   系统在 $n_0$ 时刻的输出，仅取决于 $n \le n_0$ 时刻的输入（即<font color="orange">**当前和过去**</font>的输入）。
    *   **物理意义**: 系统不能“预知”未来的输入。所有实时的物理系统都必须是因果的。
    *   **非因果系统举例**：$y(n) = x(n+1)$ (需要未来的输入)。
    *   **注意点** 📌: 对于非实时处理（如图像处理、数据分析），因果性不是必须的。例如，平滑一段数据可以使用中心平均 $y[n] = \frac{1}{3}(x[n-1] + x[n] + x[n+1])$，这是一个非因果系统。

4.  **稳定系统 (Stable System)**
    *   指<font color="orange">**有界输入-有界输出 (BIBO)**</font>稳定。
    *   如果输入信号有界（即 $|x[n]| < B_x$），则输出信号也一定有界（$|y[n]| < B_y$）。
    *   **例**: M点滑动平均滤波器是稳定的，因为若输入 $|x[n]| < B_x$，则输出 $|y[n]| \le \frac{1}{M} \sum_{k=0}^{M-1} |x[n-k]| < \frac{1}{M} \cdot M \cdot B_x = B_x$，输出有界。

---

### 3️. LTI系统的两种描述 🔑

对于<font color="orange">**线性时不变 (LTI)**</font>系统，其时域特性可以被完全描述。

1.  **单位冲激响应 (Impulse Response)** $h[n]$
    *   定义：当系统输入为单位冲激序列 $\delta[n]$ 时，系统的输出。
        $\delta[n] \xrightarrow{T[\bullet]} h[n]$
    *   $h[n]$ 是描述LTI系统特性的<font color="orange">**核心**</font>！

2.  **单位阶跃响应 (Step Response)** $s[n]$
    *   定义：当系统输入为单位阶跃序列 $\mu[n]$ 时，系统的输出。
        $\mu[n] \xrightarrow{T[\bullet]} s[n]$

*   **例**：求累加器 $y[n] = \sum_{l=-\infty}^{n} x[l]$ 的冲激响应。
    *   令输入 $x[l] = \delta[l]$，则输出 $h[n]$ 为：
        $h[n] = \sum_{l=-\infty}^{n} \delta[l] = \mu[n]$
    *   结论：累加器的冲激响应是单位阶跃序列。

---

### 4️. LTI系统的时域分析 🔬

核心思想：利用LTI系统的<font color="orange">**线性**</font>和<font color="orange">**时不变性**</font>来求任意输入的响应。

#### 卷积和

1.  **信号分解**: 任何离散序列 $x[n]$ 都可以表示为一系列加权和移位的单位冲激信号之和。
    $\boxed{x[n] = \sum_{k=-\infty}^{\infty} x[k] \delta[n-k]}$

2.  **响应求解**:
    *   将分解后的 $x[n]$ 输入LTI系统 $T[•]$。
    *   利用<font color="orange">**线性**</font>，将 $T[•]$ 移入求和号内: $y[n] = \sum x[k] T[\delta[n-k]]$
    *   利用<font color="orange">**时不变性**</font>， $T[\delta[n-k]]$ 等于 $h[n-k]$。
    *   最终得到LTI系统的输入-输出关系——**卷积和**:
        $\boxed{y[n] = \sum_{k=-\infty}^{\infty} x[k]h[n-k]}$
    *   这个运算记为 $y[n] = x[n] * h[n]$。

#### 卷积的性质

*   **交换律**: $x_1[n] * x_2[n] = x_2[n] * x_1[n]$ (系统与输入信号可互换)
*   **结合律**: $(x_1*x_2)*x_3 = x_1\*(x_2*x_3)$ (级联系统的顺序可交换)
*   **分配律**: $x_1\*(x_2+x_3) = x_1*x_2 + x_1*x_3$ (并联系统)

#### 卷积的计算方法

*   **图解法**: 对其中一个序列进行<font color="orange">**反折**</font> ($h[k] \rightarrow h[-k]$)，然后<font color="orange">**平移**</font>n个单位 ($h[n-k]$)，与另一个序列<font color="orange">**相乘**</font>，最后<font color="orange">**求和**</font>。
*   **列表法**: 适用于有限长序列，类似于多项式乘法，将对应项相乘后按位对齐相加。

#### 从 $h[n]$ 看LTI系统特性

*   **稳定性** ⚖️:
    *   一个LTI系统是BIBO稳定的，<font color="orange">**当且仅当**</font>其冲激响应是绝对可和的。
        $\boxed{S = \sum_{n=-\infty}^{\infty} |h[n]| < \infty}$
    *   **例**: 对于因果系统 $h[n] = a^n u[n]$，当 $|a|<1$ 时，$S = 1/(1-|a|)$ 有限，系统稳定；当 $|a| \ge 1$ 时，$S$ 发散，系统不稳定。

*   **因果性**  causality:
    *   一个LTI系统是因果的，<font color="orange">**当且仅当**</font>其冲激响应满足：
        $\boxed{h[k] = 0, \quad \text{for } k < 0}$
    *   这意味着系统的响应不能出现在激励之前。

---

### 5️. 简单的LTI系统互联 🔗

*   **级联 (Cascade)**:
    *   两个系统串联，总的冲激响应是两个系统冲激响应的<font color="orange">**卷积**</font>。
        $h[n] = h_1[n] * h_2[n]$
*   **并联 (Parallel)**:
    *   两个系统并联，总的冲激响应是两个系统冲激响应的<font color="orange">**相加**</font>。
        $h[n] = h_1[n] + h_2[n]$

---

### 6️. 有限维LTI离散时间系统 🔢

这类系统可以用<font color="orange">**线性常系数差分方程 (LCCDE)**</font>来描述。

$\sum_{k=0}^{N} d_k y[n-k] = \sum_{k=0}^{M} p_k x[n-k]$

#### 差分方程的解

*   **全解 (Total Solution)**:
    $y[n] = y_c[n] + y_p[n]$
    *   $y_c[n]$: **齐次解** (Complementary)，对应于输入为零时系统的自然响应。
    *   $y_p[n]$: **特解** (Particular)，对应于特定输入信号产生的强制响应。

*   **零输入响应与零状态响应**:
    *   **零输入响应 $y_{zi}[n]$**: 输入 $x[n]=0$，仅由<font color="orange">**非零初始条件**</font>引起的响应。
    *   **零状态响应 $y_{zs}[n]$**: <font color="orange">**初始条件为零**</font>，仅由输入信号 $x[n]$ 引起的响应。

*   **稳定性与特征方程**:
    *   齐次解的形式由系统的<font color="orange">**特征方程**</font>的根（极点）决定。
    *   **稳定性判据** 🌟: 一个因果LTI系统是稳定的，<font color="orange">**当且仅当**</font>其特征方程的所有根的模都<font color="orange">**小于1**</font>（即所有根都在复平面的单位圆内）。

---

### ✨ 本章学习总结 ✨

本讲我们系统地学习了离散时间系统的时域分析方法。

1.  **核心是LTI系统**：我们了解了系统的基本概念和多种分类方法，但<font color="orange">**线性时不变 (LTI) 系统**</font>是分析的基石。

2.  **$h[n]$是关键**：LTI系统的所有时域特性都蕴含在其<font color="orange">**单位冲激响应 $h[n]$**</font>中。通过 $h[n]$，我们可以判断系统的因果性 ($h[n]=0$ for $n<0$) 和稳定性 ($\sum|h[n]| < \infty$)。

3.  **卷积是核心运算**：LTI系统的输出是输入信号与系统冲激响应的<font color="orange">**卷积和**</font>。理解和掌握卷积的定义、性质和计算方法至关重要。

4.  **差分方程是重要模型**：许多实用的LTI系统（特别是IIR系统）可以用线性常系数差分方程来描述。系统的稳定性与差分方程特征根的位置密切相关。

总之，时域分析为我们理解信号如何通过系统提供了最直观的视角。掌握冲激响应和卷积，就掌握了分析LTI系统的钥匙 🔑。

## 第五章 有限长离散变换

本章我们进入数字信号处理的核心工具——<font color="orange">离散傅里叶变换 (DFT)</font>。在此之前，我们已经接触了多种傅里叶分析工具，但它们都无法直接被计算机处理。

*   **CTFT (连续时间傅里叶变换)**: 时间和频率都<font color="orange">连续</font>。
*   **CFS (连续时间傅里叶级数)**: 时间<font color="orange">连续周期</font>，频率<font color="orange">离散</font>。
*   **DTFT (离散时间傅里叶变换)**: 时间<font color="orange">离散</font>，频率<font color="orange">连续周期</font>。
*   **DFS (离散傅里叶级数)**: 时间和频率都<font color="orange">离散周期</font>。

🤔 **计算机处理的需要**：计算机只能处理<font color="orange">有限长</font>、<font color="orange">离散</font>的数值。因此，我们需要一种在时域和频域上都是离散且有限长的变换，这就是DFT。

---

### 1. 离散傅里叶变换 (DFT)

#### 1.1 DFT 的定义

DFT可以看作是对一个有限长序列的 **DTFT** 在一个周期内 ($[0, 2\pi]$) 进行<font color="orange">均匀采样</font>得到的。

对于一个长度为 $N$ 的序列 $x[n]$ ($0 \le n \le N-1$)，其 N 点 DFT 定义为：

$$\boxed{X[k] = \sum_{n=0}^{N-1} x[n] W_N^{kn}, \quad 0 \le k \le N-1}$$

其对应的 **离散傅里叶逆变换 (IDFT)** 为：

$$\boxed{x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] W_N^{-kn}, \quad 0 \le n \le N-1}$$

其中，$W_N$ 被称为<font color="orange">旋转因子</font> (Twiddle Factor)，定义为：

$W_N = e^{-j\frac{2\pi}{N}}$

📝 **旋转因子的性质**：
*   **周期性**: $W_N^{k+mN} = W_N^k$
*   **对称性**: $W_N^{k + N/2} = -W_N^k$
*   **共轭对称性**: $W_N^{-k} = W_N^{N-k} = (W_N^k)^*$

💡 **重要特性**：DFT 及其逆变换都具有周期性，周期为 $N$。即 $X[k+N] = X[k]$ 和 $x[n+N] = x[n]$。

#### 1.2 DFT 的矩阵表示

DFT 变换可以表示为矩阵乘法的形式：$\mathbf{X} = \mathbf{D}_N \mathbf{x}$。
其中 $\mathbf{x}$ 和 $\mathbf{X}$ 是序列的列向量，$\mathbf{D}_N$ 是一个 $N \times N$ 的 DFT 矩阵，其元素为 $[\mathbf{D}_N]_{kn} = W_N^{kn}$。

这种表示方法直观，但也揭示了其计算复杂度为 $O(N^2)$。

#### 1.3 DTFT 与 DFT 的关系

这个关系是理解 DFT 的关键！

1.  **DFT 是 DTFT 的频域采样**
    $X[k] = X(e^{j\omega})|_{\omega = \frac{2\pi k}{N}}$
    这说明 DFT 提供了 DTFT 频谱的样本点。

2.  **频域采样导致时域周期延拓**
    对 DTFT 进行频域采样后，其对应的时域序列 $y[n]$ 是原始序列 $x[n]$ 以 $N$ 为周期的<font color="orange">周期延拓</font>之和。

    $y[n] = \sum_{m=-\infty}^{\infty} x[n-mN]$

    ⚠️ **注意点**：
    *   如果原始序列 $x[n]$ 的长度 $L$ **小于等于** DFT 的点数 $N$ ($L \le N$)，那么在一个周期内 $y[n]$ 和 $x[n]$ 是完全相同的，可以通过 $y[n]$ 无失真地恢复 $x[n]$。
    *   如果 $L > N$，则会发生<font color="orange">时域混叠</font>，$y[n]$ 将不再是 $x[n]$ 的简单截断，无法恢复原始信号。

3.  **用 DFT 数值计算 DTFT**
    可以通过计算一个足够长的 M 点 DFT 来逼近原始 N 点序列的 DTFT。只需将 $x[n]$ <font color="orange">补零</font>到 M 点 ($M > N$)，再做 M 点 DFT，得到的结果就是 DTFT 在 M 个频率点上的采样。M 越大，对 DTFT 的描述越精细。

---

### 2. 有限长序列的运算及分类

#### 2.1 圆周移位 (Circular Shift)
![](Pastedimage20250922210808)
由于 DFT 的周期性，对序列的移位操作也是<font color="orange">循环</font>的。一个 N 点序列 $x[n]$ 移位 $n_0$ 位后的序列 $x_s[n]$ 定义为：

$x_s[n] = x((n-n_0)_N) = x((n-n_0) \mod N)$

这相当于将序列看作一个首尾相连的圆环，在环上进行旋转。

#### 2.2 圆周卷积 (Circular Convolution)

两个 N 点序列 $g[n]$ 和 $h[n]$ 的 N 点圆周卷积定义为：

$$\boxed{y_c[n] = g[n] \circledast_N h[n] = \sum_{m=0}^{N-1} g[m]h((n-m)_N)}$$

✅ **圆周卷积与线性卷积的关系**:
这是本章最重要的概念之一。直接计算圆周卷积的结果通常与线性卷积不同。但是，如果我们将两个长度分别为 $M$ 和 $N$ 的序列都<font color="orange">补零</font>到长度 $L \ge M+N-1$，再进行 L 点圆周卷积，那么得到的结果将与这两个序列的<font color="orange">线性卷积完全相同</font>！

#### 2.3 序列的对称性分类

*   **圆周共轭对称/反对称**:
    *   **对称部分**: $x_{pcs}[n] = \frac{1}{2}(x[n] + x^*((-n)_N))$
    *   **反对称部分**: $x_{pca}[n] = \frac{1}{2}(x[n] - x^*((-n)_N))$

*   **对于实序列，这简化为圆周偶对称/奇对称**:
    *   **偶部**: $x_{pe}[n] = \frac{1}{2}(x[n] + x((-n)_N))$
    *   **奇部**: $x_{po}[n] = \frac{1}{2}(x[n] - x((-n)_N))$

---

### 3. DFT 的性质

DFT 的许多性质与 DTFT 类似，但都附加了“<font color="orange">圆周</font>”的特性。

| 性质         | 时域序列 (长度N)                | 频域序列 (N点DFT)                          |
| :--------- | :------------------------ | :------------------------------------ |
| **线性**     | $ag[n] + \beta h[n]$      | $aG[k] + \beta H[k]$                  |
| **圆周时移**   | $g((n-n_0)_N)$            | $W_N^{kn_0} G[k]$                     |
| **圆周频移**   | $W_N^{-kn_0} g[n]$        | $G((k-k_0)_N)$                        |
| **圆周卷积**   | $g[n] \circledast_N h[n]$ | $G[k]H[k]$                            |
| **时域相乘**   | $g[n]h[n]$                | $\frac{1}{N} G[k] \circledast_N H[k]$ |

#### 3.1 实序列的 DFT 对称性

这是一个非常重要的性质，可以大大减少计算和存储量。
如果 $x[n]$ 是一个实序列，那么它的 DFT $X[k]$ 具有<font color="orange">共轭对称性</font>：

$$\boxed{X[k] = X^*((-k)_N) = X^*(N-k)}$$

这导致：
*   **幅度谱是偶对称的**: $|X[k]| = |X[N-k]|$
*   **相位谱是奇对称的**: $\arg(X[k]) = -\arg(X[N-k])$
*   **实部是偶对称的**: $\text{Re}\{X[k]\} = \text{Re}\{X[N-k]\}$
*   **虚部是奇对称的**: $\text{Im}\{X[k]\} = -\text{Im}\{X[N-k]\}$

因此，对于 N 点实序列的 DFT，我们只需要计算并存储前 $N/2+1$ 个点（从 k=0 到 k=N/2）即可。

---

### 4. DFT 的计算与应用

#### 4.1 利用对称性高效计算 DFT

1.  **用一次 N 点复数 DFT 计算两个 N 点实数 DFT**
    *   构造复序列 $x[n] = g[n] + jh[n]$。
    *   计算 $X[k] = \text{DFT}\{x[n]\}$。
    *   利用对称性恢复 $G[k]$ 和 $H[k]$：
        $G[k] = \frac{1}{2}(X[k] + X^*((N-k)_N))$
        $H[k] = \frac{1}{2j}(X[k] - X^*((N-k)_N))$

2.  **用一次 N 点 DFT 计算一个 2N 点实数 DFT**
    *   将 2N 点实序列 $v[n]$ 分解为偶数项 $g[n]=v[2n]$ 和奇数项 $h[n]=v[2n+1]$。
    *   $g[n]$ 和 $h[n]$ 都是 N 点实序列，可以用上面的方法计算出 $G[k]$ 和 $H[k]$。
    *   最后合成 $V[k]$：
        $V[k] = G((k)_N) + W_{2N}^k H((k)_N), \quad 0 \le k \le 2N-1$

#### 4.2 🌟 利用 DFT 实现线性卷积

这是 DFT 最重要的应用之一，特别是在处理长序列滤波时。

*   **核心思想**：时域卷积等价于频域相乘。
*   **实现方法**：
    1.  对信号和滤波器冲激响应进行<font color="orange">补零</font>，使其长度 $L \ge M+N-1$。
    2.  计算 L 点 DFT。
    3.  将 DFT 结果相乘。
    4.  进行 L 点 IDFT，得到的结果就是线性卷积。

当输入信号非常长时，我们使用分段卷积的方法，主要有两种：

1.  **重叠相加法 (Overlap-Add)**
    *   将长序列 $x[n]$ 切分为<font color="orange">不重叠</font>的段。
    *   每段与 $h[n]$ 做线性卷积（通过补零和 DFT 实现）。
    *   由于卷积后长度会增加，输出段会相互重叠，将这些<font color="orange">重叠部分相加</font>即可得到最终结果。
    *   **特点**: 帧长 $L=M+N-1$，计算出的值<font color="orange">全部有用</font>。

2.  **重叠保留法 (Overlap-Save)**
    *   将长序列 $x[n]$ 切分为<font color="orange">有重叠</font>的段，重叠长度为 $M-1$。
    *   每段与 $h[n]$ 做<font color="orange">圆周卷积</font>（长度为 N）。
    *   由于圆周卷积的“卷绕”效应，每段输出的前 $M-1$ 个点是错误的（混叠），需要<font color="orange">丢弃</font>。
    *   保留每段后面正确的部分，然后拼接起来。
    *   **特点**: 帧长 $L=N \ge M$，计算出的值<font color="orange">部分有用</font>。

---

### 📖 本章学习总结

1.  **核心工具**: DFT 是数字信号处理中进行频域分析和滤波实现的<font color="orange">基石</font>，因为它在时域和频域都是离散且有限长的，完美契合计算机处理的需求。

2.  **核心关系**: 深刻理解 DFT 与 DTFT 的关系至关重要。**频域采样 ↔ 时域周期延拓**。这个对偶关系解释了时域混叠现象，并指导我们如何用 DFT 逼近 DTFT。

3.  **核心应用**: DFT 最强大的应用之一是<font color="orange">快速计算线性卷积</font>。必须牢记，只有通过正确的**补零**，才能使 DFT 域的乘积（即圆周卷积）等价于时域的线性卷积。

4.  **效率为王**: 实序列的共轭对称性以及由此衍生的各种高效计算技巧，是实际工程中必须掌握的知识。重叠相加/保留法是处理长数据流滤波的标准方法。

总之，DFT 不仅仅是一个数学变换，更是一个连接理论分析与工程实践的强大桥梁。

## 第六章 Z变换
### 一、 Z变换的基本概念 ✨

#### 1. 什么是Z变换？
Z变换可以看作是离散时间信号与系统领域的“<font color="orange">拉普拉斯变换</font>”。它是一种分析工具，将复杂的时域<font color="orange">卷积运算</font>转换为Z域中简单的<font color="orange">乘积运算</font>。

#### 2. Z变换的定义
对于一个离散时间序列 $x[n]$，其双边Z变换定义为：
$$
\boxed{X(z) = \sum_{n=-\infty}^{\infty} x[n]z^{-n}}
$$
其中，$z$ 是一个复变量，可以表示为 $z = re^{j\omega}$。

#### 3. Z变换与傅里叶变换（DTFT）的关系 🤝
- 当复变量 $z$ 的模 $r=1$ 时，即 $z = e^{j\omega}$，Z变换就退化为了离散时间傅里叶变换（DTFT）。
- Z变换的定义式可以改写为：
  $$
  X(re^{j\omega}) = \sum_{n=-\infty}^{\infty} (x[n]r^{-n})e^{-j\omega n}
  $$
- 这表明，序列 $x[n]$ 的Z变换，可以看作是另一个序列 $(x[n]r^{-n})$ 的傅里叶变换。
- 因此，Z变换是DTFT的<font color="orange">推广</font>，DTFT就是在Z平面的<font color="orange">单位圆</font>上进行的Z变换。

---

### 二、 Z变换的收敛域 (ROC) 🗺️

#### 1. 为什么需要收敛域？
Z变换是一个无穷级数，这个级数不一定对所有的复变量 $z$ 都收敛。只有当级数收敛时，Z变换才有意义。

#### 2. 收敛域的定义
<font color="orange">收敛域 (Region of Convergence, ROC)</font> 是指在Z平面上，能够使Z变换级数和收敛的所有点 $z$ 的集合。

#### 3. 常见序列的ROC
一个Z变换必须由其<font color="orange">代数表达式</font>和<font color="orange">收敛域</font>共同唯一确定。

- **右边序列 (因果序列)**: $x[n] = a^n u[n]$
  - Z变换: $X(z) = \frac{1}{1-az^{-1}}$
  - ROC: $|z| > |a|$ (极点 $|a|$ 之外的区域)

- **左边序列 (反因果序列)**: $x[n] = -a^n u[-n-1]$
  - Z变换: $X(z) = \frac{1}{1-az^{-1}}$
  - ROC: $|z| < |a|$ (极点 $|a|$ 之内的区域)

> **⚠️ 易错点**: 仅仅给出代数表达式 $X(z)=\frac{1}{1-az^{-1}}$ 是不够的！必须结合ROC才能唯一确定对应的时域序列 $x[n]$。

#### 4. ROC的性质总结
1.  ROC在Z平面上是一个<font color="orange">圆环</font>区域，其边界由极点决定。
2.  对于<font color="orange">有限长序列</font>，ROC是整个Z平面（可能除去 $z=0$ 或 $z=\infty$）。
3.  对于<font color="orange">右边序列</font>，ROC位于最外层极点的外部。
4.  对于<font color="orange">左边序列</font>，ROC位于最内层非零极点的内部。
5.  对于<font color="orange">双边序列</font>，ROC是一个环状区域，位于两个极点之间。
6.  ROC<font color="orange">不能包含任何极点</font>。

---

### 三、 逆Z变换 ↩️

逆Z变换是将Z域的表达式转换回时域序列的过程。

#### 1. 部分分式展开法 🛠️
这是求解有理函数逆Z变换最常用的方法。
**步骤**:
1.  **求极点**: 找到 $X(z)$ 的所有极点 $a_i$。
2.  **展开**: 将 $X(z)$ 展开为部分分式之和的形式：
    $$
    X(z) = \sum_{i} \frac{A_i}{1-a_i z^{-1}}
    $$
3.  **确定各项ROC**: 根据总的ROC，判断每一个分项是对应右边序列还是左边序列。
4.  **查表反变换**: 利用常用变换对（如上面的因果/反因果序列）求出每一项的反变换，再相加得到最终结果。

> **🔔 注意点**: 在确定每一项的ROC时要特别小心。如果总ROC是 $|z|>R_{max}$，则所有项都是右边序列；如果总ROC是 $|z|<R_{min}$，则所有项都是左边序列；如果总ROC是环状，则需要根据极点位置判断。

#### 2. 长除法
通过对 $X(z)$ 的分子分母进行长除法，可以直接得到时域序列的各项系数值。
- 若ROC为 $|z|>R$ (对应右边序列)，则按 $z^{-1}$ 的<font color="orange">降幂</font>排列进行长除。
- 若ROC为 $|z|<R$ (对应左边序列)，则按 $z^{-1}$ 的<font color="orange">升幂</font>（即 $z$ 的降幂）排列进行长除。

---

### 四、 Z变换的性质 🚀

Z变换的性质是进行系统分析的核心。

1.  **线性性质**:
    $a x_1[n] + b x_2[n] \leftrightarrow a X_1(z) + b X_2(z)$
    - **ROC**: 至少是 $R_1 \cap R_2$。如果发生零极点抵消，ROC可能会扩大。

2.  **时移性质**:
    $x[n-n_0] \leftrightarrow z^{-n_0} X(z)$
    - **ROC**: 与原ROC相同，但可能增加或删除 $z=0$ 或 $z=\infty$。

3.  **Z域尺度变换**:
    $a^n x[n] \leftrightarrow X(z/a)$
    - **ROC**: $|a|R_x$ (原ROC被缩放 $|a|$ 倍)。

4.  **时域反转**:
    $x[-n] \leftrightarrow X(z^{-1})$
    - **ROC**: $1/R_x$ (原ROC取倒数)。

5.  **卷积性质 ⭐ (最重要!)**:
    时域卷积等于Z域乘积。
    $$
    \boxed{x_1[n] * x_2[n] \leftrightarrow X_1(z) X_2(z)}
    $$
    - **ROC**: 至少是 $R_1 \cap R_2$。

6.  **Z域微分性质**:
    $n x[n] \leftrightarrow -z \frac{dX(z)}{dz}$
    - **ROC**: 与原ROC相同。
    - 这个性质对于求解包含对数或高阶极点的函数的反变换非常有用。

---

### 五、 LTI系统分析与Z变换 🔬

#### 1. 系统函数 (传输函数)
LTI系统的<font color="orange">系统函数</font> $H(z)$ 是其单位冲激响应 $h[n]$ 的Z变换。
$$
H(z) = \sum_{n=-\infty}^{\infty} h[n]z^{-n}
$$
对于任意输入 $x[n]$ 和输出 $y[n]$，它们在Z域的关系为：
$$
\boxed{Y(z) = H(z)X(z)}
$$

#### 2. 因果性与稳定性判断
这是Z变换在系统分析中最核心的应用。

- **因果性 (Causality)** 🕰️:
  - 一个LTI系统是因果的 $\iff$ 其系统函数 $H(z)$ 的ROC是<font color="orange">某个圆的外部</font>，并且<font color="orange">包含 $z=\infty$</font>。
  - 对于有理系统函数，这意味着分子的最高阶次不能大于分母的最高阶次。

- **稳定性 (Stability)** ⚖️:
  - 一个LTI系统是BIBO稳定的 $\iff$ 其系统函数 $H(z)$ 的ROC<font color="orange">包含单位圆</font> ($|z|=1$)。

- **因果且稳定的系统** ✅:
  - 一个LTI系统是因果且稳定的 $\iff$ $H(z)$ 的<font color="orange">所有极点都在单位圆内部</font>。

#### 3. 从系统函数求频率响应
如果系统是稳定的（ROC包含单位圆），那么其频率响应 $H(e^{j\omega})$ 可以通过将 $H(z)$ 在单位圆上求值得到：
$$
H(e^{j\omega}) = H(z)|_{z=e^{j\omega}}
$$

#### 4. 从零极点图看频率响应 📈
- **极点**靠近单位圆，会在其对应的频率处产生<font color="orange">峰值</font>（谐振）。极点越靠近单位圆，峰值越尖锐。
- **零点**靠近单位圆，会在其对应的频率处产生<font color="orange">谷值</font>（衰减）。如果零点在单位圆上，则该频率处响应为零。
- 这种几何方法提供了一种直观理解滤波器（如低通、高通、带通）特性的方式。

---

### 六、 本章学习总结 💡

1.  **核心定义**: Z变换是离散序列的“复频域”表示，是DTFT的推广。
2.  **ROC的重要性**: Z变换由其<font color="orange">代数表达式</font>和<font color="orange">收敛域</font>共同定义。ROC的形状（内圆、外圆、圆环）决定了时域序列的类型（左边、右边、双边）。
3.  **卷积定理**: 这是Z变换的“杀手级应用”，它将复杂的时域卷积变成了简单的Z域乘法，是LTI系统分析的基石。
4.  **系统分析**:
    - **系统函数 $H(z)$** 是连接输入和输出的桥梁。
    - 系统的<font color="orange">因果性</font>和<font color="orange">稳定性</font>这两个物理特性，可以完全由 $H(z)$ 的ROC或者极点位置来判断。
      - **因果性** $\leftrightarrow$ ROC向外延伸至无穷。
      - **稳定性** $\leftrightarrow$ ROC包含单位圆。
      - **因果稳定** $\leftrightarrow$ 所有极点都在单位圆内。
5.  **几何视角**: 零极点图不仅给出了系统的数学描述，还提供了一种强大的<font color="orange">几何直觉</font>，帮助我们直观地理解和设计系统的频率响应。

## 第七章 LTI系统的变换域分析
### 📝 一、引言与基本概念回顾

在我们深入探讨之前，我们先快速回顾一下表征一个LTI系统的几个核心模型。

1.  **单位冲击响应函数 $h[n]$**
    *   时域表示：系统输出是输入信号与单位冲击响应的<font color="orange">卷积</font>。
    *   $y[n] = x[n] * h[n]$

2.  **频率响应函数 $H(e^{j\omega})$**
    *   频域表示：系统输出的傅里叶变换是输入信号的傅里叶变换与频率响应的<font color="orange">乘积</font>。
    *   $Y(e^{j\omega}) = X(e^{j\omega})H(e^{j\omega})$
    *   定义式：$H(e^{j\omega}) = \sum_{n=-\infty}^{\infty} h[n]e^{-j\omega n}$

3.  **系统函数 (或传递函数) $H(z)$**
    *   z域表示：系统输出的z变换是输入信号的z变换与系统函数的<font color="orange">乘积</font>。
    *   $Y(z) = X(z)H(z)$
    *   定义式：$H(z) = \sum_{n=-\infty}^{\infty} h[n]z^{-n}$

对于由线性常系数差分方程描述的LTI系统，其系统函数通常是有理函数形式：
$$
H(z) = \frac{\sum_{k=0}^{M} a_k z^{-k}}{\sum_{k=0}^{N} b_k z^{-k}}
$$

---

### 📈 二、LTI系统的频率特性与滤波器概念

#### 2.1 幅频与相频特性

频率响应 $H(e^{j\omega})$ 是一个复数，可以表示为幅度和相位的形式：
$$
\boxed{H(e^{j\omega}) = |H(e^{j\omega})|e^{j\theta(\omega)}}
$$
*   **幅频特性**：$|H(e^{j\omega})|$，描述了系统对不同频率分量的振幅的放大或缩小程度。
*   **相频特性**：$\theta(\omega)$，描述了系统对不同频率分量的相位的改变。
*   **增益函数**：$G(\omega) = 20\log_{10}(|H(e^{j\omega})|)$，单位是分贝(dB)。
*   **衰减函数**：$A(\omega) = -G(\omega)$。

#### 2.2 滤波器的基本概念

<font color="orange">滤波器</font>本质上就是一个LTI系统，它被设计用来对输入信号的不同频率成分进行选择性处理。

*   **理想滤波器分类**：
    *   **低通滤波器 (LPF)**：只允许低频分量通过。
    *   **高通滤波器 (HPF)**：只允许高频分量通过。
    *   **带通滤波器 (BPF)**：只允许特定频带内的分量通过。
    *   **带阻滤波器 (BSF)**：阻止特定频带内的分量通过。

*   **关键概念**：
    *   <font color="orange">通带</font>：频率响应幅度近似为1的频率范围。
    *   <font color="orange">阻带</font>：频率响应幅度近似为0的频率范围。
    *   <font color="orange">截止频率</font>：通带与阻带的边界频率。
    *   <font color="orange">过渡带</font>：实际滤波器中，通带与阻带之间的过渡区域。

#### 2.3 有界实传输函数 (BR)

一个因果稳定的LTI传输函数如果满足以下条件，则称为<font color="orange">有界实函数</font>：
$$
|H(e^{j\omega})| \leq 1
$$
这意味着系统不会放大任何频率分量的能量。根据帕斯瓦尔定理，对于有限能量输入信号，输出信号的能量不会大于输入信号的能量。
$$
\sum_{k=-\infty}^{\infty} y^2[n] \leq \sum_{k=-\infty}^{\infty} x^2[n]
$$
*   **无损系统**：输出能量 = 输入能量。
*   **有损系统**：输出能量 < 输入能量。

---

### 🗺️ 三、系统函数与频率响应的联系：从零极点图看系统特性

系统函数 $H(z)$ 在z平面单位圆上的取值，就是系统的频率响应 $H(e^{j\omega})$。
$$
H(e^{j\omega}) = H(z)|_{z=e^{j\omega}}
$$
这意味着，我们可以通过分析系统函数在z平面上的<font color="orange">零点</font>和<font color="orange">极点</font>的分布，来直观地判断系统的频率特性。

#### 3.1 几何关系

幅频响应的大小，可以从几何上理解为：从单位圆上某频率点 $e^{j\omega}$ 到<font color="orange">所有零点的距离之积</font>，再除以到<font color="orange">所有极点的距离之积</font>。
$$
|H(e^{j\omega})| = |\frac{a_0}{b_0}| \frac{\prod_{l=1}^{M}|e^{j\omega}-\xi_l|}{\prod_{l=1}^{N}|e^{j\omega}-\lambda_l|}
$$
*   💡 **核心思想**:
    *   当单位圆上的点靠近一个<font color="orange">极点</font>时，分母变小，幅频响应出现一个<font color="orange">峰值</font>。
    *   当单位圆上的点靠近一个<font color="orange">零点</font>时，分子变小，幅频响应出现一个<font color="orange">谷值</font>（如果零点在单位圆上，则为0）。

#### 3.2 不同滤波器的零极点分布特点

*   **低通滤波器**：
    *   极点靠近 $z=1$ ($\omega=0$)。
    *   零点靠近 $z=-1$ ($\omega=\pi$)。
*   **高通滤波器**：
    *   极点靠近 $z=-1$ ($\omega=\pi$)。
    *   零点靠近 $z=1$ ($\omega=0$)。
*   **带通滤波器**：
    *   极点位于通带对应的单位圆角度附近。
    *   零点位于 $z=1$ 和 $z=-1$ 处。
*   **带阻滤波器**：
    *   零点位于阻带对应的单位圆角度附近（通常在单位圆上以完全消除该频率）。
    *   极点用于提升通带的性能。

⚠️ **注意点**：位于原点 $z=0$ 的零极点不影响幅频特性，只影响相频特性。

---

### ⏳ 四、LTI系统的相位特性

#### 4.1 线性相位

如果一个系统的相频响应 $\theta(\omega)$ 是关于 $\omega$ 的线性函数，则称该系统具有<font color="orange">线性相位</font>。
$$
\theta(\omega) = k\omega + \phi_0 \quad (k, \phi_0 \text{为常数})
$$
*   **重要意义**：线性相位系统不会引起<font color="orange">相位失真</font>。信号通过系统后，所有频率分量都经历相同的<font color="orange">时间延迟</font>，从而保持波形不变，只是整体平移。

#### 4.2 相位延迟与群延迟

*   **相位延迟 (PD)**：$\tau_p(\omega) = -\frac{\phi(\omega)}{\omega}$，表示单个频率正弦波的延迟时间。
*   **群延迟 (GD)**：
    $$
    \boxed{\tau_g(\omega) = -\frac{d\phi(\omega)}{d\omega}}
    $$
    表示信号包络的延迟时间。对于线性相位系统，群延迟是一个<font color="orange">常数</font>。

#### 4.3 零相位系统

*   理论上可以做到信号无延时、无失真输出。
*   其系统函数 $F(z)$ 的零极点在z平面上<font color="orange">镜像对称</font>，例如 $F(z) = H(z)H(z^{-1})$。
*   这种系统通常是<font color="orange">非因果</font>的，但在离线处理中可以通过特殊技巧实现，如MATLAB中的 `filtfilt` 函数。

---

### 🔄 五、最小相位、最大相位与全通系统

#### 5.1 系统分类

对于具有相同幅频响应的系统，根据其零点位置可以分为：

*   **最小相位系统**：所有零点都位于单位圆<font color="orange">内部</font>。
    *   特点：具有最小的群延迟，且其逆系统是<font color="orange">稳定</font>和<font color="orange">因果</font>的。
*   **最大相位系统**：所有零点都位于单位圆<font color="orange">外部</font>。
    *   特点：具有最大的群延迟。
*   **混合相位系统**：零点在单位圆内外都有分布。

#### 5.2 全通系统 (All-pass System)

<font color="orange">全通系统</font>是指其幅频响应在所有频率上都为常数1的系统。
$$
|H(e^{j\omega})| = 1
$$
*   **作用**：全通系统不改变信号的幅度，只改变信号的<font color="orange">相位</font>，常用于<font color="orange">相位均衡</font>或校正。
*   **零极点特性**：全通系统的零点和极点是<font color="orange">共轭镜像对称</font>的。如果 $p_k$ 是一个极点，那么 $1/p_k^*$ 就是一个零点。
*   **系统分解**：任何一个有理系统函数 $H(z)$ 都可以分解为一个最小相位系统 $H_{min}(z)$ 和一个全通系统 $A(z)$ 的级联。
    $$
    H(z) = H_{min}(z)A(z)
    $$
    这个分解在系统分析和设计中非常有用，例如将一个非最小相位系统转换为最小相位系统。

一个 $M$ 阶因果稳定实系数全通函数 $A_M(z)$ 具有以下三个关键特性，它们共同定义了其在信号处理中的独特作用：

---

* 性质 1：能量守恒特性 (无损有界实)

*   **核心思想：** 全通滤波器是一个**无损结构**，它在处理信号时不会改变信号的总能量。
*   **技术描述：** 其传输函数是**无损有界实 (Lossless Bounded Real, LBR)** 的。这意味着它在单位圆上的幅度响应恒定为 1，即 $|A_M(e^{j\omega})| = 1$。
*   **实际意义：** 该滤波器只改变信号的**相位**，而不改变其各个频率分量的**幅度**。它“通过”所有频率，因此得名“全通”。

---

* 性质 2：z 平面上的幅度分布

*   **核心思想：** 幅度为 1 的特性**仅在单位圆上**成立。离开单位圆后，幅度会发生系统性的变化。
*   **具体规则：**
    *   在单位圆**内** ($|z| < 1$)，幅度**大于 1**。
    *   在单位圆**外** ($|z| > 1$)，幅度**小于 1**。
*   **根本原因：** 这是由其独特的零极点结构决定的。由于系统稳定，所有极点都在单位圆内，这会“拉高”单位圆内部的幅度响应；而所有零点都在单位圆外，这会“拉低”单位圆外部的幅度响应。两者在单位圆上达到完美平衡。

---

* 性质 3：可预测的相位响应

*   **核心思想：** 全通滤波器的主要功能——改变相位——是高度可预测且与滤波器阶数直接相关的。
*   **具体规则：**
    1.  **相位单调递减：** 其群延迟 $\tau_g(\omega)$ 恒为正，意味着相位 $\theta(\omega)$ 总是随着频率 $\omega$ 的增加而减小（产生延迟效应）。
    2.  **总相移量化：** 在从直流 ($\omega=0$) 到奈奎斯特频率 ($\omega=\pi$) 的整个频率范围内，总的相位变化量恰好是 $M\pi$ 弧度，其中 $M$ 是滤波器的阶数。
*   **实际意义：** 滤波器的阶数 $M$ 直接控制了其引入总相移的能力。阶数越高，能产生的总相位延迟就越大，可用于更复杂的相位均衡或效果模拟。

##### 总结

这三个性质共同描绘了一个理想的**相位处理器**：它在不影响信号幅度的前提下（性质 1），能够提供一个可控且单调变化的相位延迟（性质 3）。其独特的零极点对称结构是实现这一切的数学基础，并决定了它在整个 z 平面上的行为（性质 2）。

---

### 🔬 六、线性相位FIR系统深入分析

FIR系统因其结构简单且易于实现线性相位，在信号处理中应用广泛。

#### 6.1 实现条件

一个因果FIR系统要实现线性相位，其单位冲击响应 $h[n]$ 必须满足对称或反对称条件：
$$
\boxed{h[n] = \pm h[N-n], \quad 0 \leq n \leq N}
$$
其中 $N$ 是滤波器的阶数（长度为 $N+1$）。

#### 6.2 四种类型线性相位FIR系统

根据对称性 (+/-) 和阶数 N (奇/偶)，可以分为四种类型：

1.  **I 型**: $h[n]$ 对称，N为偶数。
2.  **II 型**: $h[n]$ 对称，N为奇数。
3.  **III 型**: $h[n]$ 反对称，N为偶数。
4.  **IV 型**: $h[n]$ 反对称，N为奇数。

#### 6.3 零点分布与滤波器设计

这四种类型的零点分布具有固定规律，尤其是在 $z=1$ 和 $z=-1$ 处，这决定了它们适合设计的滤波器类型。

*   **I 型**：最灵活，可以设计低通、高通、带通、带阻等各种滤波器。
*   **II 型**：在 $z=-1$ 处有零点，不适合设计<font color="orange">高通</font>滤波器。
*   **III 型**：在 $z=1$ 和 $z=-1$ 处都有零点，不适合设计<font color="orange">低通</font>、<font color="orange">高通</font>和<font color="orange">带阻</font>滤波器。
*   **IV 型**：在 $z=1$ 处有零点，不适合设计<font color="orange">低通</font>滤波器。

##### 黄金法则：共轭倒数对称

所有**实系数**线性相位FIR滤波器的零点都必须满足这个法则。

> 如果 $z_0$ 是一个零点，那么它的**共轭倒数 $1/z_0^*$** 也必须是一个零点。

这个法则会产生以下几种零点组合形式，它们在 z 平面上总是成组出现：

1.  **实数轴上的倒数对**: 如果有一个实数零点 $a$，那么必然有一个零点在 $1/a$。
2.  **单位圆上的共轭对**: 如果有一个零点在单位圆上 $e^{j\theta}$，那么它的共轭 $e^{-j\theta}$ 也必须是零点。（因为 $1/(e^{j\theta})^* = 1/e^{-j\theta} = e^{j\theta}$，它自己就是自己的共轭倒数，但由于系数是实的，共轭点也必须存在）。
3.  **通用的“四人组”**: 如果有一个不在实数轴和单位圆上的复数零点 $re^{j\theta}$，那么为了满足所有对称性，它的共轭 $re^{-j\theta}$、倒数 $(1/r)e^{j\theta}$、共轭倒数 $(1/r)e^{-j\theta}$ 必然同时存在。

---

##### 四种类型的特殊约束（记忆核心）

除了黄金法则外，四种类型的线性相位FIR滤波器由于其冲激响应 $h[n]$ 的特定对称性，对某些**固定位置的零点**有强制要求。

| 类型 (Type) | 冲激响应对称性 $h[n]$ | 阶数 N | **必须存在的零点 (记忆关键)** | 助记 |
| :--- | :--- | :--- | :--- | :--- |
| **Type 1** | **对称** ($h[n]=h[N-n]$) | **偶数** | (无强制要求) | **最自由**的类型，LPF, HPF, BPF, BSF 都能设计。 |
| **Type 2** | **对称** ($h[n]=h[N-n]$) | **奇数** | 必须在 $z = -1$ 有一个零点 | **奇**数阶对称，在奈奎斯特频率($\omega=\pi$)处响应**必为0**。 |
| **Type 3** | **反对称** ($h[n]=-h[N-n]$) | **偶数** | 必须在 $z = 1$ **和** $z = -1$ 有零点 | **偶**数阶反对称，在直流($\omega=0$)和奈奎斯特($\omega=\pi$)处都**必为0**。 |
| **Type 4** | **反对称** ($h[n]=-h[N-n]$) | **奇数** | 必须在 $z = 1$ 有一个零点 | **奇**数阶反对称，在直流($\omega=0$)处响应**必为0**。 |

---

##### 快速记忆技巧

1.  **“反对称” ⇒ “反直流”**
    *   只要看到**反对称** (Anti-symmetric, Type 3 & 4)，就意味着 $H(z)$ 在 $z=1$ (即直流频率 $\omega=0$) 处必然有一个零点。这是因为求和时 $h[n]$ 与 $-h[N-n]$ 会两两抵消。
    *   所以**反对称滤波器绝对不能做低通滤波器**。

2.  **“奇数阶” ⇒ “奇点”**
    *   奇数阶 ($N$ is odd) 意味着滤波器有偶数个抽头 (N+1)。
    *   **对称 + 奇数阶 (Type 2)**：偶数个抽头两两配对，在计算 $H(-1)$ 时，符号 `+ - + -` 会导致完美抵消。因此在 $z=-1$ 处必有零点。
    *   **反对称 + 奇数阶 (Type 4)**: 只在 $z=1$ 有零点。

3.  **“偶数阶反对称 (Type 3)” ⇒ “最苛刻”**
    *   它既是反对称（要求 $z=1$ 有零点），又是偶数阶（中间抽头 $h[N/2]$ 必须为0），这种结构也强制在 $z=-1$ 处有一个零点。所以它把直流和奈奎斯特频率点全“干掉”了。
    *   因此，**Type 3 滤波器特别适合做带通滤波器 (BPF)**。

##### 总结一张图

可以把 z 平面上的 `+1` 和 `-1` 作为记忆点：

```
           z = -1 (奈奎斯特)       z = +1 (直流)
              |                     |
Type 1:     (自由)                 (自由)
              |                     |
Type 2:      零点                   (自由)      <-- 对称, N奇
              |                     |
Type 3:      零点                   零点       <-- 反对称, N偶 (最严格)
              |                     |
Type 4:     (自由)                  零点       <-- 反对称, N奇
```

---

### 🛠️ 七、几种典型的数字滤波器

#### 7.1 FIR滤波器示例

*   **低通滤波器**：M阶滑动平均滤波器是一个典型例子。阶数越高，过渡带越窄，阻带衰减越大，但旁瓣也越多。
*   **高通滤波器**：可以通过低通滤波器进行变换得到，例如 $z \rightarrow -z$ 或者 $H_{HP}(z) = 1 - H_{LP}(z)$。
##### 方法一：频率变换 $z \rightarrow -z$ (频谱搬移)

这种方法的核心思想是将低通滤波器的频率响应**“搬移”**或**“旋转”** $\pi$ (180°)。

###### 1. 工作原理

*   我们知道，一个数字信号的频率响应是通过在 z 变换中令 $z = e^{j\omega}$ 来得到的，其中 $\omega$ 是从 $0$ (直流) 到 $\pi$ (奈奎斯特频率) 的数字角频率。
*   现在我们进行替换 $z \rightarrow -z$。那么新的频率响应中的变量就变成了 $-e^{j\omega}$。
*   利用欧拉公式，我们可以把 $-1$ 写成 $e^{j\pi}$。
*   所以，$-e^{j\omega} = e^{j\pi} \cdot e^{j\omega} = e^{j(\omega + \pi)}$。
*   这意味着，新滤波器在频率 $\omega$ 处的响应，等于原滤波器在频率 $\omega+\pi$ 处的响应。

**效果就是：**
*   原低通滤波器在 $\omega=0$ (直流) 处的响应被搬移到了 $\omega = 0+\pi = \pi$ 处。
*   原低通滤波器在 $\omega=\pi$ (奈奎斯特) 处的响应被搬移到了 $\omega = \pi+\pi = 2\pi$ 处，这等效于 $\omega=0$。

这就实现了一次完美的**频谱翻转**：低通变成了高通。

###### 2. 对冲激响应的影响

这个变换在时域上有一个非常简单的对应关系。如果原低通滤波器的传递函数是 $H_{LP}(z)$，冲激响应是 $h_{LP}[n]$，那么新的高通滤波器：
$$ H_{HP}(z) = H_{LP}(-z) $$
对应的冲激响应为：
$$ h_{HP}[n] = (-1)^n h_{LP}[n] $$
**实现方法**：你只需要将原始低通滤波器的系数（冲激响应）从第二个开始，交替地乘以 `+1, -1, +1, -1, ...` 即可。
*   $h_{HP}[0] = (+1) \cdot h_{LP}[0]$
*   $h_{HP}[1] = (-1) \cdot h_{LP}[1]$
*   $h_{HP}[2] = (+1) \cdot h_{LP}[2]$
*   ...

###### 3. 截止频率的关系

如果原低通滤波器的截止频率是 $\omega_c$，那么变换后的高通滤波器的截止频率将是 $\pi - \omega_c$。

---

##### 方法二：频谱求补 $H_{HP}(z) = 1 - H_{LP}(z)$

这种方法的核心思想是利用**互补**关系。一个理想的全通滤波器在所有频率上增益都为 1。如果你从这个全通滤波器中“减去”一个低通滤波器，剩下的自然就是一个高通滤波器。

###### 1. 工作原理
*   在 z 域中，最简单的全通滤波器就是一个“直通线”，其传递函数为 $H_{AllPass}(z) = 1$。
*   假设我们有一个理想的低通滤波器，它在通带（例如 $[0, \omega_c]$）的增益为 1，在阻带（例如 $[\omega_s, \pi]$）的增益为 0。
*   那么 $H_{HP}(\omega) = 1 - H_{LP}(\omega)$ 的效果是：
    *   在原 LPF 的**通带**：$H_{HP}(\omega) = 1 - 1 = 0$ (变成阻带)。
    *   在原 LPF 的**阻带**：$H_{HP}(\omega) = 1 - 0 = 1$ (变成通带)。

这就完美地将通带和阻带进行了对调，实现了高通滤波。

###### 2. 对冲激响应的影响

这个变换在时域上的实现也非常直接。$H(z)=1$ 对应的冲激响应是单位冲激函数 $\delta[n]$ (即序列 `{1, 0, 0, ...}`)。
$$ H_{HP}(z) = 1 - H_{LP}(z) $$
对应的冲激响应为：
$$ h_{HP}[n] = \delta[n] - h_{LP}[n] $$
**实现方法**：
*   $h_{HP}[0] = 1 - h_{LP}[0]$
*   $h_{HP}[n] = -h_{LP}[n]$  (对于所有 $n > 0$)
你只需要将第一个系数用 1 减去它，然后将所有其他系数取反。

###### 3. 截止频率的关系

这种方法**不会改变截止频率的位置**。如果原低通滤波器的截止频率是 $\omega_c$，那么变换后的高通滤波器的截止频率**仍然是 $\omega_c$**。

---

##### 总结与对比

| 特性       | 方法一: $z \rightarrow -z$                  | 方法二: $1 - H_{LP}(z)$                                  |
| :------- | :--------------------------------------- | :---------------------------------------------------- |
| **核心思想** | **频谱搬移**                                 | **频谱求补**                                              |
| **频域效果** | 将响应从 $0 \leftrightarrow \pi$ 翻转          | 将通带和阻带对调                                              |
| **时域操作** | $h_{HP}[n] = (-1)^n h_{LP}[n]$<br>(交替符号) | $h_{HP}[n] = \delta[n] - h_{LP}[n]$<br>(第一个系数不同，其余取反) |
| **截止频率** | $\omega_{c,HP} = \pi - \omega_{c,LP}$    | $\omega_{c,HP} = \omega_{c,LP}$                       |
| **特性保持** | **保持线性相位** (如果原 LPF 有)                   | **可能破坏线性相位** (除非 LPF 具有特定对称性)                         |
| **适用场景** | 当你需要一个与 LPF **镜像对称**的 HPF 时              | 当你需要一个与 LPF **互补**的 HPF 时 (常用于滤波器组，如 QMF)             |

#### 7.2 IIR滤波器示例

*   **一阶低通/高通**：结构简单，通过一个参数 $\alpha$ 控制截止频率。

##### 一、一阶低通滤波器 
这种滤波器也常被称为**指数加权移动平均 (EWMA)**。它的作用是平滑信号，滤除高频噪声。

###### 1. 结构与公式

**差分方程:**
$$ y[n] = (1-\alpha) \cdot x[n] + \alpha \cdot y[n-1] $$
*   $x[n]$ 是当前时刻的输入信号。
*   $y[n]$ 是当前时刻的输出信号。
*   $y[n-1]$ 是**上一个时刻的输出**。
*   $\alpha$ 是平滑因子，取值范围为 $0 < \alpha < 1$。

**直观理解**：
当前输出 $y[n]$ 是**当前输入 $x[n]$** 和 **历史输出 $y[n-1]$** 的加权平均。
*   $\alpha$ 控制着“记忆”的权重。
*   这个结构只有一个延时单元（用于存储 $y[n-1]$），因此是一阶。

###### 2. 参数 $\alpha$ 的作用

参数 $\alpha$ 直接控制着滤波器的**截止频率**。

*   **$\alpha$ 接近 1 (例如, 0.99)**：
    *   滤波器非常信任历史输出，对新输入的响应很慢。
    *   信号变化非常平缓，**平滑效果强**。
    *   等效于一个**非常低**的截止频率，只有很低的频率能通过。

*   **$\alpha$ 接近 0 (例如, 0.1)**：
    *   滤波器主要信任当前输入，历史输出的影响很小。
    *   信号平滑效果弱，能快速响应输入变化。
    *   等效于一个**比较高**的截止频率，允许更多的高频成分通过。

###### 3. 传递函数与频率响应

其 Z 变换传递函数为：
$$ H(z) = \frac{Y(z)}{X(z)} = \frac{1-\alpha}{1 - \alpha z^{-1}} $$
这是一个典型的一阶 **IIR (无限冲激响应)** 滤波器，因为它有一个反馈回路 ($y[n-1]$)。它在 $z=\alpha$ 处有一个极点，在 $z=0$ 处有一个零点。

**频率响应**：其幅频响应在 $\omega=0$ (直流) 处为 1，然后随着频率 $\omega$ 的增加而平滑衰减。

---

##### 二、一阶高通滤波器

高通滤波器与低通滤波器正好相反，它允许高频信号通过，同时滤除或衰减低频信号（如直流偏置）。

###### 1. 结构与公式

我们可以利用上一问提到的**频谱求补**思想，通过 $H_{HP}(z) = 1 - H_{LP}(z)$ 来推导，但这会得到一个稍微复杂的形式。一个更常见、更直观的一阶高通滤波器是基于“检测变化”的思想。

**差分方程:**
$$ y[n] = \alpha \cdot y[n-1] + \alpha \cdot (x[n] - x[n-1]) $$
*   $x[n] - x[n-1]$ 是当前输入信号的**变化量**（一个简单的一阶差分，本身就是一个基本的高通操作）。
*   整个滤波器可以理解为：将输入信号的“变化量”进行平滑处理。

**直观理解**：
只有当输入信号**发生变化**时，才会有输出。如果输入是一个直流信号（恒定不变），那么 $x[n] - x[n-1] = 0$，最终输出也会衰减到 0。这正是高通滤波器的特性。

###### 2. 参数 $\alpha$ 的作用

与低通滤波器类似，$\alpha$ 也控制着截止频率，但意义相反。

*   **$\alpha$ 接近 1 (例如, 0.99)**：
    *   滤波器对信号的长期变化趋势响应缓慢。
    *   它能滤除非常缓慢的漂移，保留快速变化。
    *   等效于一个**非常低**的截止频率（意味着只有极低频的信号被阻挡）。

*   **$\alpha$ 接近 0 (例如, 0.1)**：
    *   滤波器响应快。
    *   等效于一个**比较高**的截止频率（意味着它会滤除更多的低频成分）。

###### 3. 传递函数与频率响应

其 Z 变换传递函数为：
$$ H(z) = \frac{Y(z)}{X(z)} = \frac{\alpha(1 - z^{-1})}{1 - \alpha z^{-1}} $$
它在 $z=\alpha$ 处有一个极点，在 $z=1$ (直流) 处有一个零点。这个零点保证了它对直流信号的增益为 0。

**频率响应**：其幅频响应在 $\omega=0$ (直流) 处为 0，然后随着频率 $\omega$ 的增加而平滑上升，直到在 $\omega=\pi$ (奈奎斯特频率) 附近趋于一个固定值。

---

##### 总结

| 特性 | **一阶低通滤波器** | **一阶高通滤波器** |
| :--- | :--- | :--- |
| **目标** | 平滑信号，去除噪声 | 提取变化，去除直流/漂移 |
| **差分方程** | $y[n] = (1-\alpha)x[n] + \alpha y[n-1]$ | $y[n] = \alpha y[n-1] + \alpha(x[n]-x[n-1])$ |
| **直观解释** | 对**输入值**进行平滑 | 对**输入的变化量**进行平滑 |
| **$\alpha \to 1$** | **更强**的滤波，**更低**的截止频率 | **更强**的滤波，**更低**的截止频率 |
| **$\alpha \to 0$** | **更弱**的滤波，**更**高的截止频率 | **更弱**的滤波，**更**高的截止频率 |
| **Z域零点** | $z=0$ | $z=1$ (直流) |
| **Z域极点** | $z=\alpha$ | $z=\alpha$ |

*   **二阶带通/带阻**：
    *   带通滤波器：零点在 $z=\pm 1$，极点控制中心频率和带宽。
    *   带阻（陷波）滤波器：零点位于单位圆上要抑制的频率点，极点用于改善通带。
*   **高阶IIR滤波器**：通过级联多个一阶或二阶节，可以获得更陡峭的频率响应。

#### 7.3 梳状滤波器

*   具有多个等间隔的通带和阻带，频谱形状像一把梳子。
*   **核心思想**: 梳状滤波器是通过将一个原型滤波器 $H(z)$ 的**基本延迟单元 $z^{-1}$ 放大 L 倍** ($z^{-L}$) 得到的。
*   **频域效果**: 这个操作将原型滤波器的频率响应在 $[0, 2\pi]$ 范围内**压缩 L 倍并复制 L 次**，从而形成一系列等间隔的峰值或谷值。
*   **参数控制**:
    *   **L (延迟长度)**: 控制梳齿的**间距**。L 越大，梳齿越密。间距为 $2\pi/L$。
    *   **原型滤波器 $H(z)$**: 控制每个梳齿的**形状** (尖锐还是平缓)。
    *   **增益参数 $\alpha$**: 控制峰值或谷值的**深度**。

---

### 🔗 八、互补传输函数及逆系统

#### 8.1 互补传输函数

如果两个（或多个）传输函数之和是一个简单的延时或一个全通函数，则称它们互为<font color="orange">互补传输函数</font>。
*   例如，一个低通滤波器 $H_0(z)$ 和一个高通滤波器 $H_1(z)$ 可以设计成互补的，使得 $H_0(z) + H_1(z) = z^{-n_0}$。这在滤波器组设计中很有用。

#### 8.2 逆系统

*   **定义**：如果两个系统 $H_1(z)$ 和 $H_2(z)$ 级联后，总的系统响应为单位冲激（即 $h_1[n] * h_2[n] = \delta[n]$），则它们互为逆系统。
    $$
    H_1(z)H_2(z) = 1
    $$
*   **零极点关系**：一个系统的零点是其逆系统的极点，反之亦然。
*   **稳定性**：
    *   一个<font color="orange">最小相位</font>系统的因果逆系统总是稳定的。
    *   一个非最小相位系统的因果逆系统是不稳定的，因为其极点会出现在单位圆外。
*   **应用**：<font color="orange">信道均衡</font>。通过在接收端级联一个信道的逆系统，可以补偿信道对信号造成的失真。

---

### 🎓 本章学习总结

本章我们系统地学习了在<font color="orange">变换域</font>（频域和z域）中分析和表征LTI系统的方法，这是数字信号处理的基石。

1.  **核心工具**：我们掌握了利用<font color="orange">零极点图</font>这一强大的图形化工具，来直观、快速地判断系统（滤波器）的幅频响应类型和特性。
2.  **相位的重要性**：我们深入理解了<font color="orange">线性相位</font>的意义（保持波形、仅有时延），并学习了四种线性相位FIR系统的分类、特性及其设计约束。同时，<font color="orange">最小相位</font>系统因其具有稳定的逆系统和最小的群延迟，在系统设计和均衡中扮演着关键角色。
3.  **系统设计基础**：通过学习简单的FIR和IIR滤波器原型，我们为更复杂的滤波器设计打下了基础。了解了如何通过级联构建高阶滤波器，以及如何通过变换生成不同类型的滤波器。
4.  **高级概念与应用**：<font color="orange">全通系统</font>作为相位修正工具，<font color="orange">逆系统</font>作为信号恢复和均衡的手段，这些概念展示了变换域分析在解决实际工程问题中的强大能力。

总而言之，通过本章的学习，我们不仅能够分析一个给定系统的频率特性，还能根据期望的频率响应（如低通、高通），反过来思考其零极点应如何分布，从而为后续的系统设计与实现铺平了道路。

## 第八章 数字滤波器的结构
### 一、 滤波器的方框图表示 🖼️

#### 1. 🤔 为什么要研究滤波器结构？

我们不仅仅满足于得到一个滤波器的数学表达式，如何高效、稳定地实现它同样重要。研究其结构主要基于以下几点考虑：

*   **实现方式**: 滤波器最终需要通过<font color="orange">软件</font>或<font color="orange">硬件</font>来实现。
*   **数学模型的等价性**: 同一个滤波器可以有多种数学表达式，例如直接计算、分解为多个函数相加（并联）或相乘（级联）。
    *   不同的计算形式 ➡️ 不同的计算结构。
    *   不同的计算结构 ➡️ 不同的实现效果。
*   **<font color="orange">有限字长效应</font>**: 在数字系统中，数值的表示精度是有限的。不同的结构对这种精度限制的敏感度不同，会影响滤波器的性能和稳定性。
*   **结构优化**: 我们希望采用合适的结构，使得滤波器：
    *   在有限字长下仍有较好的性能。
    *   在某些场景下，占用最少的延迟单元（存储器）。

#### 2. ✨ 方框图表示法的优点

使用方框图（或流程图）来表示滤波器结构，具有以下优点：

*   **算法直观**: 容易根据图示写出滤波器的可计算算法。
*   **关系清晰**: 便于分析输入、输出以及内部信号之间的关系。
*   **推导方便**: 可以方便地推导出各种功能相同的“<font color="orange">等效结构</font>”。
*   **硬件预估**: 能从结构中分析出所需的硬件资源（如乘法器、加法器、延迟单元）。

#### 3. 🧩 方框图的基本结构单元

| 单元名称 | 方框图 (Block Diagram) | 流程图 (Flow Chart) |
| :--- | :--- | :--- |
| **乘法器** (Multiplier) | x[n] → [a] → ax[n] | → a → |
| **加法器** (Adder) | x₁[n] → ⊕ → y[n] (x₂[n] 输入⊕) | (两条线汇入一个节点) |
| **单位延时** (Unit Delay) | x[n] → [z⁻¹] → x[n-1] | → z⁻¹ → |

#### 4. 📈 从方框图分析系统函数 H(z)

**一般步骤**:

1.  **设立中间变量**: 将每个<font color="orange">加法器</font>的输出定义为一个中间变量。
2.  **建立方程组**: 根据加法器的输入，为每个中间变量以及最终输出列出方程。
3.  **求解消元**: 解这个方程组，消除所有中间变量，最终得到只含输入 `X(z)` 和输出 `Y(z)` 的关系式，从而求得 $H(z) = Y(z)/X(z)$。

#### 5. ⚠️ 无延时回路问题

*   **定义**: 指信号经过一个反馈回路后没有经过任何延时单元（`z⁻¹`）就回到自身输入端。
*   **问题**: 这种结构在物理上是<font color="orange">不可实现</font>的。因为计算当前时刻的输出 `y[n]` 需要用到 `y[n]` 自身的值，造成逻辑死锁。
*   **解决方法**: 通过代数变换，将其转换为一个不含无延时回路的<font color="orange">等效结构</font>。

#### 6. 📏 规范结构与非规范结构

*   **<font color="orange">规范结构</font> (Canonical)**: 滤波器结构中所使用的延迟单元数目与其<font color="orange">阶数</font>相同。这是最节省存储资源的结构。
*   **非规范结构 (Non-canonical)**: 延迟单元的数目多于其阶数。
*   **滤波器阶数**:
    $y[n] = \sum_{k=1}^{N} a_k y[n-k] + \sum_{k=0}^{M} b_k x[n-k]$
    其阶数为 **max(M, N)**。

---

### 二、 等效结构 🔄

*   **定义**: 如果两个或多个滤波器结构具有完全相同的<font color="orange">传输函数 H(z)</font>，则称它们是等效的。
*   **理论 vs. 现实**:
    *   **理论上**: 所有等效结构的性能都应相同。
    *   **现实中**: 由于<font color="orange">有限字长效应</font>，不同等效结构在实现时的性能（如误差、稳定性、运算速度）可能差异巨大。
*   **如何产生等效结构？—— 转置运算法**
    1.  反转所有路径中信号的流动方向。
    2.  将所有网络节点（信号分支点）变成加法器。
    3.  将所有加法器变成网络节点。
    4.  将输入和输出端互换。

---

### 三、 FIR 和 IIR 滤波器对比 🆚

| 特性         | FIR 滤波器 (有限脉冲响应)                          | IIR 滤波器 (无限脉冲响应)                                                              |
| :--------- | :---------------------------------------- | :---------------------------------------------------------------------------- |
| **定义**     | $h[n]$ 在 $0 \le n \le N$ 范围非零             | $h[n]$ 在 $0 \le n \le \infty$ 范围非零                                            |
| **时域模型**   | $y[n] = \sum_{k=0}^{N} b_k x[n-k]$ (无反馈)  | $\sum_{k=0}^{N} a_k y[n-k] = \sum_{k=0}^{M} b_k x[n-k]$ (有反馈)                 |
| **单位脉冲响应** | $h[n] = \sum_{k=0}^{N} b_k \delta[n-k]$   | $h[n] = \mathcal{F}^{-1}[H(e^{j\omega})]$                                     |
| **系统函数**   | $H(z) = \sum_{k=0}^{N} b_k z^{-k}$ (只有零点) | $H(z) = \frac{\sum_{k=0}^{M} b_k z^{-k}}{\sum_{k=0}^{N} a_k z^{-k}}$ (有零点和极点) |
| **稳定性**    | 🌟 **总是稳定**                               | 稳定性由<font color="orange">极点</font>位置决定，可能不稳定                                  |
| **相位**     | ✅ 容易实现严格的<font color="orange">线性相位</font> | ❌ 难以实现线性相位                                                                    |
| **阶数**     | N                                         | max(N, M)                                                                     |

---

### 四、 FIR 数字滤波器的基本结构 🔨

N阶FIR滤波器的系统函数为：
$H(z) = \sum_{k=0}^{N} h[k]z^{-k}$
它总共有 **N+1** 个参数（滤波器系数）。

#### 1. <font color="orange">直接型</font> (Direct Form)
![](Pastedimage20251113103255.png)
![](Pastedimage20251113103316.png)
*   也称为<font color="orange">抽头延迟线结构</font>或横向滤波器结构。
*   **结构**: 将输入信号通过一串延迟单元，每个延迟单元的输出乘以对应的系数 `h[k]`，最后将所有乘积相加得到输出。
*   **特点**:
    *   实现简单直观。
    *   **缺点**: 系数 `h[k]` 与滤波器的<font color="orange">零点</font>之间关系复杂，不方便精确控制零点位置。

#### 2. <font color="orange">级联型</font> (Cascade Form)
![](Pastedimage20251113103454.png)
*   **原理**: 将系统函数 $H(z)$ 分解为多个一阶或二阶因子的乘积。
    $\boxed{H(z) = h[0] \prod_{k=1}^{K} (1 + \beta_{1k}z^{-1} + \beta_{2k}z^{-2})}$
*   **结构**: 将这些一阶或二阶系统串联起来。
*   **特点**:
    *   每一节控制一对零点，非常适合需要精确控制传输<font color="orange">零点</font>位置的应用。
    *   是<font color="orange">规范型</font>结构。
#### 3. <font color="orange">多相结构</font> (Polyphase Structure) 

*   **原理**: 将一个高阶FIR滤波器 $H(z)$ 的冲激响应 $h[n]$ 按一定规则（L个分支）分组，分解成多个<font color="orange">并联</font>的低阶子滤波器（称为多相分量）。
*   **数学分解**:
    $H(z) = \sum_{m=0}^{L-1} z^{-m} E_m(z^L)$
    其中，第 $m$ 个多相分量 $E_m(z)$ 是由原冲激响应 $h[n]$ 中每隔 $L$ 个点取一个系数构成的：
    $E_m(z) = \sum_{n=0}^{\infty} h[Ln+m]z^{-n}$
*   **举例 (L=2)**: 将 $H(z)$ 分解为2个分支。
    1.  **分组**: 将系数分为偶数下标 $(h[0], h[2], \dots)$ 和奇数下标 $(h[1], h[3], \dots)$ 两组。
    2.  **构建多相分量**:
        $E_0(z) = h[0] + h[2]z^{-1} + h[4]z^{-2} + \dots$
        $E_1(z) = h[1] + h[3]z^{-1} + h[5]z^{-2} + \dots$
    3.  **重构 H(z)**:
        $H(z) = (h[0] + h[2]z^{-2} + \dots) + z^{-1}(h[1] + h[3]z^{-2} + \dots)$
        $H(z) = E_0(z^2) + z^{-1}E_1(z^2)$
*   **结构**: 输入信号 `x[n]` 分成两条支路：
    *   上支路：直接输入子滤波器 $E_0(z^2)$。
    *   下支路：先经过一个单位延时 $z^{-1}$，再输入子滤波器 $E_1(z^2)$。
    *   两支路的输出相加得到最终结果 `y[n]`。
*   💡 **应用场景**: 多相结构在<font color="orange">多速率信号处理</font>（如插值和抽取）中极为重要，可以大幅提高计算效率。

#### 4. <font color="orange">线性相位</font> FIR 结构
![](Pastedimage20251113103800.png)
![](Pastedimage20251113103845.png)
*   **原理**: 线性相位FIR滤波器的冲激响应具有对称性或反对称性。
    $h[n] = \pm h[N-n]$
*   **优势**: 利用这个对称性，可以在实现时将对称位置的系数对应的信号先相加，再进行一次乘法，从而使<font color="orange">乘法器数量减少约一半</font>，大大节省计算资源。
*   区分对称性或反对称性看加法器有无标注“-1”。

---

### 五、 IIR 数字滤波器的基本结构 🛠️

N阶IIR滤波器的系统函数为有理分式：
$\boxed{H(z) = \frac{\sum_{k=0}^{M} p_k z^{-k}}{1 + \sum_{k=1}^{N} d_k z^{-k}}}$

#### 1. <font color="orange">直接I型</font> (Direct Form I)
![](Pastedimage20251113104330.png)
![](Pastedimage20251113104443.png)
*   **原理**: 将 $H(z)$ 看作一个全零点系统 $H_1(z)$ 和一个全极点系统 $H_2(z)$ 的级联。
    $H(z) = H_1(z) H_2(z)$
*   **结构**: 先实现FIR部分（分子），再实现反馈部分（分母）。
*   **特点**:
    *   需要 M+N 个延迟单元，是<font color="orange">非规范结构</font>。共需N+M+1个乘法器、N+M个双输入加法器。
    *   **缺点**: 极点对系数变化非常敏感，有限字长效应下容易不稳定。

#### 2. <font color="orange">直接II型</font> (Direct Form II)
![](Pastedimage20251113104747.png)
![](Pastedimage20251113104759.png)
*   **原理**: 将直接I型中的全零点和全极点两个子系统<font color="orange">交换次序</font>。由于中间的延迟线完全相同，可以合并。
*   **结构**: 输入信号先经过反馈（极点）部分，再经过前向（零点）部分。
*   **特点**:
    *   ✨ **优点**: 只需要 max(M, N) 个延迟单元，是<font color="orange">规范结构</font>，最节省存储单元。
    *   **缺点**: 仍然具有直接型实现的一般缺点，即对系数精度敏感。

#### 3. <font color="orange">级联型</font> (Cascade Form)
![](Pastedimage20251113104937.png)
*   **原理**: 将 $H(z)$ 的分子和分母都分解成一阶或二阶多项式的乘积，然后将它们配对，形成多个二阶子系统（Biquad Section）。
    $H(z) = p_0 \prod_{k} \frac{1 + \beta_{1k}z^{-1} + \beta_{2k}z^{-2}}{1 + \alpha_{1k}z^{-1} + \alpha_{2k}z^{-2}}$
*   **结构**: 将这些二阶子系统串联起来。
*   **特点**:
    *   每个二阶模块的系数<font color="orange">单独控制</font>一对零点和一对极点。
    *   对系数的量化误差不那么敏感，比直接型结构<font color="orange">鲁棒性更好</font>。

#### 4. 并联I型 (Parallel Form I)

1.  **数学基础**: 对 $H(z)$ 直接进行关于 $z^{-1}$ 的部分分式展开。
    $$
    H(z) = \gamma_0 + \sum_{k=1}^{K} H_k(z) = \gamma_0 + \sum_{k=1}^{K} \frac{\gamma_{0k} + \gamma_{1k}z^{-1}}{1 + \alpha_{1k}z^{-1} + \alpha_{2k}z^{-2}}
    $$
    *   **关键点**: 注意看分子的形式 $(\gamma_{0k} + \gamma_{1k}z^{-1})$。它也是一个关于 $z^{-1}$ 的多项式。$\gamma_0$ 是通过多项式长除法得到的常数项（如果分子阶数 $\ge$ 分母阶数）。

2.  **结构特点**: **每个并联支路**的内部结构类似于**直接I型**。
    
    *   **信号流**: 输入信号 `X` 进入一个求和节点，与来自反馈环路的信号相加。
    *   这个求和节点的输出，我们称之为中间信号 `w[n]`。
    *   然后，这个中间信号 `w[n]` 和它的延迟版本 `w[n-1]` 分别乘以分子系数 $\gamma_{0k}$ 和 $\gamma_{1k}$，再相加得到该支路的输出。
    *   **本质**: "先实现极点（分母），再用中间结果去实现零点（分子）"。

3.  **MATLAB 实现**: 使用 `residuez` 函数。
    `[r, p, k] = residuez(b, a)`
    *   `b` 和 `a` 是关于 $z^{-1}$ 的分子和分母系数向量。
    *   `r` 返回的是每个分式项的**分子系数向量**，`p` 是极点，`k` 是常数项。

#### 5. 并联II型 (Parallel Form II)

1.  **数学基础**: 对 $H(z)$ 进行关于 $z$ 的标准部分分式展开。
    $$
    H(z) = \delta_0 + \sum_{k=1}^{K} H_k(z) = \delta_0 + \sum_{k=1}^{K} \frac{\delta_{1k}z^{-1} + \delta_{2k}z^{-2}}{1 + \alpha_{1k}z^{-1} + \alpha_{2k}z^{-2}}
    $$
    *   **看起来一样？** 公式形式看起来和I型非常相似，但请注意，系数 $\delta_{ik}$ 的值与 $\gamma_{ik}$ 是**完全不同**的，因为它们是通过不同的数学过程（对 $z$ 而不是 $z^{-1}$ 展开）得到的。

2.  **结构特点**: **每个并联支路**的内部结构类似于**直接II型**。
    
    *   **信号流**: 输入信号 `X` 进入求和节点，与反馈信号相加后，进入一个共享的延迟链。
    *   分子系数 $\delta_{1k}$, $\delta_{2k}$ 是从这个**共享延迟链**的不同节点（即状态变量）抽头并加权求和，得到支路输出。
    *   **本质**: "极点和零点共享同一组延迟单元"。这使得每个支路都是**规范结构**，存储效率最高。

3.  **MATLAB 实现**: 使用 `residue` 函数。
    `[r, p, k] = residue(b, a)`
    *   `b` 和 `a` 是关于 **$z$ 的降幂排列**的分子和分母系数向量。
    *   `r` 返回的是每个分式项的**分子（通常是常数）**，`p` 是极点，`k` 是多项式部分。你需要对结果进行一些转换才能得到课件幻灯片中的 $H(z)$ 表达式。


---

### 六、 基本结构的 MATLAB 实现 💻

*   **级联实现 (Cascade)**:
    *   `[z,p,k] = tf2zp(num, den)`: 从传输函数求零极点。
    *   `sos = zp2sos(z,p,k)`: 将零极点转换成级联的二阶节 (Second-Order Sections)。
*   **并联实现 (Parallel)**:
    *   `[r,p,k] = residuez(num, den)`: 对 $z^{-1}$ 多项式进行部分分式展开 (用于并联I型)。
    *   `[r,p,k] = residue(num, den)`: 对 $z$ 多项式进行部分分式展开 (用于并联II型)。

---

### 七、 🧠 本章学习总结

本讲我们系统学习了数字滤波器的各种实现结构，核心思想是在保证传输函数不变的前提下，寻找性能更优、资源消耗更少的实现方式。

1.  **为何重要**: 滤波器的实现结构直接影响其在<font color="orange">有限精度</font>计算环境下的性能，包括稳定性、噪声和计算复杂度。
2.  **FIR 结构**:
    *   **直接型**最简单，但灵活性差。
    *   **级联型**通过分解，可以精确控制每一对零点。
    *   **线性相位结构**是利用系数对称性来优化计算量的典范。
3.  **IIR 结构**:
    *   **直接I型**直观但<font color="orange">非规范</font>，存储开销大。
    *   **直接II型**是<font color="orange">规范结构</font>，存储效率最高。
    *   **直接型**（I和II）对系数敏感，容易因量化误差导致性能下降甚至不稳定。
    *   **级联型**和**并联型**将高阶系统分解为多个低阶（通常是二阶）系统的组合，大大增强了对系数误差的<font color="orange">鲁棒性</font>。其中，<font color="orange">并联型</font>的误差累积最小，性能最好。

在实际应用中，对于要求较高的IIR滤波器，通常会优先选择<font color="orange">级联型</font>或<font color="orange">并联型</font>结构，而不是直接型。

## 第九章 IIR数字滤波器设计
#### 📜 本讲主要内容

*   **引言**：介绍IIR滤波器的基本概念、优缺点和设计思路。
*   **系统的全通分解与最小相位系统**：回顾相位校正的相关理论基础。
*   **IIR数字滤波器的设计流程**：阐述设计的总体步骤和框架。
*   **IIR模拟滤波器设计**：深入学习两种经典的模拟滤波器设计方法——巴特沃斯和切比雪夫。
*   **模拟和数字之间的转换**：介绍设计流程中的关键转换环节。
*   **其他类型滤波器设计**：简要提及高通、带通和带阻IIR数字滤波器的设计。

---

### 🧠 一、IIR滤波器设计前的思考

在开始设计之前，我们需要明确IIR滤波器的基本特性和设计挑战。

#### 1. 引言：什么是IIR滤波器？

IIR (Infinite Impulse Response) 滤波器，即<font color="orange">无限长冲激响应滤波器</font>，是一种极零点滤波器。
*   **特点**：系统函数同时包含零点和极点。
*   **反馈**：极点的存在意味着系统中存在<font color="orange">反馈</font>，这也是其冲激响应无限长的原因。

其差分方程和系统函数可以表示为：

*   **差分方程**：
   $\sum_{k=0}^{N} a_k y[n-k] = \sum_{k=0}^{M} b_k x[n-k]$
   
*   **系统函数**：
   $\boxed{H(z) = \frac{Y(z)}{X(z)} = \frac{\sum_{k=0}^{M} b_k z^{-k}}{\sum_{k=0}^{N} a_k z^{-k}}}$

#### 2. IIR滤波器的优缺点

✅ **主要优点**：
1.  **结构简单**：与实现相同性能指标的FIR滤波器相比，IIR滤波器的阶数更低，计算量更小。
2.  **易于级联**：高阶滤波器可以方便地由低阶滤波器级联实现。

❌ **主要缺点**：
1.  **不稳定性**：由于极点的存在，如果设计不当（极点位于单位圆外），系统可能会<font color="orange">不稳定</font>。
2.  **非线性相位**：很难实现严格的<font color="orange">线性相位</font>。

#### 3. IIR数字滤波器的设计思路

💡 **核心思想**：直接设计IIR数字滤波器比较困难，但模拟滤波器的设计理论非常成熟。因此，我们采用一种<font color="orange">间接</font>的设计方法。

1.  **借助模拟滤波器**：将数字滤波器的设计问题，通过某种变换，转化为模拟滤波器的设计问题。
2.  **设计流程**：
    *   将数字滤波器的技术指标 → 转换为模拟滤波器的技术指标。
    *   使用成熟的模拟滤波器设计方法（如巴特沃斯、切比雪夫）得到模拟滤波器。
    *   将设计好的模拟滤波器 → 转换回相应的数字滤波器。

#### 4. 为什么要回顾全通和最小相位系统？

通信系统对<font color="orange">相位失真</font>非常敏感，而IIR滤波器难以满足线性相位要求。为了解决这个问题，我们需要回顾相关概念。
*   **目标**：在不改变系统幅频响应的前提下，对相位进行校正，使其尽可能接近线性相位或常数相位。
*   **方法**：将一个IIR滤波器分解为一个<font color="orange">最小相位系统</font>和一个<font color="orange">全通系统</font>的级联，利用全通系统来调整相位。

---

### ⚙️ 二、系统的全通分解与最小相位系统

#### 1. 全通系统 (All-pass System)

*   **定义**：一个因果稳定的系统，其幅频响应在所有频率上都为常数（通常为1）。
   $|H_{ap}(e^{j\omega})| = 1, \quad 0 \le \omega < 2\pi$
*   **最简单的全通系统**：纯延迟环节$H_{ap}(z) = z^{-k}$。
*   **极零点关系**：一个全通系统的<font color="orange">极点</font>和<font color="orange">零点</font>关于单位圆呈<font color="orange">镜像对称</font>。如果$p_k$是一个极点，则$1/p_k^*$是一个零点。
*   **系统函数**：
   $\boxed{H_{ap}(z) = \pm \prod_{k=1}^{N} \frac{z^{-1}-\lambda_k^*}{1-\lambda_k z^{-1}}} \quad \text{其中 } |\lambda_k|<1$
*   **重要特性**：
    *   稳定的全通系统，所有极点在单位圆内，所有零点在单位圆外。
    *   相位响应单调递减。
    *   群时延恒大于0。

#### 2. 最小相位系统 (Minimum-Phase System)

*   **定义**：一个因果、稳定的系统，其<font color="orange">所有零点和极点</font>都在单位圆内部。
*   **相关概念**：
    *   **最大相位系统**：所有零点都在单位圆外。
    *   **混合相位系统**：零点在单位圆内外都有分布。

*   **重要性质**：
    1.  在所有具有相同幅频响应的系统中，最小相位系统具有<font color="orange">最小的相位延迟</font>和<font color="orange">最小的群时延</font>。
    2.  只有最小相位系统的<font color="orange">逆系统</font>才是因果稳定的，即物理可实现。关键在于：一个系统的零点，会成为其逆系统的极点。而一个离散时间系统要同时满足因果和稳定，其**所有极点必须全部位于单位圆内部**。
	
#### 3. 全通分解

*   **核心定理**：任何一个非最小相位的因果稳定系统$H(z)$，都可以分解为一个最小相位系统$H_{min}(z)$和一个全通系统$H_{ap}(z)$的级联。
   $\boxed{H(z) = H_{min}(z) H_{ap}(z)}$
*   **分解方法**：将原系统在单位圆外的零点$z_0$（$|z_0|>1$）翻转到单位圆内 ($1/z_0^*$)，并构造一个相应的全通环节来补偿幅度的变化。

---

### 📈 三、IIR数字滤波器设计流程

#### 1. 确定技术指标

设计一个滤波器，首先要明确其性能要求，通常对于低通滤波器，有四个核心指标：
![](Pastedimage20251115104146.png)
![](Pastedimage20251115105148.png)
*  $\omega_p$：通带截止频率
*  $\omega_s$：阻带截止频率
*  $\alpha_p$：通带最大衰减 (或峰值通带波纹)
*  $\alpha_s$：阻带最小衰减
*   **通带波纹 (dB)**:$\alpha_p = -20\log_{10}(1-\delta_p)$
*   **阻带衰减 (dB)**:$\alpha_s = -20\log_{10}(\delta_s)$

#### 2. 总体设计流程

以双线性变换法为例，整个流程如下所示：

1.  **数字化指标 → 模拟化指标**：将数字滤波器的指标 ($\omega_p, \omega_s, \alpha_p, \alpha_s$) 转换为模拟滤波器的指标 ($\Omega_p, \Omega_s, \alpha_p, \alpha_s$)。（例如通过$\Omega = g(\omega)$）
2.  **设计模拟滤波器**：根据模拟指标，选择一种逼近方法（如巴特沃斯、切比雪夫），设计出模拟滤波器原型$H_a(s)$。
3.  **模拟滤波器 → 数字滤波器**：将得到的$H_a(s)$通过变换（例如$s=f(z)$）转换为最终的数字滤波器$H(z)$。

---

### 🔌 四、IIR模拟滤波器设计

模拟滤波器设计的核心问题是：根据给定的技术指标，找到一个合适的系统函数$G(s)$。

#### 1. 设计核心

设计的关键是逼近理想的<font color="orange">幅度平方特性</font>$|G(j\Omega)|^2$。一旦确定了它，就可以通过以下关系求解$G(s)$：
$|G(j\Omega)|^2 = G(s)G(-s) \Big|_{s=j\Omega}$
从$G(s)G(-s)$的极点中，选择<font color="orange">左半平面</font>的极点分配给$G(s)$，即可保证系统的稳定性。

#### 2. 设计步骤

1.  **频率归一化**：将通带截止频率$\Omega_p$归一化为1，即$\lambda = \Omega / \Omega_p$。
2.  **确定参数**：根据技术指标和所选的逼近函数，确定滤波器的阶数$N$等参数。
3.  **求归一化系统函数 G(p)**：其中$p$是归一化的复变量，$p=s/\Omega_p$。
4.  **去归一化**：将$p$替换回$s/\Omega_p$，得到最终的系统函数$G(s)$。

#### 3. 巴特沃斯 (Butterworth) 滤波器

被称为<font color="orange">最平坦幅度</font>滤波器，其通带和阻带都是单调变化的。

*   **幅度平方特性**：
   $\boxed{|G(j\Omega)|^2 = \frac{1}{1 + C^2 \Omega^{2N}}}$
    其中，$N$是滤波器阶数，$C$是待定常数。

*   **阶数 N 和 C 的确定**：
   $\boxed{N \ge \frac{\log_{10}\left(\frac{10^{\alpha_s/10}-1}{10^{\alpha_p/10}-1}\right)}{2\log_{10}(\frac{\Omega_s}{\Omega_p})}}$
   $\boxed{C^2 = 10^{\alpha_p/10}-1}$(当$\Omega_p$为3dB截止频率时，C=1)

*   **极点分布**：$G(p)G(-p)$的$2N$个极点均匀分布在复平面上一个半径为$1/C^{1/N}$的圆上。为了保证稳定性，$G(p)$的极点取该圆上位于<font color="orange">左半平面</font>的$N$个极点。
*   **特点**：响应曲线平滑，但过渡带较宽。阶数$N$越大，过渡带越窄。

#### 4. 切比雪夫 (Chebyshev) 滤波器

相比巴特沃斯滤波器，在阶数相同的情况下，切比雪夫滤波器具有<font color="orange">更窄的过渡带</font>。

*   **I 型切比雪夫滤波器**：
    *   **特点**：通带<font color="orange">等波纹</font>，阻带单调下降。
    *   **幅度平方特性**：
       $\boxed{|G(j\Omega)|^2 = \frac{1}{1 + \epsilon^2 C_n^2(\Omega)}}$
        其中，$C_n(\Omega)$是n阶切比雪夫多项式，$\epsilon$与通带波纹有关。
    *   **极点分布**：$G(p)$的极点分布在一个<font color="orange">椭圆</font>上。
    *   **注意点**：以牺牲通带平坦性为代价，换取了更陡峭的过渡特性。

*   **II 型切比雪夫滤波器** (反切比雪夫):
    *   **特点**：通带单调，阻带<font color="orange">等波纹</font>。

#### 5. 椭圆滤波器 (Elliptic Filter)

*   **特点**：通带和阻带都是<font color="orange">等波纹</font>的。
*   **优势**：在所有阶数相同的滤波器中，具有最窄的过渡带。
*   **复杂度**：设计最为复杂，系统函数同时包含零点和极点。

---

### 📝 本章学习总结

1.  **核心思想**：本讲的核心是IIR数字滤波器的<font color="orange">间接设计法</font>。我们不直接在数字域进行设计，而是利用成熟的模拟滤波器理论作为桥梁。
2.  **设计流程**：整个设计过程可以概括为 **“数字指标 → 模拟指标 → 模拟原型设计 → 模拟转数字”**。
3.  **相位问题**：IIR滤波器天然存在非线性相位问题，可以通过<font color="orange">全通分解</font>，将其表示为最小相位系统和全通系统的级联，从而为相位校正提供了理论基础。
4.  **模拟滤波器类型**：
    *   **巴特沃斯**：最平坦幅度，设计简单，过渡带较宽。
    *   **切比雪夫I型**：通带等波纹，过渡带比巴特沃斯窄。
    *   **椭圆**：通带、阻带均等波纹，过渡带最窄，设计最复杂。
5.  **关键步骤**：模拟滤波器设计的关键在于根据指标求解其<font color="orange">幅度平方函数</font>，并从中求解出稳定的系统函数$G(s)$。

本讲主要集中在流程和模拟滤波器的设计上，下一部分将重点讨论模拟与数字之间的转换方法。


好的，这是一个在IIR滤波器设计中至关重要的概念。我们来详细、系统地解释一下**双线性变换法 (Bilinear Transform Method)**。

---

### 🚀 一、双线性变换法是什么？

简单来说，双线性变换法是一种**数学工具**，它充当了**模拟世界**（连续时间，$s$域）和**数字世界**（离散时间，$z$域）之间的**桥梁**或**翻译器**。

它的核心作用是将一个已知的模拟滤波器系统函数 $H_a(s)$，通过一个简单的代数替换，直接转换成一个数字滤波器的系统函数 $H(z)$。

### 🤔 二、为什么需要它？

正如之前的笔记中提到的，IIR数字滤波器的设计思路是“借用”成熟的模拟滤波器设计理论。这个过程需要两个关键的转换：

1.  **指标转换**：将数字频率指标转换为模拟频率指标。
2.  **系统转换**：将设计好的模拟滤波器 $H_a(s)$ 转换回数字滤波器 $H(z)$。

**双线性变换法就是实现第二步——系统转换——的最常用和最有效的方法。**

### 🧠 三、核心思想与数学公式

双线性变换法的思想来源于用**数值积分**来近似模拟系统中的积分运算。具体来说，它使用了**梯形法则 (Trapezoidal Rule)** 来近似积分。

推导过程如下：
1.  在$s$域中，$1/s$ 代表积分。
2.  在离散时间域中，对信号$x(n)$的积分可以用梯形法则来近似：
    $y[n] = y[n-1] + \frac{T}{2}(x[n] + x[n-1])$
    其中，$T$是采样周期。
3.  对上式进行Z变换，可以得到离散时间积分器的传递函数：
    $H(z) = \frac{Y(z)}{X(z)} = \frac{T}{2} \frac{1+z^{-1}}{1-z^{-1}}$
4.  让模拟积分器 $H_a(s)=1/s$ 和数字积分器 $H(z)$ 相等，我们就能得到$s$和$z$之间的关系：
    $\frac{1}{s} = \frac{T}{2} \frac{1+z^{-1}}{1-z^{-1}}$
5.  整理后，得到最终的双线性变换公式：

    $\boxed{s = \frac{2}{T}\frac{1-z^{-1}}{1+z^{-1}}}$

这个公式就是双线性变换法的**核心**。设计过程就是简单地将模拟滤波器 $H_a(s)$ 中的每一个 $s$ 都用这个关于 $z$ 的表达式替换掉。

*注意：在很多理论推导中，为了简化，会假设 $T=2$，此时公式变为 $s = \frac{1-z^{-1}}{1+z^{-1}}$。*

### 🌟 四、关键特性：频率映射与频率畸变

当我们将模拟滤波器转换为数字滤波器时，最关心的是频率响应是如何变化的。

通过令 $s=j\Omega$ (模拟频率) 和 $z=e^{j\omega}$ (数字频率)，我们可以得到模拟角频率 $\Omega$ 和数字角频率 $\omega$ 之间的映射关系：

$\boxed{\Omega = \frac{2}{T}\tan\left(\frac{\omega}{2}\right)}$

这个关系揭示了双线性变换法最重要的特性：

1.  **非线性映射 (Non-linear Mapping)**：$\Omega$ 和 $\omega$ 之间的关系是**非线性**的，通过一个 `tan` 函数关联。这意味着模拟频率轴被“**弯曲**”或“**压缩**”后映射到了数字频率轴上。这个现象被称为**频率畸变 (Frequency Warping)**。



2.  **无混叠 (No Aliasing)**：整个无限长的模拟频率轴 ($-\infty < \Omega < +\infty$) 被**一对一**地映射到了一个有限的数字频率区间 ($-\pi/T < \omega < \pi/T$)。这意味着**不会发生频率混叠**，这是它相比于冲激响应不变法等其他方法的最大优势。

3.  **稳定性保持 (Stability Preservation)**：双线性变换能将稳定的模拟滤波器（所有极点在$s$平面的左半边）精确地映射为稳定的数字滤波器（所有极点在$z$平面的单位圆内部）。这是一个非常宝贵的性质。

### 🔧 五、如何应对频率畸变？—— 预畸变 (Pre-warping)

既然频率畸变是不可避免的，我们该怎么办呢？答案是**提前补偿**。

这个过程被称为**预畸变 (Pre-warping)**。具体做法是：
在设计模拟滤波器**之前**，我们先将我们期望的**数字**截止频率（例如 $\omega_p, \omega_s$）通过上面的映射公式**反向计算**出对应的**模拟**截止频率，然后用这些“预先畸变”过的模拟频率来设计模拟滤波器。

**预畸变公式**：
$\Omega_p = \frac{2}{T}\tan\left(\frac{\omega_p}{2}\right)$
$\Omega_s = \frac{2}{T}\tan\left(\frac{\omega_s}{2}\right)$

这样一来，当最后我们应用双线性变换时，频率畸变会把我们预先设置的模拟频率点“恰好”地变回到我们最初想要的数字频率点上，从而得到精确的截止频率。

### 📋 六、总结：双线性变换法的优缺点与设计步骤

#### 优点 👍
*   **无频率混叠**。
*   **保持系统稳定性**。
*   转换过程是简单的**代数替换**，非常方便。

#### 缺点 👎
*   **频率畸变**，导致频率响应的形状发生改变。不过可以通过预畸变来精确控制关键频率点。
*   它只对**幅度响应**进行变换，相位响应也会相应地被畸变。

#### 完整设计步骤
1.  **确定数字滤波器指标**：$\omega_p, \omega_s, \alpha_p, \alpha_s$。
2.  **预畸变**：使用公式 $\Omega = \frac{2}{T}\tan(\frac{\omega}{2})$ 将数字频率指标 $\omega_p, \omega_s$ 转换为模拟频率指标 $\Omega_p, \Omega_s$。
3.  **设计模拟滤波器**：使用 $\Omega_p, \Omega_s, \alpha_p, \alpha_s$ 设计出模拟滤波器原型 $H_a(s)$（例如，使用巴特沃斯或切比雪夫方法）。
4.  **应用双线性变换**：将 $H_a(s)$ 中的 $s$ 替换为 $\frac{2}{T}\frac{1-z^{-1}}{1+z^{-1}}$。
5.  **化简**：整理代数表达式，得到最终的数字滤波器系统函数 $H(z)$。