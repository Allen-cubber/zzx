---
title: 第五章 有限长离散变换
date: 2025-09-22T10:00:00+08:00
tags:
  - 大三上
  - 数字信号处理
summary: DFT不仅是一个数学工具，更是数字信号处理中从理论走向实践，从复杂运算走向高效实现的关键一步。
---
### 📚 第5章 有限长离散变换

本章我们将深入探讨<font color="orange">有限长序列</font>的频域分析工具——离散傅里叶变换 (DFT)。它是连接时域和频域的关键桥梁，也是许多快速算法（如FFT）的基础。

---

### 📖 本讲主要内容

*   **1. 正交变换 📐**: 了解变换的基本概念和能量关系。
*   **2. 离散傅里叶变换 (DFT) 📊**:
    *   DFT 的定义与性质。
    *   DFT 与 DTFT 的深刻联系。
*   **3. DFT 计算 💻**:
    *   圆周移位与圆周卷积。
    *   利用对称性高效计算实序列的DFT。
    *   使用DFT实现线性卷积。

---

### 1. 正交变换 📐

#### 1.1 正交变换定义

<font color="orange">正交变换</font>是一种将信号表示为一组正交基函数（或基序列）线性组合的方法。

*   **分析式 (正变换)**: 从时域信号 `x[n]` 计算变换域系数 `X[k]`
    $X[k] = \sum_{n=0}^{N-1} x[n] \psi^*[k, n], \quad 0 \le k \le N-1$

*   **综合式 (反变换)**: 从变换域系数 `X[k]` 重构时域信号 `x[n]`
    $x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] \psi[k, n]$

*   **基序列的正交性**: 这是变换能够成立的核心。
    $$ \boxed{\frac{1}{N} \sum_{n=0}^{N-1} \psi[k, n] \psi^*[l, n] = \begin{cases} 1, & l=k \\ 0, & l \neq k \end{cases}} $$

*   **特性：能量保持 💪** (帕斯瓦尔定理)
    变换前后信号的总能量保持不变（仅相差一个尺度因子）。
    $$ \sum_{n=0}^{N-1} |x[n]|^2 = \frac{1}{N} \sum_{k=0}^{N-1} |X[k]|^2 $$

---

### 2. 离散傅里叶变换 (DFT) 📊

<font color="orange">离散傅里叶变换</font> (Discrete Fourier Transform, DFT) 是一种特殊的正交变换，它的基序列是复指数序列。

#### 2.1 定义

*   **DFT (正变换)**
    $$ \boxed{X[k] = \sum_{n=0}^{N-1} x[n] W_N^{kn}, \quad 0 \le k \le N-1} $$

*   **IDFT (逆变换)**
    $$ \boxed{x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] W_N^{-kn}, \quad 0 \le n \le N-1} $$

*   **旋转因子 (Twiddle Factor)**
    $$ W_N = e^{-j\frac{2\pi}{N}} $$

#### 2.2 DFT 与 DTFT 的关系

DFT 和 DTFT (离散时间傅里叶变换) 关系密切，理解它们的区别至关重要。

*   **核心关系**: N点DFT可以看作是其序列的DTFT在频域上的 **N点等间隔采样**。
    $$ X[k] = X(e^{j\omega})|_{\omega = \frac{2\pi k}{N}} $$

*   **时域与频域的对应关系**:
    *   **时域周期延拓 ↔ 频域采样**: 对时域信号进行周期延拓，其频谱会变成离散的采样点。
    *   **频域周期延拓 ↔ 时域采样**: 对频域信号进行周期延拓，其时域对应会变成离散的采样点。

#### 2.3 DFT 幅度谱与相位谱

DFT的结果 `X[k]` 是一个复数序列，可以表示为幅度和相位的形式。

$X[k] = |X[k]| e^{j\theta[k]}$

*   **DFT幅度谱**: $|X[k]|$，表示信号在各个频率分量上的强度。
*   **DFT相位谱**: $\theta[k]$，表示信号在各个频率分量上的相位。

#### 2.4 旋转因子 $W_N$ 的性质

*   **周期性**: $W_N^{k+N} = W_N^k$
*   **对称性**: $W_N^{-k} = W_N^{N-k} = (W_N^k)^*$ (共轭对称)
*   **其它重要性质**:
    *   $W_N^0 = W_N^N = 1$
    *   $W_N^{N/2} = e^{-j\pi} = -1$

#### 2.5 DFT 的运算量

直接根据定义计算N点DFT，需要的计算量较大：
*   **复数乘法**: $N^2$ 次
*   **复数加法**: $N(N-1)$ 次
正是因为这个原因，才催生了更高效的<font color="orange">快速傅里叶变换 (FFT)</font>算法。

#### 2.6 DFT 变换举例

**例1：余弦序列**
对于序列 $x[n] = \cos(2\pi rn/N)$，其N点DFT为：
$X[k] = \begin{cases} N/2, & k=r \text{ 或 } k=N-r \\ 0, & \text{otherwise} \end{cases}$

如下图所示 (N=16, r=3)，频谱在 `k=3` (正频率) 和 `k=13` (等效于-3的负频率) 处出现峰值。

#### 2.7 利用DFT估算DTFT (插值)

我们可以通过对一个N点序列<font color="orange">补零</font>到M点 (M > N)，再做M点DFT，来获得原序列DTFT的更密集的频域采样点。这相当于在频域进行了<font color="orange">插值</font>。

*   **补零操作**: $x_e[n] = \begin{cases} x[n], & 0 \le n \le N-1 \\ 0, & N \le n \le M-1 \end{cases}$
*   **影响**: M越大，DFT的点数越多，对DTFT频谱形状的描述就越精细。

#### 2.8 频域采样与时域混叠

从DTFT采样得到DFT的过程，其逆过程会导致时域信号的周期延拓和叠加。

$y[n] = \text{IDFT}\{\text{DFT}(x[n])\} = \sum_{m=-\infty}^{\infty} x[n-mN]$

*   **⚠️ 注意点**: 如果原始序列 `x[n]` 的长度大于DFT的点数N，进行`DTFT -> 采样 -> IDFT`后得到的 `y[n]` 将会发生<font color="orange">时域混叠</font>，无法恢复出原始的 `x[n]`。只有当 `x[n]` 长度小于等于N时，才能完美恢复。

---

### 3. DFT 的性质

DFT的许多性质都与DTFT相似，但由于其离散和有限的特性，引入了<font color="orange">圆周（循环）</font>的概念。

#### 3.1 序列的圆周移位 (Circular Shift)

对一个N点序列 `x[n]` 进行移位，移出边界的部分会从另一端“卷回”，就像在一个圆环上进行移位。

*   **定义**: $x[\langle n-n_0 \rangle_N] = x[(n-n_0) \pmod N]$
*   **与线性移位的区别**: 线性移位是信号在无限长坐标轴上的平移；圆周移位是在一个长度为N的环上的旋转。
![](Pastedimage20250922210808.png)
#### 3.2 序列的圆周卷积 (Circular Convolution)

*   **定义**:
    $y_c[n] = g[n] \circledast_N h[n] = \sum_{m=0}^{N-1} g[m] h[\langle n-m \rangle_N]$

*   **与线性卷积的关系**:
    *   两个长度分别为M和N的序列，其<font color="orange">线性卷积</font>结果长度为 M+N-1。
    *   它们的N点<font color="orange">圆周卷积</font>结果长度为 N。
    *   **核心思想**: 只有当DFT的点数 $L \ge M+N-1$ 时，两序列的L点圆周卷积结果才等同于它们的线性卷积结果。这是利用DFT计算线性卷积的基础。

#### 3.3 DFT 主要性质汇总

|    性质    |             时域序列             |                 N点DFT                 |
| :------: | :--------------------------: | :-----------------------------------: |
|  **线性**  |     $ag[n] + \beta h[n]$     |         $aG[k] + \beta H[k]$          |
| **圆周时移** | $g[\langle n-n_0 \rangle_N]$ |           $W_N^{kn_0} G(k)$           |
| **圆周频移** |     $W_N^{-k_0 n} g[n]$      |     $G[\langle k-k_0 \rangle_N]$      |
| **对偶性**  |            $G[n]$            |      $N g[\langle -k \rangle_N]$      |
| **圆周卷积** |  $g[n] \circledast_N h[n]$   |              $G(k)H(k)$               |
|  **相乘**  |          $g[n]h[n]$          | $\frac{1}{N} G[k] \circledast_N H[k]$ |


#### 3.4 DFT 的对称关系

对称性在简化DFT计算中非常重要。

*   **对于任意复序列 x[n]**:
    *   $x^*[n] \leftrightarrow X^*[\langle -k \rangle_N]$
    *   $\text{Re}\{x[n]\} \leftrightarrow \frac{1}{2} (X[\langle k \rangle_N] + X^*[\langle -k \rangle_N])$

*   **⭐ 对于实序列 x[n] (最常用)**:
    其DFT具有<font color="orange">共轭对称性</font>。
    $$ \boxed{X[k] = X^*[\langle -k \rangle_N] = X^*[N-k]} $$
    这意味着:
    *   **幅度谱是偶对称的**: $|X[k]| = |X[N-k]|$
    *   **相位谱是奇对称的**: $\text{arg}(X[k]) = -\text{arg}(X[N-k])$

*   **⚠️ 注意点**: 由于共轭对称性，一个N点实序列的DFT，我们只需要计算并存储大约一半的系数（例如从k=0到N/2），就可以恢复出全部信息。

---

### 4. DFT 的运算 🚀

利用DFT的性质，我们可以设计出更高效的计算方法。

#### 4.1 用一次N点DFT计算两个N点实序列的DFT

*   **思想**: 将两个实序列 $g[n]$ 和 $h[n]$ 构造成一个复序列 $x[n] = g[n] + jh[n]$。
*   **步骤**:
    1.  计算 $x[n]$ 的N点DFT，得到 $X[k]$。
    2.  利用对称性分离出 $G[k]$ 和 $H[k]$:
        *   $G[k] = \frac{1}{2} \{ X[k] + X^*[\langle -k \rangle_N] \}$
        *   $H[k] = \frac{1}{2j} \{ X[k] - X^*[\langle -k \rangle_N] \}$

#### 4.2 用一次N点DFT计算一个2N点实序列的DFT

*   **思想**: 将2N点实序列 $v[n]$ 分解为偶数项和奇数项两个N点序列。
*   **步骤**:
    1.  构造 $g[n] = v[2n]$ 和 $h[n] = v[2n+1]$。
    2.  计算 $x[n] = g[n] + jh[n]$ 的N点DFT，得到 $X[k]$。
    3.  利用 $G[k]$ 和 $H[k]$ 重建 $V[k]$:
        $V[k] = G[\langle k \rangle_N] + W_{2N}^k H[\langle k \rangle_N], \quad 0 \le k \le 2N-1$

#### 4.3 用DFT实现线性卷积

这是DFT最核心的应用之一，特别是对于长序列的滤波。

*   **基本流程**:
    1.  对两个序列 $g[n]$ (长度M) 和 $h[n]$ (长度N) 进行<font color="orange">补零</font>，使它们的长度都达到 $L \ge M+N-1$。
    2.  计算两个补零后序列的L点DFT，得到 $G_e[k]$ 和 $H_e[k]$。
    3.  在频域相乘: $Y_e[k] = G_e[k] H_e[k]$。
    4.  计算L点IDFT: $y[n] = \text{IDFT}\{Y_e[k]\}$，得到的结果就是线性卷积。

*   **对于长序列**: 当一个序列很长时，可以将其分段，使用<font color="orange">重叠相加法</font>或<font color="orange">重叠保留法</font>进行高效计算。
    *   **重叠相加法 (Overlap-Add)**: 将输入信号分段，每段分别与滤波器做线性卷积（通过DFT），然后将各段结果中重叠的部分相加。
    *   **重叠保留法 (Overlap-Save)**: 输入信号分段时带有重叠，每段与滤波器做圆周卷积，保留没有被混叠污染的有效部分，然后拼接起来。

---

### ✍️ 本章总结

本章我们系统学习了有限长离散变换，核心是 **离散傅里叶变换 (DFT)**。

1.  **核心定义**: DFT是分析有限长序列频域特性的基本工具，其定义和逆变换公式是全章的基础。
2.  **与DTFT的关系**: DFT是DTFT的频域采样，这一关系解释了补零提高频谱分辨率（插值）和频域采样导致时域混叠的现象。
3.  **圆周运算**: DFT的性质与<font color="orange">圆周移位</font>和<font color="orange">圆周卷积</font>紧密相连。这是理解DFT与线性系统差异的关键。
4.  **卷积定理**: 时域的<font color="orange">圆周卷积</font>等价于频域的<font color="orange">乘积</font>。这是DFT最重要的性质之一，也是实现快速卷积算法的理论基础。
5.  **对称性**: 特别是对于实序列，其DFT的共轭对称性大大减少了计算和存储开销，是许多高效算法的出发点。
6.  **核心应用**: 利用DFT实现<font color="orange">快速线性卷积</font>。通过补零使圆周卷积等效于线性卷积，并结合重叠相加/保留法处理长序列，是DFT在工程实践中最广泛的应用。

总而言之，DFT不仅是一个数学工具，更是数字信号处理中从理论走向实践，从复杂运算走向高效实现的关键一步。