---
title: 第九章 IIR数字滤波器设计
date: 2025-11-15T08:00:00+08:00
tags:
  - 大三上
  - 数字信号处理
summary: 本讲的核心是IIR数字滤波器的间接设计法。我们不直接在数字域进行设计，而是利用成熟的模拟滤波器理论作为桥梁。
---
## 1. 引言与基础概念

### 1.1 IIR 滤波器特点
IIR（Infinite Impulse Response）即无限长冲激响应滤波器。
*   **结构特点**：既具有<font color="orange">零点</font>也具有<font color="orange">极点</font>。
*   **极点的影响**：极点的存在说明了**反馈**的存在，导致了无限长的冲激响应。
*   **差分方程**：
    $$ \sum_{k=0}^{N} a_k y[n-k] = \sum_{k=0}^{M} b_k x[n-k] $$
*   **系统函数**：
    $$ H(z) = \frac{\sum_{k=0}^{M} b_k z^{-k}}{\sum_{k=0}^{N} a_k z^{-k}} $$

### 1.2 优缺点对比
*   **优点**：
    1.  结构简单，计算量相对 FIR 较低。
    2.  易于表示成级联形式（由低阶滤波器级联实现高阶）。
*   **缺点**：
    1.  由于极点存在，可能导致**不稳定**。
    2.  较难满足<font color="orange">线性相位</font>要求。

### 1.3 设计思路
IIR 数字滤波器的设计主要借助**模拟 IIR 滤波器**的设计方法：
1.  将数字滤波器的设计问题转化为模拟滤波器的设计。
2.  设计满足指标的模拟滤波器。
3.  通过**数字-模拟转换逼近方法**（如双线性变换法）将模拟滤波器转换为数字滤波器。

---

## 2. 系统的全通分解与最小相位系统
*针对通信系统中对相位的敏感性，需要解决 IIR 系统的线性相位问题。*

### 2.1 全通系统 (All-pass System)
*   **定义**：幅频响应对所有频率都等于 1 或常数的因果系统。
    $$ |H_{ap}(e^{j\omega})| = 1, \quad 0 \le \omega < 2\pi $$
*   **数学模型**：
    $$ H_{ap}(z) = \pm \prod_{k=1}^{N} \frac{z^{-1}-\lambda_k^*}{1-\lambda_k z^{-1}}, \quad |\lambda_k| < 1 $$
    或者表示为：
    $$ H_{ap}(z) = \pm \frac{z^{-N} A(z^{-1})}{A(z)} $$
*   **特点**：
    1.  极点和零点关于单位圆<font color="orange">镜像对称</font>（若极点在 $z_p$，则零点在 $1/z_p^*$）。
    2.  若系统稳定（极点在单位圆内），则所有零点均在单位圆外。
    3.  相频响应随 $\omega$ 单调递减，群迟延大于 0。

### 2.2 最小相位系统 (Minimum Phase System)
*   **定义**：一个因果、稳定的系统，且**极点和零点全部位于单位圆内**。
*   **性质**：
    1.  相对于零相位系统，具有最小的相位偏移。
    2.  其冲激响应具有最小的时延（能量最集中在 $n=0$ 附近）。
    3.  只有最小相位滤波器的**逆滤波器**才是因果稳定的（物理可实现）。

### 2.3 全通分解
任何一个非最小相位的因果稳定系统 $H(z)$，都可以分解为一个最小相位系统 $H_{min}(z)$ 和一个全通系统 $H_{ap}(z)$ 的级联：
$$ \boxed{H(z) = H_{min}(z) H_{ap}(z)} $$
*   **应用**：利用全通滤波器进行<font color="orange">相位校正</font>（级联一个全通系统，不改变幅频响应，只改变相位，使其接近线性）。

---

## 3. 模拟低通滤波器设计
*设计 IIR 数字滤波器的核心是先设计模拟滤波器。*

### 3.1 技术指标
![](Pastedimage20251115104146.png)
![](Pastedimage20251115105148.png)
*   **通带**：$1-\delta_p \le |G(e^{j\omega})| \le 1+\delta_p$，截止频率 $\omega_p$。
*   **阻带**：$|G(e^{j\omega})| \le \delta_s$，截止频率 $\omega_s$。
* **峰值通带波纹：**

$$
\alpha_p = 20\log_{10}\left( \frac{|G(e^{j0})|}{|G(e^{j\omega_p})|} \right) = -20\log_{10}(1-\delta_p) \text{ dB}
$$


* **最小阻带衰减：**

$$
\alpha_s = 20\log_{10}\left( \frac{|G(e^{j0})|}{|G(e^{j\omega_s})|} \right) = -20\log_{10}\delta_s \text{ dB}
$$

### 3.2 Butterworth 滤波器
*   **特点**：通带和阻带内都是单调下降，无波纹（最大平坦）。
*   **幅度平方特性**：
    $$ |G(j\Omega)|^2 = \frac{1}{1+C^2\Omega^{2N}} $$
    （其中 $\Omega$ 为归一化频率）C是一个控制参数，用来确保设计的滤波器在通带截止频率处正好满足给定的衰减指标 $\alpha_p$ 。
。
*   **设计步骤**：
    1.  **频率归一化**：令 $\lambda = \Omega/\Omega_p$。则 $\lambda_p=1, \lambda_s = \Omega_s/\Omega_p$。
    2.  **确定阶数 $N$**：
        $$ \boxed{N = \frac{\lg(\frac{10^{\alpha_s/10}-1}{10^{\alpha_p/10}-1})}{2\lg(\lambda_s)}} $$
    3.  **确定截止频率**：$\Omega_c$ (3dB截止频率) 可由 $C$ 求得。$$ \boxed{C = \sqrt{10^{\alpha_p/10} - 1}} $$
    4.  **确定极点**：
        极点均匀分布在 S 平面左半平面的单位圆上，间隔为 $\pi/N$。
        $$ p_k = \exp\left( j \frac{2k+N-1}{2N}\pi \right), \quad k=1,2,\dots,N $$
    5.  **系统函数**：
        $$ G(p) = \frac{1}{\prod_{k=1}^{N}(p-p_k)} $$

### 3.3 Chebyshev 滤波器
*   **I型**：通带等波纹，阻带单调下降。同阶数下过渡带比 Butterworth 更窄。
    *   幅度平方特性：$|G(j\Omega)|^2 = \frac{1}{1+\varepsilon^2 C_N^2(\Omega)}$
*   **II型**：通带单调，阻带等波纹。
*   **椭圆滤波器**：通带阻带均为等波纹，过渡带最窄。

---

## 4. 模拟与数字之间的转换 (核心)
*目标：将模拟系统 $G(s)$ 转换为数字系统 $H(z)$。*

### 4.1 冲激响应不变法
*   **原理**：对模拟滤波器的冲激响应进行采样。
    $$ h[n] = T h(t)|_{t=nT} $$
*   **变换公式**：
    $$ \sum_{k=1}^{N} \frac{A_k}{s-s_k} \longrightarrow \sum_{k=1}^{N} \frac{A_k}{1-e^{s_k T}z^{-1}} $$
    *(注意：$H(z)$ 和 $G(s)$ 仅相差一个比例因子 $T$)*
    $$ z_k = e^{s_k T} $$
    模拟极点 $s_k$ 映射为数字极点 $e^{s_k T}$。
*   **缺点**：会产生<font color="orange">频谱混叠</font>。
*   **适用性**：仅适用于限带滤波器（如低通、带通），且高频衰减要快。

### 4.2 双线性变换法 (Bilinear Transformation)
*   **原理**：利用梯形积分近似微分方程。
*   **S域到Z域的映射**：
    $$ \boxed{s = \frac{2}{T} \frac{1-z^{-1}}{1+z^{-1}}} $$
*   **频率映射关系**（非线性，频率畸变）：
    $$ \Omega = \frac{2}{T} \tan\left(\frac{\omega}{2}\right) \quad \text{或} \quad \omega = 2 \arctan\left(\frac{\Omega T}{2}\right) $$
*   **优点**：
    1.  S 平面的 $j\Omega$ 轴一一映射到 Z 平面的单位圆。
    2.  无混叠现象。
    3.  稳定性保持（左半平面 $\to$ 单位圆内）。
*   **预畸 (Pre-warping)**：
    由于频率映射是非线性的，设计前需将数字频率指标 $\omega$ 转换为模拟频率指标 $\Omega$：
    $$ \Omega = \tan\left(\frac{\omega}{2}\right) \quad (\text{假设 } T=2) $$

---

## 5. 高通、带通和带阻 IIR 滤波器设计

主要有两种途径：
1.  **模拟域频率变换**：数字指标 $\to$ 模拟指标 $\to$ 模拟低通原型 $\to$ 模拟目标滤波器 (HP/BP/BS) $\to$ 数字滤波器。
2.  **数字域频谱变换**：数字指标 $\to$ 模拟指标 $\to$ 模拟低通 $\to$ 数字低通 $\to$ 数字目标滤波器。

### 5.1 模拟域频率变换法 (步骤)
1.  **预畸**：将数字频率 $\omega$ 转化为模拟频率 $\Omega$ (用正切公式)。
2.  **频率变换**：将目标模拟指标转换为**模拟低通原型**指标。
    *   **低通 $\to$ 高通**：$s = \frac{\Omega_p \hat{\Omega}_p}{\hat{s}}$
    *   **低通 $\to$ 带通**：$s = \Omega_p \frac{\hat{s}^2 + \hat{\Omega}_0^2}{\hat{s}(\hat{\Omega}_{p2} - \hat{\Omega}_{p1})}$ (保持带宽不变)
3.  **设计原型**：设计模拟低通滤波器 $H_{lp}(s)$。
4.  **逆变换**：将 $H_{lp}(s)$ 变换为目标模拟滤波器 $H_D(s)$。
5.  **双线性变换**：将 $H_D(s)$ 变换为数字滤波器 $H(z)$。
![[Pasted image 20251120091736.png]]
### 5.2 数字域频谱变换 (谱变换)
利用全通函数将 $z^{-1}$ 替换为 $F^{-1}(\hat{z})$ （必须是一个**全通函数**），将低通数字滤波器 $G_L(z)$ 转换为目标滤波器 $G_D(\hat{z})$。
表 9.1 数字低通滤波器谱变换表

| 滤波器类型 (Target Filter Type) | 谱变换公式 (Transformation $z^{-1} \to \dots$)                                                                                                                                               | 设计参数 (Design Parameters)                                                                                                                                                                                                                                                               |
| :------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **低通 (Lowpass)**           | $$z^{-1} = \frac{\hat{z}^{-1} - \lambda}{1 - \lambda \hat{z}^{-1}}$$                                                                                                                    | $$\lambda = \frac{\sin(\frac{\omega_c - \hat{\omega}_c}{2})}{\sin(\frac{\omega_c + \hat{\omega}_c}{2})}$$ <br> $\hat{\omega}_c$ 为期望的截止频率                                                                                                                                               |
| **高通 (Highpass)**          | $$z^{-1} = - \frac{\hat{z}^{-1} + \lambda}{1 + \lambda \hat{z}^{-1}}$$                                                                                                                  | $$\lambda = \frac{\cos(\frac{\omega_c + \hat{\omega}_c}{2})}{\cos(\frac{\omega_c - \hat{\omega}_c}{2})}$$ <br> $\hat{\omega}_c$ 为期望的截止频率                                                                                                                                               |
| **带通 (Bandpass)**          | $$z^{-1} = - \frac{\hat{z}^{-2} - \frac{2\lambda \rho}{\rho+1}\hat{z}^{-1} + \frac{1-\rho}{1+\rho}}{\frac{1-\rho}{1+\rho}\hat{z}^{-2} - \frac{2\lambda \rho}{\rho+1}\hat{z}^{-1} + 1}$$ | $$\lambda = \frac{\cos(\frac{\hat{\omega}_{c2} + \hat{\omega}_{c1}}{2})}{\cos(\frac{\hat{\omega}_{c2} - \hat{\omega}_{c1}}{2})}$$ <br> $$\rho = \cot(\frac{\hat{\omega}_{c2} - \hat{\omega}_{c1}}{2})\tan(\frac{\omega_c}{2})$$ <br> $\hat{\omega}_{c2}, \hat{\omega}_{c1}$ 为期望的上下截止频率 |
| **带阻 (Bandstop)**          | $$z^{-1} = \frac{\hat{z}^{-2} - \frac{2\lambda}{1+\rho}\hat{z}^{-1} + \frac{1-\rho}{1+\rho}}{\frac{1-\rho}{1+\rho}\hat{z}^{-2} - \frac{2\lambda}{1+\rho}\hat{z}^{-1} + 1}$$             | $$\lambda = \frac{\cos(\frac{\hat{\omega}_{c2} + \hat{\omega}_{c1}}{2})}{\cos(\frac{\hat{\omega}_{c2} - \hat{\omega}_{c1}}{2})}$$ <br> $$\rho = \tan(\frac{\hat{\omega}_{c2} - \hat{\omega}_{c1}}{2})\tan(\frac{\omega_c}{2})$$ <br> $\hat{\omega}_{c2}, \hat{\omega}_{c1}$ 为期望的上下截止频率 |

*   符号说明：
*   $\omega_c$：**原型**低通滤波器的截止频率。
*   $\hat{\omega}_c$：**目标**滤波器（变换后）的截止频率。
*   $\hat{\omega}_{c1}, \hat{\omega}_{c2}$：目标带通/带阻滤波器的**下截止频率**和**上截止频率**。
*   $\hat{z}$：新滤波器的复变量。

---

## 6. 典型设计示例

### 6.1 二阶带阻（陷波）数字滤波器设计
**目标**：设计陷波频率 $\omega_0$，3dB 带宽 $B_w$ 的滤波器。
**传输函数**：
$$ G(z) = \frac{1}{2} \frac{(1+\alpha) - 2\beta(1+\alpha)z^{-1} + (1+\alpha)z^{-2}}{1 - \beta(1+\alpha)z^{-1} + \alpha z^{-2}} $$
其中参数：
*   $\beta = \cos \omega_0$
*   $\alpha = \frac{1-\tan(B_w/2)}{1+\tan(B_w/2)}$

### 6.2 Matlab 设计流程 (Butterworth 低通)
1.  **确定指标**：$\omega_p, \omega_s, \alpha_p, \alpha_s$。
2.  **计算阶数和截止频率**：
    `[N, wn] = buttord(wp/pi, ws/pi, rp, rs, 's');` (注意加 's' 表示模拟域，或直接使用数字域指令但需注意预畸)。
    *通常做法是先手动或用代码预畸转为模拟指标。*
3.  **设计模拟滤波器**：
    `[num, den] = butter(N, wn, 's');`
4.  **双线性变换**：
    `[numz, denz] = bilinear(num, den, Fs);`

---

## 7. 学习总结与易错点

### 📝 总结
1.  IIR 滤波器设计主要依赖**模拟滤波器原型**（Butterworth 最常用）。
2.  **双线性变换法**是目前最主要的设计方法，其核心优势是无混叠，代价是频率轴的非线性压缩（通过**预畸**解决）。
3.  **最小相位系统**和**全通系统**的概念对于理解系统稳定性和相位校正至关重要。
4.  高通、带通、带阻滤波器可以通过**频率变换**由低通原型推导得出。

### ⚠️ 易错点 / 注意点
*   **频率单位**：注意区分模拟频率 $\Omega$ (rad/s) 和数字频率 $\omega$ (rad)。双线性变换中，如果不指定 $T$，通常假设 $T=2$ 或 $T=1$，此时 $\Omega = \tan(\omega/2)$ 或类似形式，计算时需保持一致。
*   **混叠问题**：冲激响应不变法会有混叠，**不能**用于设计高通或带阻滤波器（因为高频部分不为0）。双线性变换法无此限制。
*   **预畸方向**：是先将数字指标 $\omega$ 预畸为模拟指标 $\Omega$，在模拟域设计好 $H(s)$ 后，再通过双线性变换回到 $z$ 域。不要弄反了。
*   **稳定性**：设计模拟滤波器确定极点时，必须选择 S 平面**左半平面**的极点，以保证映射到 Z 平面后极点在单位圆内（稳定）。

## 附录1 推导 **Butterworth 滤波器阶数 $N$** 

#### 1. 从幅度平方函数出发
根据 **Slide 31**，归一化后的 Butterworth 滤波器幅度平方函数为：
$$ |G(j\lambda)|^2 = \frac{1}{1+C^2\lambda^{2N}} $$
其中 $\lambda$ 是归一化频率。

### 2. 利用衰减指标定义建立方程
根据 **Slide 27** 和 **Slide 31**，衰减（损耗）$\alpha$（单位：dB）与幅度平方函数的关系为：
$$ \alpha = -10 \log_{10} |G(j\lambda)|^2 $$
或者反过来写：
$$ |G(j\lambda)|^2 = 10^{-\alpha/10} = \frac{1}{10^{\alpha/10}} $$

将步骤 1 的公式代入：
$$ \frac{1}{1+C^2\lambda^{2N}} = \frac{1}{10^{\alpha/10}} $$
$$ 1+C^2\lambda^{2N} = 10^{\alpha/10} $$
移项得到核心关系式：
$$ \boxed{C^2\lambda^{2N} = 10^{\alpha/10} - 1} $$

### 3. 分别代入通带和阻带条件
我们需要同时满足通带和阻带的指标：

*   **在通带截止频率处** ($\lambda = \lambda_p = 1$, 衰减为 $\alpha_p$)：
    $$ C^2 \cdot (1)^{2N} = 10^{\alpha_p/10} - 1 $$
    即：
    $$ C^2 = 10^{\alpha_p/10} - 1 \quad \dots\dots \text{①} $$

*   **在阻带截止频率处** ($\lambda = \lambda_s$, 衰减为 $\alpha_s$)：
    $$ C^2 \cdot \lambda_s^{2N} = 10^{\alpha_s/10} - 1 \quad \dots\dots \text{②} $$

### 4. 联立方程求解 $N$
将方程 ② 除以方程 ①，消去常数 $C^2$：

$$ \frac{C^2 \lambda_s^{2N}}{C^2} = \frac{10^{\alpha_s/10} - 1}{10^{\alpha_p/10} - 1} $$

得到：
$$ \lambda_s^{2N} = \frac{10^{\alpha_s/10} - 1}{10^{\alpha_p/10} - 1} $$

### 5. 取对数解出 $N$
对等式两边取以 10 为底的对数 ($\lg$)：

$$ \lg(\lambda_s^{2N}) = \lg\left( \frac{10^{\alpha_s/10} - 1}{10^{\alpha_p/10} - 1} \right) $$

利用对数性质 $\lg(x^y) = y\lg(x)$，左边变为 $2N \lg(\lambda_s)$：

$$ 2N \lg(\lambda_s) = \lg\left( \frac{10^{\alpha_s/10} - 1}{10^{\alpha_p/10} - 1} \right) $$

最后移项，即可得到课件中的公式：

$$ \boxed{N = \frac{\lg(\frac{10^{\alpha_s/10}-1}{10^{\alpha_p/10}-1})}{2\lg(\lambda_s)}} $$

### 💡 总结
这个公式的物理意义是：**为了让滤波器的幅度响应从通带的衰减 ($\alpha_p$) 下降到阻带的衰减 ($\alpha_s$)，且频率跨度为 $\lambda_s$ (归一化)，所需的滤波器“陡峭程度”（即阶数 $N$）是多少。**

*   **分子**：代表了阻带衰减要求与通带衰减要求之间的“距离”。
*   **分母**：代表了过渡带的宽度（频率比的对数）。

## 附录2 双线性变换法数学推导

它的思路是：**用“梯形面积公式”来近似计算积分。**
### 第一步：从“积分”出发
$$ y(t) = \int_{0}^{t} x(\tau) d\tau \longrightarrow G(s) = \frac{1}{s} $$
*   **物理意义**：模拟电路中的“积分器”。输出 $y(t)$ 是输入 $x(t)$ 的累积面积。
*   **拉普拉斯域**：在 $s$ 域中，积分操作对应的是传递函数 **$\frac{1}{s}$**。
*   **目标**：我们要找到这个 $\frac{1}{s}$ 在数字域（$z$ 域）对应长什么样。

### 第二步：把积分切成两段
$$ y(nT) = \int_{0}^{(n-1)T} x(\tau) d\tau + \int_{(n-1)T}^{nT} x(\tau) d\tau $$
*   **离散化**：我们在时刻 $t = nT$ 进行观察。
*   **拆分**：当前的积分总和 $y(nT)$ = **之前的积分总和**（从0到上一个时刻） + **这一小段时间的新增积分**（从上一个时刻到现在的增量）。
*   **代换**：前面那一项 $\int_{0}^{(n-1)T}$ 其实就是上一时刻的输出 $y((n-1)T)$，也就是数字里的 $y[n-1]$。

### 第三步：梯形近似（最关键的一步！）
$$ \int_{(n-1)T}^{nT} x(\tau) d\tau \approx T \cdot \frac{x(nT) + x((n-1)T)}{2} $$
*   **问题**：这一小段积分（曲线下的面积）计算机算不出来，因为计算机只有离散的点，不知道点之间的曲线长啥样。
*   **解决**：用**梯形**来近似！
    *   底边长：采样间隔 $T$。
    *   两条高：现在的输入 $x(nT)$ 和 上一时刻的输入 $x((n-1)T)$。
    *   **梯形面积公式**：$（上底+下底）\times 高 / 2$。
*   这就是图片标题提到的“**应用梯形数值积分方法**”。

### 第四步：写出差分方程
$$ y[n] = y[n-1] + \frac{T}{2} \{ x[n] + x[n-1] \} $$
*   把第二步和第三步拼起来，就得到了数字系统的递推公式。
*   意思是：现在的输出 = 上一次的输出 + （这一次和上一次输入的平均值 $\times$ 时间 $T$）。

### 第五步：进行 Z 变换
$$ H(z) = \frac{T}{2} \left( \frac{1 + z^{-1}}{1 - z^{-1}} \right) $$
*   对上面的差分方程进行 Z 变换：
    *   $y[n] \to Y(z)$
    *   $y[n-1] \to z^{-1}Y(z)$ （延迟一拍）
    *   $x[n] \to X(z)$
    *   $x[n-1] \to z^{-1}X(z)$
*   整理方程 $Y(z) = z^{-1}Y(z) + \frac{T}{2}(X(z) + z^{-1}X(z))$，求出传递函数 $H(z) = \frac{Y(z)}{X(z)}$，就得到了这一行公式。

### 第六步：得出映射公式（最终结论）
$$ s = \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}} $$
*   **逻辑闭环**：
    *   在模拟域，积分器是 $\frac{1}{s}$。
    *   在数字域，我们刚推导出积分器近似于 $\frac{T}{2} \frac{1 + z^{-1}}{1 - z^{-1}}$。
    *   让它们相等：$\frac{1}{s} = \frac{T}{2} \frac{1 + z^{-1}}{1 - z^{-1}}$。
*   **求倒数**：把两边翻转过来，解出 $s$，就得到了双线性变换最著名的代换公式。

## 附录3 基于双线性变换法设计巴特沃斯低通数字滤波器例题

### 1. 规格参数 (Specifications)

题目给出的数字滤波器设计指标为：
*   通带截止频率： $\omega_p = 0.25\pi$
*   阻带截止频率： $\omega_s = 0.55\pi$
*   通带最大衰减： $\alpha_p \le 0.5 \text{ dB}$
*   阻带最小衰减： $\alpha_s = 15 \text{ dB}$

### 2. 频率预畸变 (Frequency Pre-warping)

使用双线性变换法，首先需要将数字频率 $\omega$ 转换为模拟频率 $\Omega$。使用公式 $\Omega = \tan(\frac{\omega}{2})$：

*   模拟通带频率：
    $$ \Omega_p = \tan\left(\frac{0.25\pi}{2}\right) = \tan(0.125\pi) \approx 0.4142 $$
*   模拟阻带频率：
    $$ \Omega_s = \tan\left(\frac{0.55\pi}{2}\right) = \tan(0.275\pi) \approx 1.1708 $$

### 3. 确定滤波器阶数 (Order Calculation)

巴特沃斯滤波器的阶数 $N$ 由以下公式确定：
$$ N \ge \frac{\log_{10}\left(\frac{10^{0.1\alpha_s}-1}{10^{0.1\alpha_p}-1}\right)}{2\log_{10}\left(\frac{\Omega_s}{\Omega_p}\right)} $$

代入数值计算：
1.  分子部分（衰减项）：
    $$ \frac{10^{1.5}-1}{10^{0.05}-1} = \frac{31.6228 - 1}{1.1220 - 1} = \frac{30.6228}{0.1220} \approx 251.006 $$
    $$ \log_{10}(251.006) \approx 2.3997 $$

2.  分母部分（频率比）：
    $$ \frac{\Omega_s}{\Omega_p} = \frac{1.1708}{0.4142} \approx 2.8266 $$
    $$ 2\log_{10}(2.8266) \approx 2 \times 0.4513 = 0.9026 $$

3.  计算 $N$：
    $$ N \ge \frac{2.3997}{0.9026} \approx 2.659 $$

由于阶数 $N$ 必须为整数，向上取整，得：
$$ N = 3 $$

### 4. 确定模拟 3dB 截止频率 (Cutoff Frequency)

为了满足通带指标，利用 $\Omega_p$ 计算 3dB 截止频率 $\Omega_c$：
$$ \Omega_c = \frac{\Omega_p}{(10^{0.1\alpha_p}-1)^{\frac{1}{2N}}} $$
$$ \Omega_c = \frac{0.4142}{(10^{0.05}-1)^{\frac{1}{6}}} = \frac{0.4142}{(0.122)^{\frac{1}{6}}} \approx \frac{0.4142}{0.7043} \approx 0.5881 $$

*(注：选择此 $\Omega_c$ 将严格满足通带指标，且阻带衰减会优于 15dB)*

### 5. 构造模拟低通滤波器 $H_a(s)$

对于 $N=3$ 的巴特沃斯滤波器，归一化极点位于单位圆上，角度间隔为 $60^\circ$ (即 $\pi/3$)。去归一化后的模拟传输函数形式为：
$$ H_a(s) = \frac{\Omega_c^3}{(s+\Omega_c)(s^2 + \Omega_c s + \Omega_c^2)} $$

代入 $\Omega_c = 0.5881$ ($\Omega_c^2 \approx 0.3459$, $\Omega_c^3 \approx 0.2034$)：
$$ H_a(s) = \frac{0.2034}{(s+0.5881)(s^2 + 0.5881s + 0.3459)} $$

为了方便进行双线性变换，我们将其分为两部分处理：一阶部分 $H_{a1}(s)$ 和二阶部分 $H_{a2}(s)$。
$$ H_{a1}(s) = \frac{0.5881}{s+0.5881}, \quad H_{a2}(s) = \frac{0.3459}{s^2 + 0.5881s + 0.3459} $$

### 6. 双线性变换 (Bilinear Transformation)

使用公式 $s = \frac{1-z^{-1}}{1+z^{-1}}$ 将 $H_a(s)$ 转换为 $H(z)$。

**部分 1：一阶节**
$$ H_1(z) = \frac{0.5881}{\frac{1-z^{-1}}{1+z^{-1}} + 0.5881} = \frac{0.5881(1+z^{-1})}{1.5881 - 0.4119z^{-1}} $$
归一化系数（除以 1.5881）：
$$ H_1(z) = \frac{0.3703(1+z^{-1})}{1 - 0.2594z^{-1}} $$

**部分 2：二阶节**
$$ H_2(z) = \frac{0.3459}{(\frac{1-z^{-1}}{1+z^{-1}})^2 + 0.5881(\frac{1-z^{-1}}{1+z^{-1}}) + 0.3459} $$
整理分母系数 $A(z) = a_0 + a_1 z^{-1} + a_2 z^{-2}$：
*   $a_0 = 1 + 0.5881 + 0.3459 = 1.934$
*   $a_1 = 2(0.3459 - 1) = -1.3082$
*   $a_2 = 1 - 0.5881 + 0.3459 = 0.7578$
分子变成 $0.3459(1+z^{-1})^2 = 0.3459(1 + 2z^{-1} + z^{-2})$。

归一化系数（除以 1.934）：
$$ H_2(z) = \frac{\frac{0.3459}{1.934}(1+2z^{-1}+z^{-2})}{1 - \frac{1.3082}{1.934}z^{-1} + \frac{0.7578}{1.934}z^{-2}} $$
$$ H_2(z) = \frac{0.1789(1+2z^{-1}+z^{-2})}{1 - 0.6764z^{-1} + 0.3918z^{-2}} $$

### 7. 最终数字滤波器系统函数

总传输函数 $H(z) = H_1(z) \cdot H_2(z)$。

总增益 $K = 0.3703 \times 0.1789 \approx 0.0662$。

$$ H(z) = \frac{0.0662 (1+z^{-1})^3}{(1 - 0.2594z^{-1})(1 - 0.6764z^{-1} + 0.3918z^{-2})} $$

如果需要展开成多项式形式：

**分子：**
$$ N(z) = 0.0662(1 + 3z^{-1} + 3z^{-2} + z^{-3}) $$

**分母：**
展开 $(1 - 0.2594z^{-1})(1 - 0.6764z^{-1} + 0.3918z^{-2})$：
$$ D(z) = 1 - 0.9358z^{-1} + 0.5673z^{-2} - 0.1016z^{-3} $$

**最终结果：**
$$ H(z) = \frac{0.0662 + 0.1986z^{-1} + 0.1986z^{-2} + 0.0662z^{-3}}{1 - 0.9358z^{-1} + 0.5673z^{-2} - 0.1016z^{-3}} $$

## 附录4 参数C
### 第一步：写出定义公式

1.  **巴特沃斯滤波器的幅度平方函数**：
    $$ |H(j\Omega)|^2 = \frac{1}{1 + \left(\frac{\Omega}{\Omega_c}\right)^{2N}} $$
    其中 $\Omega_c$ 是我们想要求的 3dB 截止频率。

2.  **衰减（分贝 dB）的定义**：
    在频率 $\Omega$ 处的衰减 $\alpha$ 定义为：
    $$ \alpha = -10 \lg |H(j\Omega)|^2 = 10 \lg \frac{1}{|H(j\Omega)|^2} $$

### 第二步：代入通带边界条件

我们知道在通带截止频率 $\Omega_p$ 处，衰减量刚好是 $\alpha_p$。
将 $\Omega = \Omega_p$ 代入上述两个公式：

$$ \alpha_p = 10 \lg \left( 1 + \left(\frac{\Omega_p}{\Omega_c}\right)^{2N} \right) $$

### 第三步：反解出 $\Omega_c$

我们需要从上面的方程中把 $\Omega_c$ 解出来：

1.  **两边除以 10**：
    $$ 0.1 \alpha_p = \lg \left( 1 + \left(\frac{\Omega_p}{\Omega_c}\right)^{2N} \right) $$

2.  **去掉对数（两边作为 10 的指数）**：
    $$ 10^{0.1 \alpha_p} = 1 + \left(\frac{\Omega_p}{\Omega_c}\right)^{2N} $$

3.  **移项**（把 1 移到左边）：
    $$ 10^{0.1 \alpha_p} - 1 = \left(\frac{\Omega_p}{\Omega_c}\right)^{2N} $$

4.  **两边开 2N 次方**（或者说两边取 $\frac{1}{2N}$ 次幂）：
    $$ \left( 10^{0.1 \alpha_p} - 1 \right)^{\frac{1}{2N}} = \frac{\Omega_p}{\Omega_c} $$

5.  **求倒数并整理**，得到 $\Omega_c$：
    $$ \Omega_c = \frac{\Omega_p}{\left( 10^{0.1 \alpha_p} - 1 \right)^{\frac{1}{2N}}} $$

这就是这个公式的来源。

---

### 额外的小知识：参数 $\epsilon$ (或 C)

在很多教材中（包括你图片里的），会将中间的一项简写为 $\epsilon^2$ 或 $C^2$：
$$ C^2 = 10^{0.1 \alpha_p} - 1 $$
这代表了通带边缘的**波纹起伏程度**。

如果你把这个代回公式，就变成了：
$$ \Omega_c = \frac{\Omega_p}{(C^2)^{\frac{1}{2N}}} = \frac{\Omega_p}{\sqrt[2N]{C^2}} $$

这正是上一问中我们讨论的那个核心公式。

## 附录5 模拟带通滤波器设计例题

根据题目给出的“变换原则”，我们需要确定低通原型滤波器的指标 $\Omega_p$ 和 $\Omega_s$。

### 解题思路

**原则解读：**
1.  **不改变通带宽度**：这意味着我们必须严格按照给定的带通通带边界 $\hat{\Omega}_{p1}$ 和 $\hat{\Omega}_{p2}$ 来确定变换参数（中心频率和带宽）。
2.  **调整阻带边界频率中的较小值**：这意味着由于给定的指标不是几何对称的（$\hat{\Omega}_{p1}\hat{\Omega}_{p2} \neq \hat{\Omega}_{s1}\hat{\Omega}_{s2}$），在映射到低通原型时，两个阻带边缘会得到不同的 $\Omega_s$。为了保证设计出的滤波器能同时满足两边的阻带要求，我们必须选择**较小**的那个 $\Omega_s$（即要求更严格的那个）。

### 详细计算步骤

#### 1. 确定变换参数
根据原则1，利用通带边界计算中心频率平方 $\hat{\Omega}_0^2$ 和带宽 $B_w$：

*   **几何中心频率平方**：
    $$ \hat{\Omega}_0^2 = \hat{\Omega}_{p1} \cdot \hat{\Omega}_{p2} = 0.8 \times 1.6 = 1.28 $$
*   **通带宽度**：
    $$ B_w = \hat{\Omega}_{p2} - \hat{\Omega}_{p1} = 1.6 - 0.8 = 0.8 $$

#### 2. 确定低通原型的通带截止频率 $\Omega_p$
通常将模拟低通原型的通带归一化为 1：
$$ \Omega_p = 1 $$

#### 3. 计算两个阻带边界映射后的频率 $\Omega$
利用题目给出的频率变换公式：
$$ \Omega = -\Omega_p \frac{\hat{\Omega}_0^2 - \hat{\Omega}^2}{\hat{\Omega} B_w} = -1 \cdot \frac{1.28 - \hat{\Omega}^2}{0.8 \hat{\Omega}} $$

分别代入两个阻带频率 $\hat{\Omega}_{s1}$ 和 $\hat{\Omega}_{s2}$：
![[Pasted image 20251120091645.png]]
*   **对于下阻带 $\hat{\Omega}_{s1} = 0.5$**：
    $$ \Omega_{s1} = - \frac{1.28 - 0.5^2}{0.8 \times 0.5} = - \frac{1.28 - 0.25}{0.4} = - \frac{1.03}{0.4} = -2.575 $$
    取绝对值：$|\Omega_{s1}| = 2.575$

*   **对于上阻带 $\hat{\Omega}_{s2} = 2.4$**：
    $$ \Omega_{s2} = - \frac{1.28 - 2.4^2}{0.8 \times 2.4} = - \frac{1.28 - 5.76}{1.92} = - \frac{-4.48}{1.92} \approx 2.333 $$
    取绝对值：$|\Omega_{s2}| = 2.333$

#### 4. 确定低通原型的阻带截止频率 $\Omega_s$
我们需要选择一个 $\Omega_s$，使得滤波器能覆盖所有的阻带要求。
*   如果选 2.575，则对应上阻带的要求 2.333 处（处于过渡带）无法满足衰减。
*   如果选 2.333，则对应下阻带的要求 2.575 处（处于更深的阻带）肯定满足衰减。

根据“调整阻带边界频率中的较小值”原则（也就是取绝对值后的最小值，以此保证所有条件都被满足）：
$$ \Omega_s = \min(|\Omega_{s1}|, |\Omega_{s2}|) = \min(2.575, 2.333) = 2.333 $$

### 最终结果

模拟低通滤波器原型的指标为：

$$ \Omega_p = 1 $$
$$ \Omega_s = 2.333 $$