---
title: 第九章 IIR数字滤波器设计
date: 2025-11-15T08:00:00+08:00
tags:
  - 大三上
  - 数字信号处理
summary: 本讲的核心是IIR数字滤波器的间接设计法。我们不直接在数字域进行设计，而是利用成熟的模拟滤波器理论作为桥梁。
---
#### 📜 本讲主要内容

*   **引言**：介绍IIR滤波器的基本概念、优缺点和设计思路。
*   **系统的全通分解与最小相位系统**：回顾相位校正的相关理论基础。
*   **IIR数字滤波器的设计流程**：阐述设计的总体步骤和框架。
*   **IIR模拟滤波器设计**：深入学习两种经典的模拟滤波器设计方法——巴特沃斯和切比雪夫。
*   **模拟和数字之间的转换**：介绍设计流程中的关键转换环节。
*   **其他类型滤波器设计**：简要提及高通、带通和带阻IIR数字滤波器的设计。

---

### 🧠 一、IIR滤波器设计前的思考

在开始设计之前，我们需要明确IIR滤波器的基本特性和设计挑战。

#### 1. 引言：什么是IIR滤波器？

IIR (Infinite Impulse Response) 滤波器，即<font color="orange">无限长冲激响应滤波器</font>，是一种极零点滤波器。
*   **特点**：系统函数同时包含零点和极点。
*   **反馈**：极点的存在意味着系统中存在<font color="orange">反馈</font>，这也是其冲激响应无限长的原因。

其差分方程和系统函数可以表示为：

*   **差分方程**：
   $\sum_{k=0}^{N} a_k y[n-k] = \sum_{k=0}^{M} b_k x[n-k]$
   
*   **系统函数**：
   $\boxed{H(z) = \frac{Y(z)}{X(z)} = \frac{\sum_{k=0}^{M} b_k z^{-k}}{\sum_{k=0}^{N} a_k z^{-k}}}$

#### 2. IIR滤波器的优缺点

✅ **主要优点**：
1.  **结构简单**：与实现相同性能指标的FIR滤波器相比，IIR滤波器的阶数更低，计算量更小。
2.  **易于级联**：高阶滤波器可以方便地由低阶滤波器级联实现。

❌ **主要缺点**：
1.  **不稳定性**：由于极点的存在，如果设计不当（极点位于单位圆外），系统可能会<font color="orange">不稳定</font>。
2.  **非线性相位**：很难实现严格的<font color="orange">线性相位</font>。

#### 3. IIR数字滤波器的设计思路

💡 **核心思想**：直接设计IIR数字滤波器比较困难，但模拟滤波器的设计理论非常成熟。因此，我们采用一种<font color="orange">间接</font>的设计方法。

1.  **借助模拟滤波器**：将数字滤波器的设计问题，通过某种变换，转化为模拟滤波器的设计问题。
2.  **设计流程**：
    *   将数字滤波器的技术指标 → 转换为模拟滤波器的技术指标。
    *   使用成熟的模拟滤波器设计方法（如巴特沃斯、切比雪夫）得到模拟滤波器。
    *   将设计好的模拟滤波器 → 转换回相应的数字滤波器。

#### 4. 为什么要回顾全通和最小相位系统？

通信系统对<font color="orange">相位失真</font>非常敏感，而IIR滤波器难以满足线性相位要求。为了解决这个问题，我们需要回顾相关概念。
*   **目标**：在不改变系统幅频响应的前提下，对相位进行校正，使其尽可能接近线性相位或常数相位。
*   **方法**：将一个IIR滤波器分解为一个<font color="orange">最小相位系统</font>和一个<font color="orange">全通系统</font>的级联，利用全通系统来调整相位。

---

### ⚙️ 二、系统的全通分解与最小相位系统

#### 1. 全通系统 (All-pass System)

*   **定义**：一个因果稳定的系统，其幅频响应在所有频率上都为常数（通常为1）。
   $|H_{ap}(e^{j\omega})| = 1, \quad 0 \le \omega < 2\pi$
*   **最简单的全通系统**：纯延迟环节$H_{ap}(z) = z^{-k}$。
*   **极零点关系**：一个全通系统的<font color="orange">极点</font>和<font color="orange">零点</font>关于单位圆呈<font color="orange">镜像对称</font>。如果$p_k$是一个极点，则$1/p_k^*$是一个零点。
*   **系统函数**：
   $\boxed{H_{ap}(z) = \pm \prod_{k=1}^{N} \frac{z^{-1}-\lambda_k^*}{1-\lambda_k z^{-1}}} \quad \text{其中 } |\lambda_k|<1$
*   **重要特性**：
    *   稳定的全通系统，所有极点在单位圆内，所有零点在单位圆外。
    *   相位响应单调递减。
    *   群时延恒大于0。

#### 2. 最小相位系统 (Minimum-Phase System)

*   **定义**：一个因果、稳定的系统，其<font color="orange">所有零点和极点</font>都在单位圆内部。
*   **相关概念**：
    *   **最大相位系统**：所有零点都在单位圆外。
    *   **混合相位系统**：零点在单位圆内外都有分布。

*   **重要性质**：
    1.  在所有具有相同幅频响应的系统中，最小相位系统具有<font color="orange">最小的相位延迟</font>和<font color="orange">最小的群时延</font>。
    2.  只有最小相位系统的<font color="orange">逆系统</font>才是因果稳定的，即物理可实现。关键在于：一个系统的零点，会成为其逆系统的极点。而一个离散时间系统要同时满足因果和稳定，其**所有极点必须全部位于单位圆内部**。
	
#### 3. 全通分解

*   **核心定理**：任何一个非最小相位的因果稳定系统$H(z)$，都可以分解为一个最小相位系统$H_{min}(z)$和一个全通系统$H_{ap}(z)$的级联。
   $\boxed{H(z) = H_{min}(z) H_{ap}(z)}$
*   **分解方法**：将原系统在单位圆外的零点$z_0$（$|z_0|>1$）翻转到单位圆内 ($1/z_0^*$)，并构造一个相应的全通环节来补偿幅度的变化。

---

### 📈 三、IIR数字滤波器设计流程

#### 1. 确定技术指标

设计一个滤波器，首先要明确其性能要求，通常对于低通滤波器，有四个核心指标：
![](Pastedimage20251115104146.png)
![](Pastedimage20251115105148.png)
*  $\omega_p$：通带截止频率
*  $\omega_s$：阻带截止频率
*  $\alpha_p$：通带最大衰减 (或峰值通带波纹)
*  $\alpha_s$：阻带最小衰减
*   **通带波纹 (dB)**:$\alpha_p = -20\log_{10}(1-\delta_p)$
*   **阻带衰减 (dB)**:$\alpha_s = -20\log_{10}(\delta_s)$

#### 2. 总体设计流程

以双线性变换法为例，整个流程如下所示：

1.  **数字化指标 → 模拟化指标**：将数字滤波器的指标 ($\omega_p, \omega_s, \alpha_p, \alpha_s$) 转换为模拟滤波器的指标 ($\Omega_p, \Omega_s, \alpha_p, \alpha_s$)。（例如通过$\Omega = g(\omega)$）
2.  **设计模拟滤波器**：根据模拟指标，选择一种逼近方法（如巴特沃斯、切比雪夫），设计出模拟滤波器原型$H_a(s)$。
3.  **模拟滤波器 → 数字滤波器**：将得到的$H_a(s)$通过变换（例如$s=f(z)$）转换为最终的数字滤波器$H(z)$。

---

### 🔌 四、IIR模拟滤波器设计

模拟滤波器设计的核心问题是：根据给定的技术指标，找到一个合适的系统函数$G(s)$。

#### 1. 设计核心

设计的关键是逼近理想的<font color="orange">幅度平方特性</font>$|G(j\Omega)|^2$。一旦确定了它，就可以通过以下关系求解$G(s)$：
$|G(j\Omega)|^2 = G(s)G(-s) \Big|_{s=j\Omega}$
从$G(s)G(-s)$的极点中，选择<font color="orange">左半平面</font>的极点分配给$G(s)$，即可保证系统的稳定性。

#### 2. 设计步骤

1.  **频率归一化**：将通带截止频率$\Omega_p$归一化为1，即$\lambda = \Omega / \Omega_p$。
2.  **确定参数**：根据技术指标和所选的逼近函数，确定滤波器的阶数$N$等参数。
3.  **求归一化系统函数 G(p)**：其中$p$是归一化的复变量，$p=s/\Omega_p$。
4.  **去归一化**：将$p$替换回$s/\Omega_p$，得到最终的系统函数$G(s)$。

#### 3. 巴特沃斯 (Butterworth) 滤波器

被称为<font color="orange">最平坦幅度</font>滤波器，其通带和阻带都是单调变化的。

*   **幅度平方特性**：
   $\boxed{|G(j\Omega)|^2 = \frac{1}{1 + C^2 \Omega^{2N}}}$
    其中，$N$是滤波器阶数，$C$是待定常数。

*   **阶数 N 和 C 的确定**：
   $\boxed{N \ge \frac{\log_{10}\left(\frac{10^{\alpha_s/10}-1}{10^{\alpha_p/10}-1}\right)}{2\log_{10}(\frac{\Omega_s}{\Omega_p})}}$
   $\boxed{C^2 = 10^{\alpha_p/10}-1}$(当$\Omega_p$为3dB截止频率时，C=1)

*   **极点分布**：$G(p)G(-p)$的$2N$个极点均匀分布在复平面上一个半径为$1/C^{1/N}$的圆上。为了保证稳定性，$G(p)$的极点取该圆上位于<font color="orange">左半平面</font>的$N$个极点。
*   **特点**：响应曲线平滑，但过渡带较宽。阶数$N$越大，过渡带越窄。

#### 4. 切比雪夫 (Chebyshev) 滤波器

相比巴特沃斯滤波器，在阶数相同的情况下，切比雪夫滤波器具有<font color="orange">更窄的过渡带</font>。

*   **I 型切比雪夫滤波器**：
    *   **特点**：通带<font color="orange">等波纹</font>，阻带单调下降。
    *   **幅度平方特性**：
       $\boxed{|G(j\Omega)|^2 = \frac{1}{1 + \epsilon^2 C_n^2(\Omega)}}$
        其中，$C_n(\Omega)$是n阶切比雪夫多项式，$\epsilon$与通带波纹有关。
    *   **极点分布**：$G(p)$的极点分布在一个<font color="orange">椭圆</font>上。
    *   **注意点**：以牺牲通带平坦性为代价，换取了更陡峭的过渡特性。

*   **II 型切比雪夫滤波器** (反切比雪夫):
    *   **特点**：通带单调，阻带<font color="orange">等波纹</font>。

#### 5. 椭圆滤波器 (Elliptic Filter)

*   **特点**：通带和阻带都是<font color="orange">等波纹</font>的。
*   **优势**：在所有阶数相同的滤波器中，具有最窄的过渡带。
*   **复杂度**：设计最为复杂，系统函数同时包含零点和极点。

---

### 📝 本章学习总结

1.  **核心思想**：本讲的核心是IIR数字滤波器的<font color="orange">间接设计法</font>。我们不直接在数字域进行设计，而是利用成熟的模拟滤波器理论作为桥梁。
2.  **设计流程**：整个设计过程可以概括为 **“数字指标 → 模拟指标 → 模拟原型设计 → 模拟转数字”**。
3.  **相位问题**：IIR滤波器天然存在非线性相位问题，可以通过<font color="orange">全通分解</font>，将其表示为最小相位系统和全通系统的级联，从而为相位校正提供了理论基础。
4.  **模拟滤波器类型**：
    *   **巴特沃斯**：最平坦幅度，设计简单，过渡带较宽。
    *   **切比雪夫I型**：通带等波纹，过渡带比巴特沃斯窄。
    *   **椭圆**：通带、阻带均等波纹，过渡带最窄，设计最复杂。
5.  **关键步骤**：模拟滤波器设计的关键在于根据指标求解其<font color="orange">幅度平方函数</font>，并从中求解出稳定的系统函数$G(s)$。

本讲主要集中在流程和模拟滤波器的设计上，下一部分将重点讨论模拟与数字之间的转换方法。

---

### 🚀 一、双线性变换法是什么？

简单来说，双线性变换法是一种**数学工具**，它充当了**模拟世界**（连续时间，$s$域）和**数字世界**（离散时间，$z$域）之间的**桥梁**或**翻译器**。

它的核心作用是将一个已知的模拟滤波器系统函数 $H_a(s)$，通过一个简单的代数替换，直接转换成一个数字滤波器的系统函数 $H(z)$。

### 🤔 二、为什么需要它？

正如之前的笔记中提到的，IIR数字滤波器的设计思路是“借用”成熟的模拟滤波器设计理论。这个过程需要两个关键的转换：

1.  **指标转换**：将数字频率指标转换为模拟频率指标。
2.  **系统转换**：将设计好的模拟滤波器 $H_a(s)$ 转换回数字滤波器 $H(z)$。

**双线性变换法就是实现第二步——系统转换——的最常用和最有效的方法。**

### 🧠 三、核心思想与数学公式

双线性变换法的思想来源于用**数值积分**来近似模拟系统中的积分运算。具体来说，它使用了**梯形法则 (Trapezoidal Rule)** 来近似积分。

推导过程如下：
1.  在$s$域中，$1/s$ 代表积分。
2.  在离散时间域中，对信号$x(n)$的积分可以用梯形法则来近似：
    $y[n] = y[n-1] + \frac{T}{2}(x[n] + x[n-1])$
    其中，$T$是采样周期。
3.  对上式进行Z变换，可以得到离散时间积分器的传递函数：
    $H(z) = \frac{Y(z)}{X(z)} = \frac{T}{2} \frac{1+z^{-1}}{1-z^{-1}}$
4.  让模拟积分器 $H_a(s)=1/s$ 和数字积分器 $H(z)$ 相等，我们就能得到$s$和$z$之间的关系：
    $\frac{1}{s} = \frac{T}{2} \frac{1+z^{-1}}{1-z^{-1}}$
5.  整理后，得到最终的双线性变换公式：

    $\boxed{s = \frac{2}{T}\frac{1-z^{-1}}{1+z^{-1}}}$

这个公式就是双线性变换法的**核心**。设计过程就是简单地将模拟滤波器 $H_a(s)$ 中的每一个 $s$ 都用这个关于 $z$ 的表达式替换掉。

*注意：在很多理论推导中，为了简化，会假设 $T=2$，此时公式变为 $s = \frac{1-z^{-1}}{1+z^{-1}}$。*

### 🌟 四、关键特性：频率映射与频率畸变

当我们将模拟滤波器转换为数字滤波器时，最关心的是频率响应是如何变化的。

通过令 $s=j\Omega$ (模拟频率) 和 $z=e^{j\omega}$ (数字频率)，我们可以得到模拟角频率 $\Omega$ 和数字角频率 $\omega$ 之间的映射关系：

$\boxed{\Omega = \frac{2}{T}\tan\left(\frac{\omega}{2}\right)}$

这个关系揭示了双线性变换法最重要的特性：

1.  **非线性映射 (Non-linear Mapping)**：$\Omega$ 和 $\omega$ 之间的关系是**非线性**的，通过一个 `tan` 函数关联。这意味着模拟频率轴被“**弯曲**”或“**压缩**”后映射到了数字频率轴上。这个现象被称为**频率畸变 (Frequency Warping)**。



2.  **无混叠 (No Aliasing)**：整个无限长的模拟频率轴 ($-\infty < \Omega < +\infty$) 被**一对一**地映射到了一个有限的数字频率区间 ($-\pi/T < \omega < \pi/T$)。这意味着**不会发生频率混叠**，这是它相比于冲激响应不变法等其他方法的最大优势。

3.  **稳定性保持 (Stability Preservation)**：双线性变换能将稳定的模拟滤波器（所有极点在$s$平面的左半边）精确地映射为稳定的数字滤波器（所有极点在$z$平面的单位圆内部）。这是一个非常宝贵的性质。

### 🔧 五、如何应对频率畸变？—— 预畸变 (Pre-warping)

既然频率畸变是不可避免的，我们该怎么办呢？答案是**提前补偿**。

这个过程被称为**预畸变 (Pre-warping)**。具体做法是：
在设计模拟滤波器**之前**，我们先将我们期望的**数字**截止频率（例如 $\omega_p, \omega_s$）通过上面的映射公式**反向计算**出对应的**模拟**截止频率，然后用这些“预先畸变”过的模拟频率来设计模拟滤波器。

**预畸变公式**：
$\Omega_p = \frac{2}{T}\tan\left(\frac{\omega_p}{2}\right)$
$\Omega_s = \frac{2}{T}\tan\left(\frac{\omega_s}{2}\right)$

这样一来，当最后我们应用双线性变换时，频率畸变会把我们预先设置的模拟频率点“恰好”地变回到我们最初想要的数字频率点上，从而得到精确的截止频率。

### 📋 六、总结：双线性变换法的优缺点与设计步骤

#### 优点 👍
*   **无频率混叠**。
*   **保持系统稳定性**。
*   转换过程是简单的**代数替换**，非常方便。

#### 缺点 👎
*   **频率畸变**，导致频率响应的形状发生改变。不过可以通过预畸变来精确控制关键频率点。
*   它只对**幅度响应**进行变换，相位响应也会相应地被畸变。

#### 完整设计步骤
1.  **确定数字滤波器指标**：$\omega_p, \omega_s, \alpha_p, \alpha_s$。
2.  **预畸变**：使用公式 $\Omega = \frac{2}{T}\tan(\frac{\omega}{2})$ 将数字频率指标 $\omega_p, \omega_s$ 转换为模拟频率指标 $\Omega_p, \Omega_s$。
3.  **设计模拟滤波器**：使用 $\Omega_p, \Omega_s, \alpha_p, \alpha_s$ 设计出模拟滤波器原型 $H_a(s)$（例如，使用巴特沃斯或切比雪夫方法）。
4.  **应用双线性变换**：将 $H_a(s)$ 中的 $s$ 替换为 $\frac{2}{T}\frac{1-z^{-1}}{1+z^{-1}}$。
5.  **化简**：整理代数表达式，得到最终的数字滤波器系统函数 $H(z)$。