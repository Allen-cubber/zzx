---
title: 第十章 FIR数字滤波器设计
tags:
  - 大三上
  - 数字信号处理
date: 2025-11-26T08:00:00+08:00
summary: 学习设计FIR数字滤波器的方法，以及窗函数的设计。
---
## 一、 概述及基础知识

### 1. FIR 滤波器的特点
与IIR滤波器相比，FIR滤波器具有以下显著特点：
*   **稳定性**：FIR滤波器总是稳定的（系统函数极点都在原点）。
*   **线性相位**：FIR滤波器很容易设计成严格的 <font color="orange">线性相位</font>。
*   **设计独立性**：不需要借助模拟滤波器来进行设计。
*   **阶数**：在同等性能指标下，FIR滤波器的阶数通常 <font color="orange">大于</font> IIR滤波器。

### 2. 线性相位FIR滤波器的类型
线性相位要求单位脉冲响应 $h[n]$ 满足对称或反对称条件：
*   **I型**：$h[n]$ 对称，长度 $N$ 为奇数（阶数为偶数）。
*   **II型**：$h[n]$ 对称，长度 $N$ 为偶数（阶数为奇数）。
*   **III型**：$h[n]$ 反对称，长度 $N$ 为奇数。
*   **IV型**：$h[n]$ 反对称，长度 $N$ 为偶数。

---

## 二、 FIR滤波器的设计思想

### 1. 逼近理想滤波器
理想滤波器（如理想低通）的频率响应 $H_d(e^{j\omega})$ 对应的时域冲击响应 $h_d[n]$ 通常是 **非因果** 且 **无限长** 的。
例如，理想低通滤波器的冲击响应为：
$$
h_{LP}[n] = \frac{\sin(\omega_c n)}{\pi n}, \quad -\infty < n < +\infty
$$
为了实现它，必须进行两步操作：
1.  **截短**：将无限长序列变为有限长。
2.  **移位**：将非因果序列变为因果序列。

### 2. 逼近准则
*   **最小积分平方误差准则**：
    在频域总误差能量最小。根据Parseval定理，这意味着在时域直接截取 $h_d[n]$ （即加矩形窗）可以得到最小的均方误差。
    $$
    \Phi = \frac{1}{2\pi} \int_{-\pi}^{\pi} |H_t(e^{j\omega}) - H_d(e^{j\omega})|^2 d\omega
    $$
*   **一致逼近准则**：
    使频域内误差的最大值最小化（Minimax），通常对应于等波纹设计（如切比雪夫逼近）。

---

## 三、 窗函数法设计 (Window Method)

### 1. 理论依据
将无限长的理想冲击响应 $h_d[n]$ 乘以一个有限长的窗函数 $w[n]$：
$$\boxed{h_t[n] = h_d[n] \cdot w[n]}$$
在频域上，这相当于理想频率响应 $H_d(e^{j\omega})$ 与窗函数频谱 $W(e^{j\omega})$ 进行 **卷积**：
$$
H_t(e^{j\omega}) = H_d(e^{j\omega}) \otimes W(e^{j\omega})
$$

### 2. Gibbs 现象 (吉布斯现象)
*   **定义**：对理想滤波器的冲击响应进行直接截短（加矩形窗），在频域通带和阻带交界处（不连续点）会出现振荡。
*   **特点**：
    1.  随着滤波器长度 $N$ 增加，波纹的数量增加，宽度变窄。
    2.  <font color="orange">最大波纹的高度保持不变</font>（约等于跳变值的9%~11%），不随 $N$ 增大而减小。
*   **原因**：无限长序列与有限长窗函数的卷积，实际上是频谱的扩展（泄漏）。
*   **解决方法**：使用时域两端平滑过渡的窗函数（渐变窗）代替矩形窗，可以减小旁瓣高度，但会以增加 <font color="orange">主瓣宽度</font>（即增加过渡带宽度）为代价。

### 3. 常用固定窗函数及其特性
设计时需根据阻带最小衰减选择窗类型，根据过渡带宽度计算窗长度 $N$（或参数 $M$）。

| 窗类型                   | 主瓣宽度           | 过渡带宽度近似 ($\Delta\omega$) | 最小阻带衰减 |
| :-------------------- | :------------- | :----------------------- | :----- |
| **矩形窗 (Rectangular)** | $4\pi/(2M+1)$  | $0.92\pi/M$              | -21 dB |
| **汉宁窗 (Hanning)**     | $8\pi/(2M+1)$  | $3.11\pi/M$              | -44 dB |
| **汉明窗 (Hamming)**     | $8\pi/(2M+1)$  | $3.32\pi/M$              | -53 dB |
| **布莱克曼窗 (Blackman)**  | $12\pi/(2M+1)$ | $5.56\pi/M$              | -74 dB |

> *注：表中 $N = 2M + 1$ 为滤波器长度。*

### 4. 窗函数的性能指标矛盾
*   **主瓣宽度**：决定了滤波器的 <font color="orange">过渡带宽度</font>。主瓣越窄，过渡带越陡峭。
*   **旁瓣电平**：决定了滤波器的 <font color="orange">阻带衰减</font> 和通带波纹。旁瓣越低，阻带衰减越大。
*   **矛盾**：通常减小旁瓣会通过增加主瓣宽度来实现。

---

## 四、 FIR滤波器设计步骤

1.  **确定性能指标**：
    确定通带截止频率 $\omega_p$、阻带截止频率 $\omega_s$、通带波纹 $\delta_p$、阻带衰减 $\alpha_s$。
2.  **选择窗函数**：
    根据 <font color="orange">最小阻带衰减</font> 要求，查表选择合适的窗函数 $w[n]$。
    *   例如：若要求阻带衰减 $\ge 40dB$，则矩形窗(-21dB)不满足，需选汉宁窗(-44dB)或更高阶窗。
3.  **计算滤波器长度**：
    根据 <font color="orange">过渡带宽度</font> $\Delta\omega = |\omega_s - \omega_p|$ 和所选窗的特性公式计算 $M$ 或 $N$。
    $$
    M \approx \frac{C \cdot \pi}{\Delta\omega} \quad (C为窗函数对应的系数，如汉宁窗C=3.11)
    $$
    
| 窗类型                   | 对应的 C 值  |
| --------------------- | -------- |
| **矩形窗 (Rectangular)** | **0.92** |
| **汉宁窗 (Hanning)**     | **3.11** |
| **汉明窗 (Hamming)**     | **3.32** |
| **布莱克曼窗 (Blackman)**  | **5.56** |
	滤波器长度 $N = 2M + 1$（通常取奇数以保证I型线性相位）。
4.  **计算理想冲击响应 $h_d[n]$**：
    截止频率取通带和阻带的中心：
    $$\boxed{\omega_c = \frac{\omega_p + \omega_s}{2}}$$
    计算对应的 $h_d[n]$（如低通、高通等公式）。
5.  **加窗**：
    $$
    h_t[n] = h_d[n] \cdot w[n], \quad -M \le n \le M
    $$
6.  **时延 (Causality)**：
    将 $h_t[n]$ 向右平移 $M$ 个单位，得到因果的滤波器系数：
    $$\boxed{h[n] = h_t[n-M] = h_d[n-M]w[n-M], \quad 0 \le n \le 2M}$$
7.  **验证**：检查设计结果是否满足所有指标。

---

## 五、 典型理想滤波器冲击响应公式

在公式中，截止频率均为 $\omega_c$。

1.  **理想低通 (Low Pass)**:
    $$
    h_{LP}[n] = \frac{\sin(\omega_c n)}{\pi n}
    $$
    ($n=0$ 时，值为 $\omega_c/\pi$)

2.  **理想高通 (High Pass)**:
    $$
    h_{HP}[n] = \delta[n] - h_{LP}[n] = \frac{\sin(\pi n) - \sin(\omega_c n)}{\pi n}
    $$
    即：
    $$
    h_{HP}[n] = \begin{cases} 1 - \frac{\omega_c}{\pi}, & n=0 \\ -\frac{\sin(\omega_c n)}{\pi n}, & n \ne 0 \end{cases}
    $$

3.  **理想带通 (Band Pass)** (截止频率 $\omega_{c1}, \omega_{c2}$):
    $$
    h_{BP}[n] = \frac{\sin(\omega_{c2} n)}{\pi n} - \frac{\sin(\omega_{c1} n)}{\pi n}
    $$

---

## 六、 设计实例分析

### 例1：低通滤波器设计
**指标**：通带截止 $\omega_p=0.2\pi$，阻带截止 $\omega_s=0.3\pi$，阻带衰减 $50dB$。
1.  **选窗**：阻带衰减 $50dB > 44dB$ (汉宁)，故需选择 **汉明窗 (Hamming)** 或 布莱克曼窗。若选汉明窗(-53dB)。
2.  **计算长度**：
    $\Delta\omega = 0.3\pi - 0.2\pi = 0.1\pi$。
    对于汉明窗，$\Delta\omega = 6.64\pi/N$ (近似 $3.32\pi/M$)。
    $M \ge \frac{3.32\pi}{0.1\pi} = 33.2$，取 $M=34$。
    长度 $N = 2M+1 = 69$。
3.  **截止频率**：$\omega_c = (0.2\pi+0.3\pi)/2 = 0.25\pi$。
4.  **生成**：$h[n] = \frac{\sin(0.25\pi (n-34))}{\pi (n-34)} \cdot w_{hamming}[n-34]$。

### 例2：高通滤波器设计
**指标**：$\omega_p = 0.7\pi, \omega_s = 0.6\pi, \delta_p=\delta_s=0.01$。
1.  **确定衰减**：衰减 = $-20\log_{10}(0.01) = 40dB$。
2.  **选窗**：40dB < 44dB，选择 **汉宁窗 (Hanning)**。
3.  **计算参数**：
    $\Delta\omega = 0.7\pi - 0.6\pi = 0.1\pi$。
    查表汉宁窗过渡带：$3.11\pi/M = 0.1\pi \Rightarrow M = 31.1$。
    取 $M=32$ (需注意高通滤波器通常要求长度为奇数，即 $N=2M+1$ 为奇数)。
    长度 $N = 2 \times 32 + 1 = 65$。
4.  **截止频率**：$\omega_c = (0.6\pi + 0.7\pi)/2 = 0.65\pi$。
5.  **计算公式**：
    $$
    h[n] = h_d[n-32]w[n-32]
    $$
    其中 $h_d[n]$ 为理想高通冲击响应。

> **易错提示**：线性相位FIR高通滤波器长度必须是奇数（即阶数是偶数，I型），不能使用偶数长度（II型），因为II型在 $\pi$ 处频率响应为0，无法作为高通。

---

## 七、 总结：IIR 与 FIR 滤波器对比

| 特性       | FIR 滤波器                             | IIR 滤波器      |
| :------- | :---------------------------------- | :----------- |
| **稳定性**  | 总是稳定 (无反馈)                          | 可能不稳定 (有反馈)  |
| **相位特性** | 严格 <font color="orange">线性相位</font> | 相位非线性        |
| **阶数**   | 较高 (计算量大)                           | 较低 (效率高)     |
| **设计方法** | 窗函数法、频率抽样法                          | 模拟滤波器映射、直接设计 |
| **实现结构** | 非递归                                 | 递归           |
| **误差影响** | 无累积误差                               | 可能有极限环振荡     |

---

## 八、 本章学习总结

1.  **核心目标**：设计一个有限长因果序列 $h[n]$ 来逼近理想的频率响应。
2.  **关键步骤**：
    *   **算带宽** ($\Delta\omega$) 和 **看衰减** (dB)。
    *   **查表** 定窗函数类型和长度 $M$。
    *   **套公式** 写出 $h_d[n]$ 并加窗移位。
3.  **难点理解**：
    *   Gibbs现象不仅由截断引起，且无法通过增加长度完全消除，只能通过窗形状改善。
    *   $N$ (长度) 和 $M$ (中心点/半长度) 的关系，$N=2M+1$。
    *   模拟角频率与数字角频率的转换：$\omega = \Omega T$。