---
title: 第六章 Z变换
tags:
  - 大三上
  - 数字信号处理
date: 2025-09-30T10:00:00+08:00
summary: 本章我们学习了Z变换，它是分析离散时间信号与系统的强大工具。
---
### 📜 本讲主要内容

*   **Z变换基本概念** 🧐
*   **有理Z变换** 🧠
*   **有理Z变换收敛域** 🗺️
*   **逆Z变换** ↩️
*   **Z变换的性质** ✨
*   **利用z变换分析和表征LTI系统** 🔬
    *   LTI系统的<font color="orange">传输函数</font>（系统函数）

---

## 一、概念和性质 💡

### 🤔 什么是Z变换？

1.  **核心地位**：Z变换是分析和综合<font color="orange">离散时间信号</font>与<font color="orange">离散时间系统</font>的重要工具。
2.  **类比关系**：Z变换在离散时间域的地位，就如同<font color="orange">拉普拉斯变换</font>在连续时间域的地位。它们在基本思想、性质和分析方法上有很多相似之处。

### 📝 Z变换的定义

对于一个离散时间序列 $x[n]$，其Z变换 $X(z)$ 定义为：

$$
\boxed{X(z) = Z\{x[n]\} = \sum_{n=-\infty}^{\infty} x[n]z^{-n}}
$$

其中，$z$ 是一个连续的复变量，可以表示为极坐标形式：$z = re^{j\omega}$。

#### Z变换与离散时间傅里叶变换(DTFT)的关系

*   当复变量 $z$ 的模 $r=1$ 时，即 $z = e^{j\omega}$，Z变换就变成了离散时间傅立叶变换(DTFT)。
*   💡 **核心思想**：<font color="orange">**DTFT可以看作是在Z平面的单位圆上进行的Z变换**</font>。
*   Z变换可以看作是在DTFT的基础上乘以了一个指数加权序列 $r^{-n}$，因此Z变换是DTFT的推广。

$$
X(re^{j\omega}) \= \sum_{n\=\-\infty}^{\infty} x\[n\]\(re^\{j\omega\}\)\^{-n} = \sum_{n=-\infty}^{\infty} (x[n]r^{-n})e^{-j\omega n} = F\{x[n]r^{-n}\}
$$

### 🗺️ Z变换的收敛域 (ROC)

<font color="orange">**收敛域 (Region of Convergence, ROC)**</font> 是指能够使Z变换级数求和收敛的所有复变量 $z$ 的值的集合。

**收敛条件**：
$$
\sum_{n=-\infty}^{\infty} |x[n]z^{-n}| = \sum_{n=-\infty}^{\infty} |x[n]|r^{-n} < \infty
$$

*   收敛域的形状通常是Z平面上的一个<font color="orange">**环形区域**</font>，因为它只与 $z$ 的模 $|z|=r$ 有关。
*   并非所有序列的Z变换都存在。
*   若ROC包含<font color="orange">单位圆</font> ($|z|=1$)，则该序列的DTFT存在。

⚠️ **注意点**：一个Z变换的代数表达式可以对应多个不同的时间序列，必须<font color="orange">**指定收敛域ROC**</font>才能唯一确定一个序列。

#### 例题1: 右边序列的Z变换
求右边序列 $x[n] = \alpha^n u[n]$ (其中 $n \ge 0$) 的Z变换。

**解**：
$$
\begin{aligned}
X(z) &= \sum_{n=-\infty}^{\infty} \alpha^n u[n] z^{-n} \\
&= \sum_{n=0}^{\infty} (\alpha z^{-1})^n
\end{aligned}
$$
这是一个等比数列求和，为了使其收敛，公比的绝对值必须小于1，即 $|\alpha z^{-1}| < 1$。
由此得到收敛域为 $|z| > |\alpha|$。
当收敛时，
$$
X(z) = \frac{1}{1 - \alpha z^{-1}}
$$
所以，Z变换对为：
$$
\alpha^n u[n] \quad \Leftrightarrow \quad \frac{1}{1 - \alpha z^{-1}}, \quad |z| > |\alpha|
$$
其ROC是一个以原点为中心，半径为 $|\alpha|$ 的圆外部的区域。



#### 例题2: 左边序列的Z变换
求左边序列 $x[n] = -\alpha^n u[-n-1]$ (其中 $n < 0$) 的Z变换。

**解**：
令 $m = -n$，则 $n=-m$。
$$
\begin{aligned}
X(z) &= \sum_{n=-\infty}^{-1} -\alpha^n z^{-n} \\
&= -\sum_{m=1}^{\infty} \alpha^{-m} z^{m} = -\sum_{m=1}^{\infty} (\alpha^{-1}z)^m \\
&= 1 - \sum_{m=0}^{\infty} (\alpha^{-1}z)^m
\end{aligned}
$$
为了使其收敛，公比的绝对值必须小于1，即 $|\alpha^{-1}z| < 1$。
由此得到收敛域为 $|z| < |\alpha|$。
当收敛时，
$$
X(z) = 1 - \frac{1}{1-\alpha^{-1}z} = \frac{-\alpha^{-1}z}{1-\alpha^{-1}z} = \frac{1}{1 - \alpha z^{-1}}
$$
所以，Z变换对为：
$$
-\alpha^n u[-n-1] \quad \Leftrightarrow \quad \frac{1}{1 - \alpha z^{-1}}, \quad |z| < |\alpha|
$$
其ROC是一个以原点为中心，半径为 $|\alpha|$ 的圆内部的区域。



🚨 **易错点**:
从例1和例2可以看出，两个完全不同的序列可以有完全相同的Z变换代数表达式。区分它们的唯一方法就是<font color="orange">**收敛域ROC**</font>。**Z变换表达式 + ROC = 唯一对应序列**。

#### 例题3: ROC决定唯一序列
已知 $X(z) = \frac{z}{(z-1)(z-2)}$，求不同ROC下的 $x[n]$。
**解**：
首先对 $X(z)$ 进行部分分式展开（这里以 $z^{-1}$ 的形式展开更方便）：
$$
X(z) = \frac{1}{(1-z^{-1})(1-2z^{-1})} = \frac{-1}{1-z^{-1}} + \frac{2}{1-2z^{-1}}
$$
根据不同的ROC，可以得到三种不同的 $x[n]$：
1.  **ROC: $|z| > 2$** (右边序列)
    两项都是右边序列，所以 $x[n] = -u[n] + 2 \cdot (2^n u[n]) = (-1 + 2^{n+1})u[n]$。
2.  **ROC: $|z| < 1$** (左边序列)
    两项都是左边序列，所以 $x[n] = -(-(1)^n u[-n-1]) + 2(-(2)^n u[-n-1]) = u[-n-1] - 2^{n+1}u[-n-1]$。
3.  **ROC: $1 < |z| < 2$** (双边序列)
    第一项是右边序列，第二项是左边序列。$x[n] = -u[n] - 2 \cdot (2^n u[-n-1]) = -u[n] - 2^{n+1}u[-n-1]$。

---

## 二、有理Z变换 📈

在实际的LTI系统中，系统函数 $H(z)$ 通常是复变量 $z$ 的<font color="orange">**有理函数**</font>，即两个关于 $z$ (或 $z^{-1}$) 的多项式之比。

$$
G(z) = \frac{P(z)}{D(z)} = \frac{p_0 + p_1z^{-1} + \dots + p_Mz^{-M}}{d_0 + d_1z^{-1} + \dots + d_Nz^{-N}}
$$

### 🌟 零点和极点

通过对分子和分母多项式进行因式分解，我们可以得到：

$$
G(z) = z^{N-M} \frac{p_0}{d_0} \frac{\prod_{l=1}^{M}(z-\xi_l)}{\prod_{l=1}^{N}(z-\lambda_l)}
$$

*   **零点 (Zeros)**：使 $G(z) = 0$ 的 $z$ 值，即分子多项式的根 $\xi_l$。在零点处，系统响应为零。
*   **极点 (Poles)**：使 $G(z) \to \infty$ 的 $z$ 值，即分母多项式的根 $\lambda_l$。在极点处，系统响应趋于无穷。

<font color="orange">**零极点图 (Pole-Zero Plot)**</font> 是在复Z平面上表示出所有零点(用 `○` 表示)和极点(用 `×` 表示)的图形。它直观地展示了系统的特性。

#### 零极点图示例
对于 $H(z) = \frac{1+ \frac{1}{4}z^{-1}}{1- \frac{1}{2}z^{-1}} = \frac{z+1/4}{z-1/2}$，且ROC为 $|z|>1/2$ (右边序列)。
*   零点在 $z = -1/4$
*   极点在 $z = 1/2$



## 三、有理Z变换的收敛域 🗺️

有理Z变换的ROC具有以下重要性质，它们与极点的位置密切相关：

1.  **有限长序列**：ROC是整个Z平面，除了可能在 $z=0$ (如果序列在 $n>0$ 有值) 或 $z=\infty$ (如果序列在 $n<0$ 有值) 处。
2.  **右边序列**：ROC位于<font color="orange">**最外层极点**</font>的外部，即 $|z| > |\lambda_{max}|$。
3.  **左边序列**：ROC位于<font color="orange">**最内层非零极点**</font>的内部，即 $|z| < |\lambda_{min}|$。
4.  **双边序列**：ROC是一个环形区域，位于两个极点之间，即 $|\lambda_i| < |z| < |\lambda_j|$。
5.  **核心规则**：<font color="orange">**ROC内不包含任何极点**</font>。

---

## 四、逆Z变换 ↩️

逆Z变换是从 $X(z)$ 求出原始序列 $x[n]$ 的过程。主要有三种常用方法：

### 1. ➗ 长除法 (幂级数展开法)

通过做多项式长除法，将 $X(z)$ 展开成 $z^{-1}$ (对应因果序列) 或 $z$ (对应反因果序列) 的幂级数形式。
$$
X(z) = \sum_{n} c_n z^{-n} = \dots + c_{-1}z^1 + c_0 + c_1z^{-1} + c_2z^{-2} + \dots
$$
则 $x[n] = c_n$。

*   **优点**：概念简单，适用于求序列的前几个值。
*   **缺点**：无法得到封闭形式的解析解。

#### 例题5: 长除法求逆变换
求 $X(z) = \frac{1-\frac{1}{3}z^{-1}}{1-\frac{1}{4}z^{-2}}$，ROC为 $|z| > 1/2$ 的逆变换。
**解**:
由于ROC是圆外，我们按 $z^{-1}$ 的降幂排列进行长除法：
$$
1-\frac{1}{4}z^{-2} \quad \overline{) \quad 1-\frac{1}{3}z^{-1} \qquad \qquad \qquad} \quad = \quad 1 - \frac{1}{3}z^{-1} + \frac{1}{4}z^{-2} - \frac{1}{12}z^{-3} + \dots
$$
通过观察系数，我们得到：
$x[0]=1, x[1]=-1/3, x[2]=1/4, x[3]=-1/12, \dots$
即 $x[n] = \{1, -1/3, 1/4, -1/12, \dots \}$

### 2. 🧩 部分分式展开法

这是求解有理函数逆变换最常用的方法。

**步骤**：
1.  **求出 $X(z)$ 的所有极点 $\lambda_i$**。
2.  **将 $X(z)$ 展开为部分分式**。
    *   **单极点**：对于在 $\lambda_k$ 的单极点，其对应的项为 $\frac{A_k}{1-\lambda_k z^{-1}}$。
    *   **重极点**：对于在 $v$ 的L重极点，其对应的项为 $\sum_{i=1}^{L}\frac{\rho_i}{(1-v z^{-1})^i}$。
3.  **根据总的ROC，确定每一项的ROC**。
4.  **查表或利用性质求出每一项的逆变换，然后相加**。

#### 例题: 部分分式法
求 $H(z) = \frac{z}{(z-1)(z-2)}$，若系统为因果序列，求 $h[n]$。
**解**：
1.  **转换为 $z^{-1}$ 形式**：$H(z) = \frac{z^{-1}}{(1-z^{-1})(1-2z^{-1})}$
2.  **部分分式展开**：$\frac{H(z)}{z^{-1}} = \frac{1}{(1-z^{-1})(1-2z^{-1})} = \frac{-1}{1-z^{-1}} + \frac{2}{1-2z^{-1}}$
    所以 $H(z) = \frac{-z^{-1}}{1-z^{-1}} + \frac{2z^{-1}}{1-2z^{-1}}$ 
3.  **确定ROC**：因为系统是因果的，ROC在最外层极点之外，即 $|z|>2$。
4.  **求逆变换**：
    $\frac{-1}{1-z^{-1}} \Leftrightarrow -u[n]$
    $\frac{2}{1-2z^{-1}} \Leftrightarrow 2(2^n)u[n] = 2^{n+1}u[n]$
    所以 $h[n] = -u[n] + 2^{n+1}u[n]$

### 3. ∮ 留数法 (围线积分法)

逆Z变换的正式定义是一个复围线积分：
$$
\boxed{x[n] = \frac{1}{2\pi j} \oint_c X(z)z^{n-1}dz}
$$
其中围线 $c$ 是在 $X(z)$ 的ROC内的一条逆时针闭合路径。这个积分可以通过<font color="orange">**留数定理**</font>来计算，即积分值等于 $2\pi j$ 乘以围线内所有极点的留数之和。

---

## 五、Z变换的性质 ✨

Z变换有很多重要的性质，极大地简化了离散时间系统的分析。

| 特性         | 序列 $x[n]$             | Z变换 $X(z)$            | 收敛域 ROC'                 |
| :--------- | :-------------------- | :-------------------- | :----------------------- |
| **线性**     | $a x_1[n] + b x_2[n]$ | $a X_1(z) + b X_2(z)$ | 至少 $ROC_1 \cap ROC_2$    |
| **时移**     | $x[n-n_0]$            | $z^{-n_0} X(z)$       | $R$, 但可能增删$z=0$或$\infty$ |
| **Z域尺度变换** | $z_0^n x[n]$          | $X(z/z_0)$            | $\|{z_0}\|R$​            |
| **时域反转**   | $x[-n]$               | $X(1/z)$              | $1/R$                    |
| **共轭**     | $x^*[n]$              | $X^*(z^*)$            | $R$                      |
| **卷积**     | $x_1[n] * x_2[n]$     | $X_1(z) X_2(z)$       | 至少 $ROC_1 \cap ROC_2$    |
| **Z域微分**   | $n x[n]$              | $-z \frac{dX(z)}{dz}$ | $R$                      |

💡 **卷积性质**是Z变换分析LTI系统的基石。它将时域中复杂的卷积运算转化为了Z域中简单的乘积运算。

---

## 六、LTI系统的传输函数与系统分析 🔬

### ⚡ 传输函数 (系统函数)

对于一个LTI系统，其<font color="orange">**传输函数 (Transfer Function)**</font>或<font color="orange">**系统函数 (System Function)**</font> $H(z)$ 定义为系统单位冲激响应 $h[n]$ 的Z变换。

$$
\boxed{H(z) = Z\{h[n]\}}
$$

根据卷积性质，系统的输出响应 $Y(z)$ 等于输入信号 $X(z)$ 与系统函数 $H(z)$ 的乘积：

$$
\boxed{Y(z) = H(z)X(z)}
$$

因此，系统函数也可以表示为输出的Z变换与输入的Z变换之比：

$$
H(z) = \frac{Y(z)}{X(z)}
$$

对于由线性常系数差分方程描述的系统，可以直接对差分方程两边取Z变换，从而求得系统函数 $H(z)$。

### 📊 从Z变换看系统特性

#### 1. 因果性 (Causality)

一个LTI系统是<font color="orange">**因果**</font>的，当且仅当其单位冲激响应 $h[n]$ 是一个右边序列，即 $n<0$ 时 $h[n]=0$。
从Z变换角度看，一个LTI系统是因果的，当且仅当其系统函数 $H(z)$ 的<font color="orange">**ROC是收敛于最外层极点外部的区域，并包含 $z=\infty$**</font>。

#### 2. 稳定性 (Stability)

一个LTI系统是<font color="orange">**BIBO稳定**</font>的，当且仅当其单位冲激响应是绝对可和的，即 $\sum_{n=-\infty}^{\infty} |h[n]| < \infty$。
从Z变换角度看，一个LTI系统是稳定的，当且仅当其系统函数 $H(z)$ 的<font color="orange">**ROC包含单位圆 $|z|=1$**</font>。

⭐ **重要结论**: 一个<font color="orange">**因果**</font>的LTI系统是<font color="orange">**稳定**</font>的，当且仅当其系统函数 $H(z)$ 的<font color="orange">**所有极点都在单位圆内部**</font>。

### 📡 频率响应的几何解释

系统的频率响应 $H(e^{j\omega})$ 是通过在Z平面上的单位圆上对系统函数 $H(z)$ 进行求值得到的 ($z=e^{j\omega}$)。

*   **幅频响应** $|H(e^{j\omega})|$：等于从单位圆上 $e^{j\omega}$ 点到<font color="orange">所有零点</font>的向量长度之积，除以到<font color="orange">所有极点</font>的向量长度之积。
    *   当单位圆靠近一个<font color="orange">极点</font>时，幅频响应出现<font color="orange">峰值</font>。
    *   当单位圆靠近一个<font color="orange">零点</font>时，幅频响应出现<font color="orange">谷值</font>。
*   **相频响应** $\angle H(e^{j\omega})$：等于从单位圆上 $e^{j\omega}$ 点到所有零点的向量相角之和，减去到所有极点的向量相角之和。

通过分析零极点图，特别是零极点与单位圆的相对位置，我们可以直观地估算出系统的频率响应特性。

---

## 📜 本章学习总结

本章我们学习了Z变换，它是分析离散时间信号与系统的强大工具。

1.  **核心定义**：Z变换将离散时间序列映射到复Z平面，其定义为 $X(z) = \sum x[n]z^{-n}$。
2.  **收敛域 (ROC)**：ROC是Z变换不可分割的一部分，它决定了Z变换表达式与时间序列的唯一对应关系。ROC的形状（圆内、圆外、环形）取决于序列的类型（左边、右边、双边）。
3.  **逆Z变换**：主要方法有长除法、部分分式展开法，后者是求解有理Z变换逆变换的关键。
4.  **性质**：Z变换的线性、时移、卷积等性质大大简化了系统分析，尤其是卷积性质，它将时域卷积变为Z域乘积。
5.  **系统函数 $H(z)$**：它是系统冲激响应 $h[n]$ 的Z变换，完整描述了LTI系统的特性。
6.  **系统分析**：通过分析 $H(z)$ 的极点位置和ROC，我们可以直接判断系统的<font color="orange">因果性</font>和<font color="orange">稳定性</font>。
7.  **频率响应**：系统函数在单位圆上的取值即为频率响应，零极点图为我们提供了直观分析频率响应的几何方法。