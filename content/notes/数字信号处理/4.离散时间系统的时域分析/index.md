---
title: 第三章 离散时间系统的时域分析
date: 2025-09-11T10:00:00+08:00
tags:
  - 大三上
  - 数字信号处理
summary: 时域分析为我们理解信号如何通过系统提供了最直观的视角。掌握冲激响应和卷积，就掌握了分析LTI系统的钥匙。
---
在讨论本章之前，可以参考我之前写的关于[信号与系统的相关知识]({{<relref"notes/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E7%B3%BB%E7%BB%9F/#56-dtft-%E7%9A%84%E6%80%A7%E8%B4%A8-">}})。
### 本讲内容概览 🧭
*   1️⃣ **离散时间系统**：了解系统的基本概念和常见例子。
*   2️⃣ **系统分类**：学习如何根据不同特性对系统进行分类。
*   3️⃣ **LTI系统描述**：掌握描述线性时不变(LTI)系统的两种核心方式。
*   4️⃣ **系统时域分析**：深入理解LTI系统的核心运算——卷积。
*   5️⃣ **系统互联**：分析系统的级联与并联。
*   6️⃣ **有限维LTI系统**：学习用差分方程描述的系统。

---

### 1️⃣ 离散时间系统 (Discrete-Time Systems)

#### 概念与功能 💡
*   **功能**：对输入的数字序列 $x[n]$ 进行处理，得到输出序列 $y[n]$。
*   **广义上**，可以看作一个<font color="orange">**数字滤波器**</font>。
*   **数学表示**：
    $y(n) = T[x(n)]$
    其中 $T[•]$ 代表系统对输入信号 $x(n)$ 的变换操作。
    

#### 常见系统例子 ⚙️

1.  **累加器 (Accumulator)**
    *   将输入序列从 $-\infty$ 到当前时刻 $n$ 的所有值累加起来。
    *   **定义式**:
        $y[n] = \sum_{l=-\infty}^{n} x[l]$
    *   **递归形式 (更高效)**:
        $y[n] = y[n-1] + x[n]$
    *   对于<font color="orange">**因果累加器**</font> (从n=0开始累加)，其表达式为：
        $\boxed{y[n] = \sum_{l=0}^{n} x[l] = y[-1] + \sum_{l=0}^{n} x[l]}$
    *   其中 $y[-1]$ 称为<font color="orange">**初始条件**</font>。

2.  **滑动平均滤波器 (Moving Average Filter)**
    *   将当前点与过去的 $M-1$ 个点取平均，以平滑信号。
    *   **直接形式**:
        $\boxed{y[n] = \frac{1}{M} \sum_{k=0}^{M-1} x[n-k]}$
    *   **递归形式 (计算量和存储量更小)**:
        $\boxed{y[n] = y[n-1] + \frac{1}{M}(x[n] - x[n-M])}$
    *   **应用**：股票移动均线分析、心率/运动数据平滑去噪。
    *   **思考🤔**：
        *   **Q1**: 上面两个式子的计算量和存储量分别是多少？
        *   **Q2**: 该滤波器的单位脉冲响应是什么？
        *   **Q3**: 该滤波器的频率响应是什么？

3.  **指数加权移动平均滤波器**
    *   一种递归滤波器，过去的输入数据权重以指数形式衰减。
    *   **公式**:
        $y[n] = \alpha y[n-1] + x[n] \quad (0 < \alpha < 1)$
    *   展开后可以看到：
        $y[n] = x[n] + \alpha x[n-1] + \alpha^2 x[n-2] + \dots$
    *   ✔️ 离当前越远的数据，其权重 $\alpha^k$ 越小。

4.  **线性内插 (Linear Interpolation)**
    *   用于上采样后，在数据点之间补充新的点。
    *   **内差因子为2**:
        $y[n] = x_u[n] + \frac{1}{2}(x_u[n-1] + x_u[n+1])$
    *   **应用**: 图像缩放（双线性内插是其二维形式），可以获得比最近邻插值更平滑的效果。
    

5.  **中值滤波器 (Median Filter)**
    *   在输入序列上滑动一个奇数长度的窗口，输出为窗口内所有样本值的<font color="orange">**中值**</font>。
    *   **公式**:
        $y[n] = \text{med}\{x[n-K], \dots, x[n], \dots, x[n+K]\}$
    *   **特点**：能有效去除<font color="orange">**随机突发噪声（椒盐噪声）**</font>，且对信号边缘的保持效果比线性平滑滤波器好。
    *   **应用**：事件相机信号处理，滤除传感器噪声和车体震动产生的假事件。

---

### 2️⃣ 离散时间系统的分类 📋

#### 🔹 按脉冲响应长度

*   **有限脉冲响应 (FIR) 系统**: 脉冲响应 $h[n]$ 在有限时间内为非零值。
*   **无限脉冲响应 (IIR) 系统**: 脉冲响应 $h[n]$ 持续无限长时间。

    *   **例 - FIR低通**: 滑动平均滤波器 $y[n] = \frac{1}{M} \sum_{k=0}^{M-1} x[n-k]$
    *   **例 - IIR低通**: 指数加权移动平均 $y[n] = \alpha y[n-1] + (1-\alpha)x[n]$
    *   **例 - FIR一次差分**: $y[n] = x[n] - x[n-1]$ (用于边缘检测)

#### 🔹 按输出计算过程

*   **非递归系统**: 输出 $y[n]$ 只与<font color="orange">**过去和现在**</font>的<font color="orange">**输入**</font>有关。
*   **递归系统**: 输出 $y[n]$ 不仅与输入有关，还与<font color="orange">**过去**</font>的<font color="orange">**输出**</font>有关。
*   **注意点** 📌: FIR系统通常是非递归的，IIR系统必须是递归的。但FIR系统也可以用递归方式实现（如滑动平均滤波器的递归形式）。

#### 🔹 按系统特性（输入-输出关系）

1.  **线性系统 (Linear System)**
    *   满足<font color="orange">**叠加原理**</font>。若 $T[x_1[n]] = y_1[n]$ 且 $T[x_2[n]] = y_2[n]$，则：
        $\boxed{T[\alpha x_1[n] + \beta x_2[n]] = \alpha y_1[n] + \beta y_2[n]}$
    *   💡 **易错点**: 带有非零初始条件的系统通常是<font color="orange">**非线性**</font>的。例如，因果累加器只有在初始条件为零（at rest）时才是线性的。
    *   **线性系统举例**：滑动平均滤波器、线性内插、上采样。
    *   **非线性系统举例**：中值滤波器。

2.  **移不变系统 (Shift-Invariant System)**
    *   也称<font color="orange">**时不变系统 (Time-Invariant)**</font>。
    *   系统的特性不随时间变化。输入信号延迟 $k$ 个单位，输出信号也相应延迟 $k$ 个单位。
        $\boxed{\text{若 } T[x(n)] = y(n), \text{ 则 } T[x(n-k)] = y(n-k)}$
    *   **物理意义**: 无论何时进行实验，只要输入相同，得到的输出波形也相同，只是时间起点不同。
    *   **反例**：上采样系统是<font color="orange">**时变**</font>的，因为移位操作和插零操作的顺序不可交换。

3.  **因果系统 (Causal System)**
    *   系统在 $n_0$ 时刻的输出，仅取决于 $n \le n_0$ 时刻的输入（即<font color="orange">**当前和过去**</font>的输入）。
    *   **物理意义**: 系统不能“预知”未来的输入。所有实时的物理系统都必须是因果的。
    *   **非因果系统举例**：$y(n) = x(n+1)$ (需要未来的输入)。
    *   **注意点** 📌: 对于非实时处理（如图像处理、数据分析），因果性不是必须的。例如，平滑一段数据可以使用中心平均 $y[n] = \frac{1}{3}(x[n-1] + x[n] + x[n+1])$，这是一个非因果系统。

4.  **稳定系统 (Stable System)**
    *   指<font color="orange">**有界输入-有界输出 (BIBO)**</font>稳定。
    *   如果输入信号有界（即 $|x[n]| < B_x$），则输出信号也一定有界（$|y[n]| < B_y$）。
    *   **例**: M点滑动平均滤波器是稳定的，因为若输入 $|x[n]| < B_x$，则输出 $|y[n]| \le \frac{1}{M} \sum_{k=0}^{M-1} |x[n-k]| < \frac{1}{M} \cdot M \cdot B_x = B_x$，输出有界。

---

### 3️⃣ LTI系统的两种描述 🔑

对于<font color="orange">**线性时不变 (LTI)**</font>系统，其时域特性可以被完全描述。

1.  **单位冲激响应 (Impulse Response)** $h[n]$
    *   定义：当系统输入为单位冲激序列 $\delta[n]$ 时，系统的输出。
        $\delta[n] \xrightarrow{T[\bullet]} h[n]$
    *   $h[n]$ 是描述LTI系统特性的<font color="orange">**核心**</font>！

2.  **单位阶跃响应 (Step Response)** $s[n]$
    *   定义：当系统输入为单位阶跃序列 $\mu[n]$ 时，系统的输出。
        $\mu[n] \xrightarrow{T[\bullet]} s[n]$

*   **例**：求累加器 $y[n] = \sum_{l=-\infty}^{n} x[l]$ 的冲激响应。
    *   令输入 $x[l] = \delta[l]$，则输出 $h[n]$ 为：
        $h[n] = \sum_{l=-\infty}^{n} \delta[l] = \mu[n]$
    *   结论：累加器的冲激响应是单位阶跃序列。

---

### 4️⃣ LTI系统的时域分析 🔬

核心思想：利用LTI系统的<font color="orange">**线性**</font>和<font color="orange">**时不变性**</font>来求任意输入的响应。

#### 卷积和 (Convolution Sum)

1.  **信号分解**: 任何离散序列 $x[n]$ 都可以表示为一系列加权和移位的单位冲激信号之和。
    $\boxed{x[n] = \sum_{k=-\infty}^{\infty} x[k] \delta[n-k]}$

2.  **响应求解**:
    *   将分解后的 $x[n]$ 输入LTI系统 $T[•]$。
    *   利用<font color="orange">**线性**</font>，将 $T[•]$ 移入求和号内: $y[n] = \sum x[k] T[\delta[n-k]]$
    *   利用<font color="orange">**时不变性**</font>， $T[\delta[n-k]]$ 等于 $h[n-k]$。
    *   最终得到LTI系统的输入-输出关系——**卷积和**:
        $\boxed{y[n] = \sum_{k=-\infty}^{\infty} x[k]h[n-k]}$
    *   这个运算记为 $y[n] = x[n] * h[n]$。

#### 卷积的性质

*   **交换律**: $x_1[n] * x_2[n] = x_2[n] * x_1[n]$ (系统与输入信号可互换)
*   **结合律**: $(x_1*x_2)*x_3 = x_1\*(x_2*x_3)$ (级联系统的顺序可交换)
*   **分配律**: $x_1\*(x_2+x_3) = x_1*x_2 + x_1*x_3$ (并联系统)

#### 卷积的计算方法

*   **图解法**: 对其中一个序列进行<font color="orange">**反折**</font> ($h[k] \rightarrow h[-k]$)，然后<font color="orange">**平移**</font>n个单位 ($h[n-k]$)，与另一个序列<font color="orange">**相乘**</font>，最后<font color="orange">**求和**</font>。
*   **列表法**: 适用于有限长序列，类似于多项式乘法，将对应项相乘后按位对齐相加。

#### 从 $h[n]$ 看LTI系统特性

*   **稳定性** ⚖️:
    *   一个LTI系统是BIBO稳定的，<font color="orange">**当且仅当**</font>其冲激响应是绝对可和的。
        $\boxed{S = \sum_{n=-\infty}^{\infty} |h[n]| < \infty}$
    *   **例**: 对于因果系统 $h[n] = a^n u[n]$，当 $|a|<1$ 时，$S = 1/(1-|a|)$ 有限，系统稳定；当 $|a| \ge 1$ 时，$S$ 发散，系统不稳定。

*   **因果性**  causality:
    *   一个LTI系统是因果的，<font color="orange">**当且仅当**</font>其冲激响应满足：
        $\boxed{h[k] = 0, \quad \text{for } k < 0}$
    *   这意味着系统的响应不能出现在激励之前。

---

### 5️⃣ 简单的LTI系统互联 🔗

*   **级联 (Cascade)**:
    *   两个系统串联，总的冲激响应是两个系统冲激响应的<font color="orange">**卷积**</font>。
        $h[n] = h_1[n] * h_2[n]$
*   **并联 (Parallel)**:
    *   两个系统并联，总的冲激响应是两个系统冲激响应的<font color="orange">**相加**</font>。
        $h[n] = h_1[n] + h_2[n]$

---

### 6️⃣ 有限维LTI离散时间系统 🔢

这类系统可以用<font color="orange">**线性常系数差分方程 (LCCDE)**</font>来描述。

$\sum_{k=0}^{N} d_k y[n-k] = \sum_{k=0}^{M} p_k x[n-k]$

#### 差分方程的解

*   **全解 (Total Solution)**:
    $y[n] = y_c[n] + y_p[n]$
    *   $y_c[n]$: **齐次解** (Complementary)，对应于输入为零时系统的自然响应。
    *   $y_p[n]$: **特解** (Particular)，对应于特定输入信号产生的强制响应。

*   **零输入响应与零状态响应**:
    *   **零输入响应 $y_{zi}[n]$**: 输入 $x[n]=0$，仅由<font color="orange">**非零初始条件**</font>引起的响应。
    *   **零状态响应 $y_{zs}[n]$**: <font color="orange">**初始条件为零**</font>，仅由输入信号 $x[n]$ 引起的响应。

*   **稳定性与特征方程**:
    *   齐次解的形式由系统的<font color="orange">**特征方程**</font>的根（极点）决定。
    *   **稳定性判据** 🌟: 一个因果LTI系统是稳定的，<font color="orange">**当且仅当**</font>其特征方程的所有根的模都<font color="orange">**小于1**</font>（即所有根都在复平面的单位圆内）。

---

### ✨ 本章学习总结 ✨

本讲我们系统地学习了离散时间系统的时域分析方法。

1.  **核心是LTI系统**：我们了解了系统的基本概念和多种分类方法，但<font color="orange">**线性时不变 (LTI) 系统**</font>是分析的基石。

2.  **$h[n]$是关键**：LTI系统的所有时域特性都蕴含在其<font color="orange">**单位冲激响应 $h[n]$**</font>中。通过 $h[n]$，我们可以判断系统的因果性 ($h[n]=0$ for $n<0$) 和稳定性 ($\sum|h[n]| < \infty$)。

3.  **卷积是核心运算**：LTI系统的输出是输入信号与系统冲激响应的<font color="orange">**卷积和**</font>。理解和掌握卷积的定义、性质和计算方法至关重要。

4.  **差分方程是重要模型**：许多实用的LTI系统（特别是IIR系统）可以用线性常系数差分方程来描述。系统的稳定性与差分方程特征根的位置密切相关。

总之，时域分析为我们理解信号如何通过系统提供了最直观的视角。掌握冲激响应和卷积，就掌握了分析LTI系统的钥匙 🔑。